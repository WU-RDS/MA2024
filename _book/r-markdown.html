<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 R Markdown | Marketing Analytics 2024</title>
  <meta name="description" content="An Introduction to Data Analytics Using R" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="8 R Markdown | Marketing Analytics 2024" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An Introduction to Data Analytics Using R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 R Markdown | Marketing Analytics 2024" />
  
  <meta name="twitter:description" content="An Introduction to Data Analytics Using R" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="regression.html"/>
<link rel="next" href="survey-design-analysis.html"/>
<script src="libs/jquery-3.6.1/jquery-3.6.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.11/DiagrammeR.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">MA 2024/25</a></strong></li>
<li class="divider"></li>
<li class="part"><span><b>I Course outline</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#course-structure"><i class="fa fa-check"></i>Course structure</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#grading"><i class="fa fa-check"></i>Grading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#course-materials"><i class="fa fa-check"></i>Course materials</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#main-reference"><i class="fa fa-check"></i>Main reference</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#further-readings"><i class="fa fa-check"></i>Further readings</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#discussion-forum"><i class="fa fa-check"></i>Discussion forum</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#other-web-resources"><i class="fa fa-check"></i>Other web-resources</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#contact"><i class="fa fa-check"></i>Contact</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Lecture notes</b></span></li>
<li class="chapter" data-level="1" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="1.1" data-path="preliminaries.html"><a href="preliminaries.html#marketing-foundations-recap"><i class="fa fa-check"></i><b>1.1</b> Marketing foundations (recap)</a></li>
<li class="chapter" data-level="1.2" data-path="preliminaries.html"><a href="preliminaries.html#the-research-process"><i class="fa fa-check"></i><b>1.2</b> The research process</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="preliminaries.html"><a href="preliminaries.html#research-question-and-hypothesis"><i class="fa fa-check"></i><b>1.2.1</b> Research question and hypothesis</a></li>
<li class="chapter" data-level="1.2.2" data-path="preliminaries.html"><a href="preliminaries.html#choosing-a-research-design"><i class="fa fa-check"></i><b>1.2.2</b> Choosing a research design</a></li>
<li class="chapter" data-level="1.2.3" data-path="preliminaries.html"><a href="preliminaries.html#collecting-data"><i class="fa fa-check"></i><b>1.2.3</b> Collecting data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#learning-check"><i class="fa fa-check"></i>Learning check</a></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#how-to-download-and-install-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> How to download and install R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#the-r-studio-interface"><i class="fa fa-check"></i><b>2.2</b> The R Studio interface</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#functions"><i class="fa fa-check"></i><b>2.3</b> Functions</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#packages"><i class="fa fa-check"></i><b>2.4</b> Packages</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#a-typical-r-session"><i class="fa fa-check"></i><b>2.5</b> A typical R session</a></li>
<li class="chapter" data-level="2.6" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#getting-help"><i class="fa fa-check"></i><b>2.6</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>3</b> Data handling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-handling.html"><a href="data-handling.html#basic-data-handling"><i class="fa fa-check"></i><b>3.1</b> Basic data handling</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-handling.html"><a href="data-handling.html#creating-objects"><i class="fa fa-check"></i><b>3.1.1</b> Creating objects</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-handling.html"><a href="data-handling.html#data-types"><i class="fa fa-check"></i><b>3.1.2</b> Data types</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-handling.html"><a href="data-handling.html#data-structures"><i class="fa fa-check"></i><b>3.1.3</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-handling.html"><a href="data-handling.html#data-import-and-export"><i class="fa fa-check"></i><b>3.2</b> Data import and export</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-handling.html"><a href="data-handling.html#getting-data-for-this-course"><i class="fa fa-check"></i><b>3.2.1</b> Getting data for this course</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-handling.html"><a href="data-handling.html#import-data-created-by-other-software-packages"><i class="fa fa-check"></i><b>3.2.2</b> Import data created by other software packages</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-handling.html"><a href="data-handling.html#import-data-from-qualtrics"><i class="fa fa-check"></i><b>3.2.3</b> Import data from Qualtrics</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-handling.html"><a href="data-handling.html#export-data"><i class="fa fa-check"></i><b>3.2.4</b> Export data</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-handling.html"><a href="data-handling.html#import-data-from-the-web"><i class="fa fa-check"></i><b>3.2.5</b> Import data from the Web</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-handling.html"><a href="data-handling.html#learning-check-1"><i class="fa fa-check"></i>Learning check</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="summarizing-data.html"><a href="summarizing-data.html#summary-statistics"><i class="fa fa-check"></i><b>4.1</b> Summary statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="summarizing-data.html"><a href="summarizing-data.html#categorical-variables"><i class="fa fa-check"></i><b>4.1.1</b> Categorical variables</a></li>
<li class="chapter" data-level="4.1.2" data-path="summarizing-data.html"><a href="summarizing-data.html#continuous-variables"><i class="fa fa-check"></i><b>4.1.2</b> Continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="summarizing-data.html"><a href="summarizing-data.html#data-visualization"><i class="fa fa-check"></i><b>4.2</b> Data visualization</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#categorical-variables-1"><i class="fa fa-check"></i><b>4.2.1</b> Categorical variables</a></li>
<li class="chapter" data-level="4.2.2" data-path="summarizing-data.html"><a href="summarizing-data.html#continuous-variables-1"><i class="fa fa-check"></i><b>4.2.2</b> Continuous variables</a></li>
<li class="chapter" data-level="4.2.3" data-path="summarizing-data.html"><a href="summarizing-data.html#saving-plots"><i class="fa fa-check"></i><b>4.2.3</b> Saving plots</a></li>
<li class="chapter" data-level="4.2.4" data-path="summarizing-data.html"><a href="summarizing-data.html#ggplot-extensions"><i class="fa fa-check"></i><b>4.2.4</b> ggplot extensions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summarizing-data.html"><a href="summarizing-data.html#learning-check-2"><i class="fa fa-check"></i>Learning check</a></li>
<li class="chapter" data-level="" data-path="summarizing-data.html"><a href="summarizing-data.html#references-1"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>5</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistical-inference.html"><a href="statistical-inference.html#if-we-knew-it-all"><i class="fa fa-check"></i><b>5.1</b> If we knew it all</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-from-a-known-population"><i class="fa fa-check"></i><b>5.1.1</b> Sampling from a known population</a></li>
<li class="chapter" data-level="5.1.2" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="statistical-inference.html"><a href="statistical-inference.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>5.2</b> The Central Limit Theorem</a></li>
<li class="chapter" data-level="5.3" data-path="statistical-inference.html"><a href="statistical-inference.html#using-what-we-actually-know"><i class="fa fa-check"></i><b>5.3</b> Using what we actually know</a></li>
<li class="chapter" data-level="5.4" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals-for-the-sample-mean"><i class="fa fa-check"></i><b>5.4</b> Confidence Intervals for the Sample Mean</a></li>
<li class="chapter" data-level="" data-path="statistical-inference.html"><a href="statistical-inference.html#learning-check-3"><i class="fa fa-check"></i>Learning check</a></li>
<li class="chapter" data-level="" data-path="statistical-inference.html"><a href="statistical-inference.html#references-2"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>6</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-null-hypothesis"><i class="fa fa-check"></i><b>6.1.1</b> The null hypothesis</a></li>
<li class="chapter" data-level="6.1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-inference-on-a-sample"><i class="fa fa-check"></i><b>6.1.2</b> Statistical inference on a sample</a></li>
<li class="chapter" data-level="6.1.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#choosing-the-right-test"><i class="fa fa-check"></i><b>6.1.3</b> Choosing the right test</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>6.2</b> One sample t-test</a></li>
<li class="chapter" data-level="6.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#comparing-two-means"><i class="fa fa-check"></i><b>6.3</b> Comparing two means</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#independent-means-t-test"><i class="fa fa-check"></i><b>6.3.1</b> Independent-means t-test</a></li>
<li class="chapter" data-level="6.3.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#dependent-means-t-test"><i class="fa fa-check"></i><b>6.3.2</b> Dependent-means t-test</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#nhst-considerations"><i class="fa fa-check"></i><b>6.4</b> NHST considerations</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>6.4.1</b> Type I and Type II Errors</a></li>
<li class="chapter" data-level="6.4.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#significance-level-sample-size-power-and-effect-size"><i class="fa fa-check"></i><b>6.4.2</b> Significance level, sample size, power, and effect size</a></li>
<li class="chapter" data-level="6.4.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#p-values-stopping-rules-and-p-hacking"><i class="fa fa-check"></i><b>6.4.3</b> P-values, stopping rules and p-hacking</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#comparing-several-means"><i class="fa fa-check"></i><b>6.5</b> Comparing several means</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction-2"><i class="fa fa-check"></i><b>6.5.1</b> Introduction</a></li>
<li class="chapter" data-level="6.5.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#decomposing-variance"><i class="fa fa-check"></i><b>6.5.2</b> Decomposing variance</a></li>
<li class="chapter" data-level="6.5.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-way-anova"><i class="fa fa-check"></i><b>6.5.3</b> One-way ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#non-parametric-tests"><i class="fa fa-check"></i><b>6.6</b> Non-parametric tests</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#mann-whitney-u-test-a.k.a.-wilcoxon-rank-sum-test"><i class="fa fa-check"></i><b>6.6.1</b> Mann-Whitney U Test (a.k.a. Wilcoxon rank-sum test)</a></li>
<li class="chapter" data-level="6.6.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>6.6.2</b> Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="6.6.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>6.6.3</b> Kruskal-Wallis test</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#categorical-data"><i class="fa fa-check"></i><b>6.7</b> Categorical data</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-for-proportions"><i class="fa fa-check"></i><b>6.7.1</b> Confidence intervals for proportions</a></li>
<li class="chapter" data-level="6.7.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi-square-test"><i class="fa fa-check"></i><b>6.7.2</b> Chi-square test</a></li>
<li class="chapter" data-level="6.7.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#sample-size-1"><i class="fa fa-check"></i><b>6.7.3</b> Sample size</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#learning-check-4"><i class="fa fa-check"></i>Learning check</a></li>
<li class="chapter" data-level="" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#references-3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>7</b> Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regression.html"><a href="regression.html#correlation"><i class="fa fa-check"></i><b>7.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="regression.html"><a href="regression.html#correlation-coefficient"><i class="fa fa-check"></i><b>7.1.1</b> Correlation coefficient</a></li>
<li class="chapter" data-level="7.1.2" data-path="regression.html"><a href="regression.html#significance-testing"><i class="fa fa-check"></i><b>7.1.2</b> Significance testing</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="regression.html"><a href="regression.html#regression-1"><i class="fa fa-check"></i><b>7.2</b> Regression</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="regression.html"><a href="regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.2.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="7.2.2" data-path="regression.html"><a href="regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.2.2</b> Multiple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="regression.html"><a href="regression.html#potential-problems"><i class="fa fa-check"></i><b>7.3</b> Potential problems</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="regression.html"><a href="regression.html#outliers"><i class="fa fa-check"></i><b>7.3.1</b> Outliers</a></li>
<li class="chapter" data-level="7.3.2" data-path="regression.html"><a href="regression.html#influential-observations"><i class="fa fa-check"></i><b>7.3.2</b> Influential observations</a></li>
<li class="chapter" data-level="7.3.3" data-path="regression.html"><a href="regression.html#non-linearity"><i class="fa fa-check"></i><b>7.3.3</b> Non-linearity</a></li>
<li class="chapter" data-level="7.3.4" data-path="regression.html"><a href="regression.html#non-constant-error-variance"><i class="fa fa-check"></i><b>7.3.4</b> Non-constant error variance</a></li>
<li class="chapter" data-level="7.3.5" data-path="regression.html"><a href="regression.html#non-normally-distributed-errors"><i class="fa fa-check"></i><b>7.3.5</b> Non-normally distributed errors</a></li>
<li class="chapter" data-level="7.3.6" data-path="regression.html"><a href="regression.html#correlation-of-errors"><i class="fa fa-check"></i><b>7.3.6</b> Correlation of errors</a></li>
<li class="chapter" data-level="7.3.7" data-path="regression.html"><a href="regression.html#collinearity"><i class="fa fa-check"></i><b>7.3.7</b> Collinearity</a></li>
<li class="chapter" data-level="7.3.8" data-path="regression.html"><a href="regression.html#omitted-variables"><i class="fa fa-check"></i><b>7.3.8</b> Omitted Variables</a></li>
<li class="chapter" data-level="7.3.9" data-path="regression.html"><a href="regression.html#overfitting"><i class="fa fa-check"></i><b>7.3.9</b> Overfitting</a></li>
<li class="chapter" data-level="7.3.10" data-path="regression.html"><a href="regression.html#variable-selection"><i class="fa fa-check"></i><b>7.3.10</b> Variable selection</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="regression.html"><a href="regression.html#categorical-predictors"><i class="fa fa-check"></i><b>7.4</b> Categorical predictors</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="regression.html"><a href="regression.html#two-categories"><i class="fa fa-check"></i><b>7.4.1</b> Two categories</a></li>
<li class="chapter" data-level="7.4.2" data-path="regression.html"><a href="regression.html#more-than-two-categories"><i class="fa fa-check"></i><b>7.4.2</b> More than two categories</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="regression.html"><a href="regression.html#extensions-of-the-linear-model"><i class="fa fa-check"></i><b>7.5</b> Extensions of the linear model</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="regression.html"><a href="regression.html#interaction-effects"><i class="fa fa-check"></i><b>7.5.1</b> Interaction effects</a></li>
<li class="chapter" data-level="7.5.2" data-path="regression.html"><a href="regression.html#non-linear-relationships"><i class="fa fa-check"></i><b>7.5.2</b> Non-linear relationships</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>7.6</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="regression.html"><a href="regression.html#motivation-and-intuition"><i class="fa fa-check"></i><b>7.6.1</b> Motivation and intuition</a></li>
<li class="chapter" data-level="7.6.2" data-path="regression.html"><a href="regression.html#technical-details-of-the-model"><i class="fa fa-check"></i><b>7.6.2</b> Technical details of the model</a></li>
<li class="chapter" data-level="7.6.3" data-path="regression.html"><a href="regression.html#estimation-in-r"><i class="fa fa-check"></i><b>7.6.3</b> Estimation in R</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="regression.html"><a href="regression.html#causal-modeling-mediation-analysis"><i class="fa fa-check"></i><b>7.7</b> Causal Modeling &amp; Mediation Analysis</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="regression.html"><a href="regression.html#directed-acyclic-graphs-dags"><i class="fa fa-check"></i><b>7.7.1</b> Directed Acyclic Graphs (DAGs)</a></li>
<li class="chapter" data-level="7.7.2" data-path="regression.html"><a href="regression.html#the-fork-good-control"><i class="fa fa-check"></i><b>7.7.2</b> The Fork (Good control)</a></li>
<li class="chapter" data-level="7.7.3" data-path="regression.html"><a href="regression.html#the-pipe-bad-control"><i class="fa fa-check"></i><b>7.7.3</b> The Pipe (Bad control)</a></li>
<li class="chapter" data-level="7.7.4" data-path="regression.html"><a href="regression.html#the-collider-bad-control"><i class="fa fa-check"></i><b>7.7.4</b> The Collider (Bad control)</a></li>
<li class="chapter" data-level="7.7.5" data-path="regression.html"><a href="regression.html#omitted-variable-bias-confounders"><i class="fa fa-check"></i><b>7.7.5</b> Omitted Variable Bias (Confounders)</a></li>
<li class="chapter" data-level="7.7.6" data-path="regression.html"><a href="regression.html#mediation-analysis"><i class="fa fa-check"></i><b>7.7.6</b> Mediation analysis</a></li>
<li class="chapter" data-level="7.7.7" data-path="regression.html"><a href="regression.html#effect-moderation-interactions"><i class="fa fa-check"></i><b>7.7.7</b> Effect Moderation (Interactions)</a></li>
<li class="chapter" data-level="7.7.8" data-path="regression.html"><a href="regression.html#summary"><i class="fa fa-check"></i><b>7.7.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regression.html"><a href="regression.html#learning-check-5"><i class="fa fa-check"></i>Learning check</a></li>
<li class="chapter" data-level="" data-path="regression.html"><a href="regression.html#references-4"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="part"><span><b>III Assignments</b></span></li>
<li class="chapter" data-level="8" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>8</b> R Markdown</a>
<ul>
<li class="chapter" data-level="8.1" data-path="r-markdown.html"><a href="r-markdown.html#introduction-to-r-markdown"><i class="fa fa-check"></i><b>8.1</b> Introduction to R Markdown</a>
<ul>
<li class="chapter" data-level="" data-path="r-markdown.html"><a href="r-markdown.html#creating-a-new-r-markdown-document"><i class="fa fa-check"></i>Creating a new R Markdown document</a></li>
<li class="chapter" data-level="" data-path="r-markdown.html"><a href="r-markdown.html#text-and-equations"><i class="fa fa-check"></i>Text and Equations</a></li>
<li class="chapter" data-level="" data-path="r-markdown.html"><a href="r-markdown.html#r-code"><i class="fa fa-check"></i>R-Code</a></li>
<li class="chapter" data-level="" data-path="r-markdown.html"><a href="r-markdown.html#latex-math"><i class="fa fa-check"></i>LaTeX Math</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="r-markdown.html"><a href="r-markdown.html#assignment-1"><i class="fa fa-check"></i><b>8.2</b> Assignment 1</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="r-markdown.html"><a href="r-markdown.html#load-libraries-and-data"><i class="fa fa-check"></i><b>8.2.1</b> Load libraries and data</a></li>
<li class="chapter" data-level="8.2.2" data-path="r-markdown.html"><a href="r-markdown.html#task-1"><i class="fa fa-check"></i><b>8.2.2</b> Task 1</a></li>
<li class="chapter" data-level="8.2.3" data-path="r-markdown.html"><a href="r-markdown.html#task-2"><i class="fa fa-check"></i><b>8.2.3</b> Task 2</a></li>
<li class="chapter" data-level="8.2.4" data-path="r-markdown.html"><a href="r-markdown.html#task-3"><i class="fa fa-check"></i><b>8.2.4</b> Task 3</a></li>
<li class="chapter" data-level="8.2.5" data-path="r-markdown.html"><a href="r-markdown.html#task-4"><i class="fa fa-check"></i><b>8.2.5</b> Task 4</a></li>
<li class="chapter" data-level="8.2.6" data-path="r-markdown.html"><a href="r-markdown.html#task-5"><i class="fa fa-check"></i><b>8.2.6</b> Task 5</a></li>
<li class="chapter" data-level="8.2.7" data-path="r-markdown.html"><a href="r-markdown.html#task-6"><i class="fa fa-check"></i><b>8.2.7</b> Task 6</a></li>
<li class="chapter" data-level="8.2.8" data-path="r-markdown.html"><a href="r-markdown.html#task-7"><i class="fa fa-check"></i><b>8.2.8</b> Task 7</a></li>
<li class="chapter" data-level="8.2.9" data-path="r-markdown.html"><a href="r-markdown.html#task-8"><i class="fa fa-check"></i><b>8.2.9</b> Task 8</a></li>
<li class="chapter" data-level="8.2.10" data-path="r-markdown.html"><a href="r-markdown.html#task-9"><i class="fa fa-check"></i><b>8.2.10</b> Task 9</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="r-markdown.html"><a href="r-markdown.html#assignment-2"><i class="fa fa-check"></i><b>8.3</b> Assignment 2</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="r-markdown.html"><a href="r-markdown.html#assignment-2a"><i class="fa fa-check"></i><b>8.3.1</b> Assignment 2a</a></li>
<li class="chapter" data-level="8.3.2" data-path="r-markdown.html"><a href="r-markdown.html#data-analysis"><i class="fa fa-check"></i><b>8.3.2</b> Data analysis</a></li>
<li class="chapter" data-level="8.3.3" data-path="r-markdown.html"><a href="r-markdown.html#load-data"><i class="fa fa-check"></i><b>8.3.3</b> Load data</a></li>
<li class="chapter" data-level="8.3.4" data-path="r-markdown.html"><a href="r-markdown.html#question-1"><i class="fa fa-check"></i><b>8.3.4</b> Question 1</a></li>
<li class="chapter" data-level="8.3.5" data-path="r-markdown.html"><a href="r-markdown.html#question-2"><i class="fa fa-check"></i><b>8.3.5</b> Question 2</a></li>
<li class="chapter" data-level="8.3.6" data-path="r-markdown.html"><a href="r-markdown.html#question-3"><i class="fa fa-check"></i><b>8.3.6</b> Question 3</a></li>
<li class="chapter" data-level="8.3.7" data-path="r-markdown.html"><a href="r-markdown.html#assignment-2b"><i class="fa fa-check"></i><b>8.3.7</b> Assignment 2b</a></li>
<li class="chapter" data-level="8.3.8" data-path="r-markdown.html"><a href="r-markdown.html#data-analysis-1"><i class="fa fa-check"></i><b>8.3.8</b> Data analysis</a></li>
<li class="chapter" data-level="8.3.9" data-path="r-markdown.html"><a href="r-markdown.html#load-data-1"><i class="fa fa-check"></i><b>8.3.9</b> Load data</a></li>
<li class="chapter" data-level="8.3.10" data-path="r-markdown.html"><a href="r-markdown.html#question-4"><i class="fa fa-check"></i><b>8.3.10</b> Question 4</a></li>
<li class="chapter" data-level="8.3.11" data-path="r-markdown.html"><a href="r-markdown.html#assignment-2c"><i class="fa fa-check"></i><b>8.3.11</b> Assignment 2c</a></li>
<li class="chapter" data-level="8.3.12" data-path="r-markdown.html"><a href="r-markdown.html#data-analysis-2"><i class="fa fa-check"></i><b>8.3.12</b> Data analysis</a></li>
<li class="chapter" data-level="8.3.13" data-path="r-markdown.html"><a href="r-markdown.html#load-data-2"><i class="fa fa-check"></i><b>8.3.13</b> Load data</a></li>
<li class="chapter" data-level="8.3.14" data-path="r-markdown.html"><a href="r-markdown.html#question-5"><i class="fa fa-check"></i><b>8.3.14</b> Question 5</a></li>
<li class="chapter" data-level="8.3.15" data-path="r-markdown.html"><a href="r-markdown.html#question-6"><i class="fa fa-check"></i><b>8.3.15</b> Question 6</a></li>
<li class="chapter" data-level="8.3.16" data-path="r-markdown.html"><a href="r-markdown.html#assignment-2d"><i class="fa fa-check"></i><b>8.3.16</b> Assignment 2d</a></li>
<li class="chapter" data-level="8.3.17" data-path="r-markdown.html"><a href="r-markdown.html#data-analysis-3"><i class="fa fa-check"></i><b>8.3.17</b> Data analysis</a></li>
<li class="chapter" data-level="8.3.18" data-path="r-markdown.html"><a href="r-markdown.html#load-data-3"><i class="fa fa-check"></i><b>8.3.18</b> Load data</a></li>
<li class="chapter" data-level="8.3.19" data-path="r-markdown.html"><a href="r-markdown.html#question-7"><i class="fa fa-check"></i><b>8.3.19</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="r-markdown.html"><a href="r-markdown.html#assignment-3"><i class="fa fa-check"></i><b>8.4</b> Assignment 3</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="r-markdown.html"><a href="r-markdown.html#assignment-a"><i class="fa fa-check"></i><b>8.4.1</b> Assignment A</a></li>
<li class="chapter" data-level="8.4.2" data-path="r-markdown.html"><a href="r-markdown.html#data-analysis-4"><i class="fa fa-check"></i><b>8.4.2</b> Data analysis</a></li>
<li class="chapter" data-level="8.4.3" data-path="r-markdown.html"><a href="r-markdown.html#load-data-4"><i class="fa fa-check"></i><b>8.4.3</b> Load data</a></li>
<li class="chapter" data-level="8.4.4" data-path="r-markdown.html"><a href="r-markdown.html#question-1-1"><i class="fa fa-check"></i><b>8.4.4</b> Question 1</a></li>
<li class="chapter" data-level="8.4.5" data-path="r-markdown.html"><a href="r-markdown.html#question-2-1"><i class="fa fa-check"></i><b>8.4.5</b> Question 2</a></li>
<li class="chapter" data-level="8.4.6" data-path="r-markdown.html"><a href="r-markdown.html#question-3-1"><i class="fa fa-check"></i><b>8.4.6</b> Question 3</a></li>
<li class="chapter" data-level="8.4.7" data-path="r-markdown.html"><a href="r-markdown.html#question-4-1"><i class="fa fa-check"></i><b>8.4.7</b> Question 4</a></li>
<li class="chapter" data-level="8.4.8" data-path="r-markdown.html"><a href="r-markdown.html#question-5-1"><i class="fa fa-check"></i><b>8.4.8</b> Question 5</a></li>
<li class="chapter" data-level="8.4.9" data-path="r-markdown.html"><a href="r-markdown.html#question-6-1"><i class="fa fa-check"></i><b>8.4.9</b> Question 6</a></li>
<li class="chapter" data-level="8.4.10" data-path="r-markdown.html"><a href="r-markdown.html#question-7-1"><i class="fa fa-check"></i><b>8.4.10</b> Question 7</a></li>
<li class="chapter" data-level="8.4.11" data-path="r-markdown.html"><a href="r-markdown.html#assignment-b"><i class="fa fa-check"></i><b>8.4.11</b> Assignment B</a></li>
<li class="chapter" data-level="8.4.12" data-path="r-markdown.html"><a href="r-markdown.html#data-analysis-5"><i class="fa fa-check"></i><b>8.4.12</b> Data analysis</a></li>
<li class="chapter" data-level="8.4.13" data-path="r-markdown.html"><a href="r-markdown.html#load-data-5"><i class="fa fa-check"></i><b>8.4.13</b> Load data</a></li>
<li class="chapter" data-level="8.4.14" data-path="r-markdown.html"><a href="r-markdown.html#question-1-2"><i class="fa fa-check"></i><b>8.4.14</b> Question 1</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="r-markdown.html"><a href="r-markdown.html#assignment-4"><i class="fa fa-check"></i><b>8.5</b> Assignment 4</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="r-markdown.html"><a href="r-markdown.html#assignment-a-1"><i class="fa fa-check"></i><b>8.5.1</b> Assignment A</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Group project</b></span></li>
<li class="chapter" data-level="9" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html"><i class="fa fa-check"></i><b>9</b> Survey design &amp; analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#your-tasks"><i class="fa fa-check"></i><b>9.1</b> Your tasks</a></li>
<li class="chapter" data-level="9.2" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#topics-for-the-group-project"><i class="fa fa-check"></i><b>9.2</b> Topics for the group project</a></li>
<li class="chapter" data-level="9.3" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#general-information"><i class="fa fa-check"></i><b>9.3</b> General information</a></li>
<li class="chapter" data-level="9.4" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#part-1-questionnaire-design"><i class="fa fa-check"></i><b>9.4</b> Part 1: Questionnaire design</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#guidelines-for-the-submission-and-presentation"><i class="fa fa-check"></i><b>9.4.1</b> Guidelines for the submission and presentation</a></li>
<li class="chapter" data-level="9.4.2" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#guidelines-for-the-design-of-your-questionnaire"><i class="fa fa-check"></i><b>9.4.2</b> Guidelines for the design of your questionnaire</a></li>
<li class="chapter" data-level="9.4.3" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#questionnaire-structure-and-contents"><i class="fa fa-check"></i><b>9.4.3</b> Questionnaire structure and contents</a></li>
<li class="chapter" data-level="9.4.4" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#test-your-questionnaire"><i class="fa fa-check"></i><b>9.4.4</b> Test your questionnaire</a></li>
<li class="chapter" data-level="9.4.5" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#data-collection"><i class="fa fa-check"></i><b>9.4.5</b> Data collection</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#part-2-data-analysis"><i class="fa fa-check"></i><b>9.5</b> Part 2: Data analysis</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#guidelines-for-the-submission-and-presentation-1"><i class="fa fa-check"></i><b>9.5.1</b> Guidelines for the submission and presentation</a></li>
<li class="chapter" data-level="9.5.2" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#data-export-from-qualtrics"><i class="fa fa-check"></i><b>9.5.2</b> Data export from Qualtrics</a></li>
<li class="chapter" data-level="9.5.3" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#randomized-groups"><i class="fa fa-check"></i><b>9.5.3</b> Randomized groups</a></li>
<li class="chapter" data-level="9.5.4" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#importing-qualtrics-data"><i class="fa fa-check"></i><b>9.5.4</b> Importing Qualtrics data</a></li>
<li class="chapter" data-level="9.5.5" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#data-handling-1"><i class="fa fa-check"></i><b>9.5.5</b> Data handling</a></li>
<li class="chapter" data-level="9.5.6" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#visualizations"><i class="fa fa-check"></i><b>9.5.6</b> Visualizations</a></li>
<li class="chapter" data-level="9.5.7" data-path="survey-design-analysis.html"><a href="survey-design-analysis.html#working-with-factors"><i class="fa fa-check"></i><b>9.5.7</b> Working with factors</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V FAQs</b></span></li>
<li class="chapter" data-level="10" data-path="faqs.html"><a href="faqs.html"><i class="fa fa-check"></i><b>10</b> FAQs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="faqs.html"><a href="faqs.html#common-error-messages"><i class="fa fa-check"></i><b>10.1</b> Common error messages</a>
<ul>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#a-general-note-on-error-messages"><i class="fa fa-check"></i>A general note on error messages</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#error-in-filefile-rt-cannot-open-the-connection"><i class="fa fa-check"></i>Error in file(file, “rt”): cannot open the connection</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#error-unexpected-symbol-in-call"><i class="fa fa-check"></i>Error: unexpected ‘SYMBOL’ in “CALL”</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#error-in-call-object-of-type-closure-is-not-subsettable"><i class="fa fa-check"></i>Error in CALL : object of type ‘closure’ is not subsettable</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#error-in-call_with_-operator-is-invalid-for-atomic-vectors"><i class="fa fa-check"></i>Error in CALL_WITH_$: $ operator is invalid for atomic vectors</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#error-in-call-object-name-not-found"><i class="fa fa-check"></i>Error in CALL: object ‘NAME’ not found</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#error-in-call-could-not-find-function-function"><i class="fa fa-check"></i>Error in CALL: could not find function “FUNCTION”</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#error-in-call-incorrect-number-of-dimension"><i class="fa fa-check"></i>Error in CALL: incorrect number of dimension</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="faqs.html"><a href="faqs.html#installation-of-r-packages"><i class="fa fa-check"></i><b>10.2</b> Installation of R packages</a>
<ul>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#what-are-the-different-ways-to-install-r-packages"><i class="fa fa-check"></i>What are the different ways to install R packages?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#i-cannot-install-packages-due-to-error-in-contrib.urlrepossource-or-warning-message-package-packagename-is-not-available-for-this-version-of-r"><i class="fa fa-check"></i>I cannot install packages due to “Error in contrib.url(repos,”source”)” or “Warning message: package ‘PACKAGENAME’ is not available for this version of R”</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#some-libraries-with-graphical-output-e.g.-summarytools-magick-fail-to-installload-properly-on-macos"><i class="fa fa-check"></i>Some libraries with graphical output (e.g., summarytools, magick) fail to install/load properly on MacOS</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#i-cannot-install-some-packages-on-macos"><i class="fa fa-check"></i>I cannot install some packages on MacOS</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="faqs.html"><a href="faqs.html#issues-with-statistics-and-data"><i class="fa fa-check"></i><b>10.3</b> Issues with statistics and data</a>
<ul>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#why-does-a-multi-item-scale-lead-to-increased-reliability"><i class="fa fa-check"></i>Why does a multi-item scale lead to increased reliability?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#why-can-demeaningstandardization-lead-to-missing-values"><i class="fa fa-check"></i>Why can demeaning/standardization lead to missing values?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#the-confidence-interval-ci-of-the-mean-seems-very-small-compared-to-the-dispersion-of-my-sample.-can-this-be-correct"><i class="fa fa-check"></i>The confidence interval (CI) of the mean seems very small compared to the dispersion of my sample. Can this be correct?</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="faqs.html"><a href="faqs.html#errors-related-to-specific-methods"><i class="fa fa-check"></i><b>10.4</b> Errors related to specific methods</a>
<ul>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#logistic-regression-1"><i class="fa fa-check"></i>Logistic regression</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#when-using-logistic-regression-error-in-weights-y-non-numeric-argument-to-binary-operator"><i class="fa fa-check"></i>When using logistic regression: Error in weights * y : non-numeric argument to binary operator</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="faqs.html"><a href="faqs.html#general-settings-and-options"><i class="fa fa-check"></i><b>10.5</b> General settings and options</a>
<ul>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#numbers-are-formatted-weirdly"><i class="fa fa-check"></i>Numbers are formatted weirdly</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="faqs.html"><a href="faqs.html#data-visualizationoutput-issues"><i class="fa fa-check"></i><b>10.6</b> Data visualization/output issues</a>
<ul>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#how-can-the-geom-colors-in-a-ggplot-be-changed"><i class="fa fa-check"></i>How can the <code>geom</code> colors in a <code>ggplot</code> be changed?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#why-are-some-histograms-displayed-differently"><i class="fa fa-check"></i>Why are some histograms displayed differently?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#some-labels-in-plots-are-cut-off.-how-can-i-extend-the-plot-margins"><i class="fa fa-check"></i>Some labels in plots are cut off. How can I extend the plot margins?</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="faqs.html"><a href="faqs.html#issues-with-functions-and-function-arguments"><i class="fa fa-check"></i><b>10.7</b> Issues with functions and function arguments</a>
<ul>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#problems-with-factor-and-as.factor"><i class="fa fa-check"></i>Problems with <code>factor</code> and <code>as.factor</code></a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#how-can-i-find-an-explanation-of-the-output-of-a-function"><i class="fa fa-check"></i>How can I find an explanation of the output of a function?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#what-does-the-margin-argument-do"><i class="fa fa-check"></i>What does the <code>MARGIN</code> argument do?</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="faqs.html"><a href="faqs.html#issues-with-r-markdown"><i class="fa fa-check"></i><b>10.8</b> Issues with R Markdown</a>
<ul>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#i-get-an-error-when-knitting-to-pdf-but-it-works-for-html"><i class="fa fa-check"></i>I get an error when <code>knit</code>ting to PDF but it works for HTML</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#i-am-not-sure-where-r-code-latex-math-and-text-go"><i class="fa fa-check"></i>I am not sure where R-code, LaTeX math, and text go</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="faqs.html"><a href="faqs.html#new-questions"><i class="fa fa-check"></i><b>10.9</b> New questions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Marketing Analytics 2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-markdown" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> R Markdown<a href="r-markdown.html#r-markdown" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-to-r-markdown" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Introduction to R Markdown<a href="r-markdown.html#introduction-to-r-markdown" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="infobox download">
<p><a href="./Code/rmarkdown_example.Rmd">You can download the example markdown file here</a></p>
</div>
<p>This page will guide you through creating and editing R Markdown documents. This is a useful tool for reporting your analysis (e.g. for homework assignments). Of course, there is also <a href="https://www.rstudio.org/links/r_markdown_cheat_sheet">a cheat sheet for R-Markdown</a> and <a href="https://bookdown.org/yihui/rmarkdown/">this book</a> contains a comprehensive discussion of the format.</p>
<p>The following video contains a short introduction to the R Markdown format.</p>
<br>
<div align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/o8FdyMAR-g4" frameborder="0" allowfullscreen>
</iframe>
</div>
<p><br></p>
<div id="creating-a-new-r-markdown-document" class="section level3 unnumbered hasAnchor">
<h3>Creating a new R Markdown document<a href="r-markdown.html#creating-a-new-r-markdown-document" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to the video, the following text contains a short description of the most important formatting options.</p>
<p>Let’s start to go through the steps of creating and .Rmd file and outputting the content to an HTML file.</p>
<ol start="0" style="list-style-type: decimal">
<li><p>If an R-Markdown file was provided to you, open it with R-Studio and skip to <a href="#step4">step 4</a> after adding your answers.</p></li>
<li><p>Open R-Studio</p></li>
<li><p>Create a new R-Markdown document
<img src="rmdExplain/start.PNG" />
<img src="rmdExplain/openDoc.PNG" />
<img src="rmdExplain/enterName.PNG" />
<img src="rmdExplain/template.PNG" /></p></li>
<li><p>Save with appropriate name
<img src="rmdExplain/saving.PNG" /></p>
<p>3.1. Add your answers</p>
<p>3.2. Save again</p></li>
</ol>
<p><a name="step4"></a></p>
<ol start="4" style="list-style-type: decimal">
<li><p>“Knit” to HTML
<img src="rmdExplain/knit.PNG" /></p></li>
<li><p>Hand in appropriate file (ending in <code>.html</code>) on learn@WU
<img src="rmdExplain/handin.PNG" /></p></li>
</ol>
</div>
<div id="text-and-equations" class="section level3 unnumbered hasAnchor">
<h3>Text and Equations<a href="r-markdown.html#text-and-equations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R-Markdown documents are plain text files that include both text and R-code. Using RStudio they can be converted (‘knitted’) to HTML or PDF files that include both the text and the results of the R-code. In fact this website is written using R-Markdown and RStudio. In order for RStudio to be able to interpret the document you have to use certain characters or combinations of characters when formatting text and including R-code to be evaluated. By default the document starts with the options for the text part. You can change the title, date, author and a few more advanced options.</p>
<div class="float">
<img src="rmdExplain/rmdHead.PNG" alt="First lines of an R-Markdown document" />
<div class="figcaption">First lines of an R-Markdown document</div>
</div>
<p>The default is text mode, meaning that lines in an Rmd document will be interpreted as text, unless specified otherwise.</p>
<div id="headings" class="section level4 unnumbered hasAnchor">
<h4>Headings<a href="r-markdown.html#headings" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Usually you want to include some kind of heading to structure your text. A heading is created using <code>#</code> signs. A single <code>#</code> creates a first level heading, two <code>##</code> a second level and so on.</p>
<p><img src="rmdExplain/headings.PNG" /></p>
<p>It is important to note here that the <code>#</code> symbol means something different within the code chunks as opposed to outside of them. If you continue to put a <code>#</code> in front of all your regular text, it will all be interpreted as a first level heading, making your text very large.</p>
</div>
<div id="lists" class="section level4 unnumbered hasAnchor">
<h4>Lists<a href="r-markdown.html#lists" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Bullet point lists are created using <code>*</code>, <code>+</code> or <code>-</code>. Sub-items are created by indenting the item using 4 spaces or 2 tabs.</p>
<pre><code>* First Item
* Second Item
    + first sub-item
        - first sub-sub-item
    + second sub-item</code></pre>
<ul>
<li>First Item</li>
<li>Second Item
<ul>
<li>first sub-item
<ul>
<li>first sub-sub-item</li>
</ul></li>
<li>second sub-item</li>
</ul></li>
</ul>
<p>Ordered lists can be created using numbers and letters. If you need sub-sub-items use <code>A)</code> instead of <code>A.</code> on the third level.</p>
<pre><code>1. First item
    a. first sub-item
        A) first sub-sub-item 
     b. second sub-item
2. Second item</code></pre>
<ol style="list-style-type: decimal">
<li>First item
<ol style="list-style-type: lower-alpha">
<li>first sub-item
<ol style="list-style-type: upper-alpha">
<li>first sub-sub-item</li>
</ol></li>
<li>second sub-item</li>
</ol></li>
<li>Second item</li>
</ol>
</div>
<div id="text-formatting" class="section level4 unnumbered hasAnchor">
<h4>Text formatting<a href="r-markdown.html#text-formatting" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Text can be formatted in <em>italics</em> (<code>*italics*</code>) or <strong>bold</strong> (<code>**bold**</code>). In addition, you can ad block quotes with <code>&gt;</code></p>
<pre><code>&gt; Lorem ipsum dolor amet chillwave lomo ramps, four loko green juice messenger bag raclette forage offal shoreditch chartreuse austin. Slow-carb poutine meggings swag blog, pop-up salvia taxidermy bushwick freegan ugh poke.</code></pre>
<blockquote>
<p>Lorem ipsum dolor amet chillwave lomo ramps, four loko green juice messenger bag raclette forage offal shoreditch chartreuse austin. Slow-carb poutine meggings swag blog, pop-up salvia taxidermy bushwick freegan ugh poke.</p>
</blockquote>
</div>
</div>
<div id="r-code" class="section level3 unnumbered hasAnchor">
<h3>R-Code<a href="r-markdown.html#r-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R-code is contained in so called “chunks”. These chunks always start with three backticks and <code>r</code> in curly braces (<code></code>{r} <code>) and end with three backticks (</code> <code></code>). Optionally, parameters can be added after the <code>r</code> to influence how a chunk behaves. Additionally, you can also give each chunk a name. Note that these have to be <strong>unique</strong>, otherwise R will refuse to knit your document.</p>
<div id="global-and-chunk-options" class="section level4 unnumbered hasAnchor">
<h4>Global and chunk options<a href="r-markdown.html#global-and-chunk-options" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The first chunk always looks as follows</p>
<pre><code>```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```</code></pre>
<p>It is added to the document automatically and sets options for all the following chunks. These options can be overwritten on a per-chunk basis.</p>
<p>Keep <code>knitr::opts_chunk$set(echo = TRUE)</code> to print your code to the document you will hand in. Changing it to <code>knitr::opts_chunk$set(echo = FALSE)</code> will not print your code by default. This can be changed on a per-chunk basis.</p>
<pre><code>```{r cars, echo = FALSE}
summary(cars)

plot(dist~speed, cars)
```</code></pre>
<pre><code>##      speed           dist       
##  Min.   : 4.0   Min.   :  2.00  
##  1st Qu.:12.0   1st Qu.: 26.00  
##  Median :15.0   Median : 36.00  
##  Mean   :15.4   Mean   : 42.98  
##  3rd Qu.:19.0   3rd Qu.: 56.00  
##  Max.   :25.0   Max.   :120.00</code></pre>
<p><img src="14-rmdIntro_files/figure-html/cars-1.png" width="672" /></p>
<pre><code>```{r cars2, echo = TRUE}
summary(cars)

plot(dist~speed, cars)
```</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="r-markdown.html#cb691-1" tabindex="-1"></a><span class="fu">summary</span>(cars)</span></code></pre></div>
<pre><code>##      speed           dist       
##  Min.   : 4.0   Min.   :  2.00  
##  1st Qu.:12.0   1st Qu.: 26.00  
##  Median :15.0   Median : 36.00  
##  Mean   :15.4   Mean   : 42.98  
##  3rd Qu.:19.0   3rd Qu.: 56.00  
##  Max.   :25.0   Max.   :120.00</code></pre>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="r-markdown.html#cb693-1" tabindex="-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, cars)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/cars2-1.png" width="672" /></p>
<p>A good overview of all available global/chunk options can be found <a href="https://yihui.name/knitr/options/#chunk_options">here</a>.</p>
</div>
</div>
<div id="latex-math" class="section level3 unnumbered hasAnchor">
<h3>LaTeX Math<a href="r-markdown.html#latex-math" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Writing well formatted mathematical formulas is done the same way as in <a href="https://en.wikipedia.org/wiki/LaTeX">LaTeX</a>. Math mode is started and ended using <code>$$</code>.</p>
<pre><code>$$
 f_1(\omega) = \frac{\sigma^2}{2 \pi},\ \omega \in[-\pi, \pi]
$$</code></pre>
<p><span class="math display">\[
f_1(\omega) = \frac{\sigma^2}{2 \pi},\ \omega \in[-\pi, \pi]
\]</span></p>
<p>(for those interested this is the spectral density of <a href="https://en.wikipedia.org/wiki/White_noise">white noise</a>)</p>
<p>Including inline mathematical notation is done with a single <code>$</code> symbol.</p>
<pre><code>${2\over3}$ of my code is inline.
</code></pre>
<p><span class="math inline">\({2\over3}\)</span> of my code is inline.</p>
<p><br></p>
<p>Take a look at <a href="https://en.wikibooks.org/wiki/LaTeX/Mathematics#Symbols">this wikibook on Mathematics in LaTeX</a> and <a href="https://www.sharelatex.com/learn/List_of_Greek_letters_and_math_symbols">this list of Greek letters and mathematical symbols</a> if you are not familiar with LaTeX.</p>
<p>In order to write multi-line equations in the same math environment, use <code>\\</code> after every line. In order to insert a space use a single <code>\</code>. To render text inside a math environment use <code>\text{here is the text}</code>. In order to align equations start with <code>\begin{align}</code> and place an <code>&amp;</code> in each line at the point around which it should be aligned. Finally end with <code>\end{align}</code></p>
<pre><code>$$
\begin{align}
\text{First equation: }\ Y &amp;= X \beta + \epsilon_y,\ \forall X \\
\text{Second equation: }\ X &amp;= Z \gamma + \epsilon_x
\end{align}
$$</code></pre>
<p><span class="math display">\[
\begin{align}
\text{First equation: }\ Y &amp;= X \beta + \epsilon_y,\ \forall X \\
\text{Second equation: }\ X &amp;= Z \gamma + \epsilon_x
\end{align}
\]</span></p>
<div id="important-symbols" class="section level4 unnumbered hasAnchor">
<h4>Important symbols<a href="r-markdown.html#important-symbols" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Symbol
</th>
<th style="text-align:left;">
Code
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a^{2} + b\)</span>
</td>
<td style="text-align:left;">
<code>a^{2} + b</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a^{2+b}\)</span>
</td>
<td style="text-align:left;">
<code>a^{2+b}</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a_{1}\)</span>
</td>
<td style="text-align:left;">
<code>a_{1}</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a \leq b\)</span>
</td>
<td style="text-align:left;">
<code>a \leq b</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a \geq b\)</span>
</td>
<td style="text-align:left;">
<code>a \geq b</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a \neq b\)</span>
</td>
<td style="text-align:left;">
<code>a \neq b</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a \approx b\)</span>
</td>
<td style="text-align:left;">
<code>a \approx b</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a \in (0,1)\)</span>
</td>
<td style="text-align:left;">
<code>a \in (0,1)</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a \rightarrow \infty\)</span>
</td>
<td style="text-align:left;">
<code>a \rightarrow \infty</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\frac{a}{b}\)</span>
</td>
<td style="text-align:left;">
<code>\frac{a}{b}</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\frac{\partial a}{\partial b}\)</span>
</td>
<td style="text-align:left;">
<code>\frac{\partial a}{\partial b}</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{a}\)</span>
</td>
<td style="text-align:left;">
<code>\sqrt{a}</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum_{i = 1}^{b} a_i\)</span>
</td>
<td style="text-align:left;">
<code>\sum_{i = 1}^{b} a_i</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\int_{a}^b f(c) dc\)</span>
</td>
<td style="text-align:left;">
<code>\int_{a}^b f(c) dc</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\prod_{i = 0}^b a_i\)</span>
</td>
<td style="text-align:left;">
<code>\prod_{i = 0}^b a_i</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(c \left( \sum_{i=1}^b a_i \right)\)</span>
</td>
<td style="text-align:left;">
<code>c \left( \sum_{i=1}^b a_i \right)</code>
</td>
</tr>
</tbody>
</table>
<p>The <code>{}</code> after <code>_</code> and <code>^</code> are not strictly necessary if there is only one character in the sub-/superscript. However, in order to place multiple characters in the sub-/superscript they are necessary.
e.g.</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Symbol
</th>
<th style="text-align:left;">
Code
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a^b = a^{b}\)</span>
</td>
<td style="text-align:left;">
<code>a^b = a^{b}</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(a^b+c \neq a^{b+c}\)</span>
</td>
<td style="text-align:left;">
<code>a^b+c \neq a^{b+c}</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum_i a_i = \sum_{i} a_{i}\)</span>
</td>
<td style="text-align:left;">
<code>\sum_i a_i = \sum_{i} a_{i}</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum_{i=1}^{b+c} a_i \neq \sum_i=1^b+c a_i\)</span>
</td>
<td style="text-align:left;">
<code>\sum_{i=1}^{b+c} a_i \neq \sum_i=1^b+c a_i</code>
</td>
</tr>
</tbody>
</table>
</div>
<div id="greek-letters" class="section level4 unnumbered hasAnchor">
<h4>Greek letters<a href="r-markdown.html#greek-letters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="https://en.wikipedia.org/wiki/Greek_alphabet#Letters">Greek letters</a> are preceded by a <code>\</code> followed by their name (<code>$\beta$</code> = <span class="math inline">\(\beta\)</span>). In order to capitalize them simply capitalize the first letter of the name (<code>$\Gamma$</code> = <span class="math inline">\(\Gamma\)</span>).</p>
</div>
</div>
</div>
<div id="assignment-1" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Assignment 1<a href="r-markdown.html#assignment-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="load-libraries-and-data" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Load libraries and data<a href="r-markdown.html#load-libraries-and-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For your convenience the following code will load the required <code>tidyverse</code> library as well as the data. Make sure to convert each of the variables you use for you analysis to the appropriate data types (e.g., <code>Date</code>, <code>factor</code>).</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="r-markdown.html#cb697-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb697-2"><a href="r-markdown.html#cb697-2" tabindex="-1"></a>music_data <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;https://raw.githubusercontent.com/WU-RDS/MA2024/main/data/music_data_fin.csv&quot;</span>)</span>
<span id="cb697-3"><a href="r-markdown.html#cb697-3" tabindex="-1"></a><span class="fu">str</span>(music_data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    66796 obs. of  31 variables:
##  $ isrc                       : chr  &quot;BRRGE1603547&quot; &quot;USUM71808193&quot; &quot;ES5701800181&quot; &quot;ITRSE2000050&quot; ...
##  $ artist_id                  : int  3679 5239 776407 433730 526471 1939 210184 212546 4938 119985 ...
##  $ streams                    : num  11944813 8934097 38835 46766 2930573 ...
##  $ weeks_in_charts            : int  141 51 1 1 7 226 13 1 64 7 ...
##  $ n_regions                  : int  1 21 1 1 4 8 1 1 5 1 ...
##  $ danceability               : num  50.9 35.3 68.3 70.4 84.2 35.2 73 55.6 71.9 34.6 ...
##  $ energy                     : num  80.3 75.5 67.6 56.8 57.8 91.1 69.6 24.5 85 43.3 ...
##  $ speechiness                : num  4 73.3 14.7 26.8 13.8 7.47 35.5 3.05 3.17 6.5 ...
##  $ instrumentalness           : num  0.05 0 0 0.000253 0 0 0 0 0.02 0 ...
##  $ liveness                   : num  46.3 39 7.26 8.91 22.8 9.95 32.1 9.21 11.4 10.1 ...
##  $ valence                    : num  65.1 43.7 43.4 49.5 19 23.6 58.4 27.6 36.7 76.8 ...
##  $ tempo                      : num  166 191.2 99 91 74.5 ...
##  $ song_length                : num  3.12 3.23 3.02 3.45 3.95 ...
##  $ song_age                   : num  228.3 144.3 112.3 50.7 58.3 ...
##  $ explicit                   : int  0 0 0 0 0 0 0 0 1 0 ...
##  $ n_playlists                : int  450 768 48 6 475 20591 6 105 547 688 ...
##  $ sp_popularity              : int  51 54 32 44 52 81 44 8 59 68 ...
##  $ youtube_views              : num  1.45e+08 1.32e+07 6.12e+06 0.00 0.00 ...
##  $ tiktok_counts              : int  9740 358700 0 13 515 67300 0 0 653 3807 ...
##  $ ins_followers_artist       : int  29613108 3693566 623778 81601 11962358 1169284 1948850 39381 9751080 343 ...
##  $ monthly_listeners_artist   : int  4133393 18367363 888273 143761 15551876 16224250 2683086 1318874 4828847 3088232 ...
##  $ playlist_total_reach_artist: int  24286416 143384531 4846378 156521 90841884 80408253 7332603 24302331 8914977 8885252 ...
##  $ sp_fans_artist             : int  3308630 465412 23846 1294 380204 1651866 214001 10742 435457 1897685 ...
##  $ shazam_counts              : int  73100 588550 0 0 55482 5281161 0 0 39055 0 ...
##  $ artistName                 : chr  &quot;Luan Santana&quot; &quot;Alessia Cara&quot; &quot;Ana Guerra&quot; &quot;Claver Gold feat. Murubutu&quot; ...
##  $ trackName                  : chr  &quot;Eu, Você, O Mar e Ela&quot; &quot;Growing Pains&quot; &quot;El Remedio&quot; &quot;Ulisse&quot; ...
##  $ release_date               : chr  &quot;2016-06-20&quot; &quot;2018-06-14&quot; &quot;2018-04-26&quot; &quot;2020-03-31&quot; ...
##  $ genre                      : chr  &quot;other&quot; &quot;Pop&quot; &quot;Pop&quot; &quot;HipHop/Rap&quot; ...
##  $ label                      : chr  &quot;Independent&quot; &quot;Universal Music&quot; &quot;Universal Music&quot; &quot;Independent&quot; ...
##  $ top10                      : int  1 0 0 0 0 1 0 0 0 0 ...
##  $ expert_rating              : chr  &quot;excellent&quot; &quot;good&quot; &quot;good&quot; &quot;poor&quot; ...</code></pre>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="r-markdown.html#cb699-1" tabindex="-1"></a><span class="fu">head</span>(music_data, <span class="dv">2</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["isrc"],"name":[1],"type":["chr"],"align":["left"]},{"label":["artist_id"],"name":[2],"type":["int"],"align":["right"]},{"label":["streams"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["weeks_in_charts"],"name":[4],"type":["int"],"align":["right"]},{"label":["n_regions"],"name":[5],"type":["int"],"align":["right"]},{"label":["danceability"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["energy"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["speechiness"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["instrumentalness"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["liveness"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["valence"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["tempo"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["song_length"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["song_age"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["explicit"],"name":[15],"type":["int"],"align":["right"]},{"label":["n_playlists"],"name":[16],"type":["int"],"align":["right"]},{"label":["sp_popularity"],"name":[17],"type":["int"],"align":["right"]},{"label":["youtube_views"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["tiktok_counts"],"name":[19],"type":["int"],"align":["right"]},{"label":["ins_followers_artist"],"name":[20],"type":["int"],"align":["right"]},{"label":["monthly_listeners_artist"],"name":[21],"type":["int"],"align":["right"]},{"label":["playlist_total_reach_artist"],"name":[22],"type":["int"],"align":["right"]},{"label":["sp_fans_artist"],"name":[23],"type":["int"],"align":["right"]},{"label":["shazam_counts"],"name":[24],"type":["int"],"align":["right"]},{"label":["artistName"],"name":[25],"type":["chr"],"align":["left"]},{"label":["trackName"],"name":[26],"type":["chr"],"align":["left"]},{"label":["release_date"],"name":[27],"type":["chr"],"align":["left"]},{"label":["genre"],"name":[28],"type":["chr"],"align":["left"]},{"label":["label"],"name":[29],"type":["chr"],"align":["left"]},{"label":["top10"],"name":[30],"type":["int"],"align":["right"]},{"label":["expert_rating"],"name":[31],"type":["chr"],"align":["left"]}],"data":[{"1":"BRRGE1603547","2":"3679","3":"11944813","4":"141","5":"1","6":"50.9","7":"80.3","8":"4.0","9":"0.05","10":"46.3","11":"65.1","12":"166.018","13":"3.11865","14":"228.2857","15":"0","16":"450","17":"51","18":"145030723","19":"9740","20":"29613108","21":"4133393","22":"24286416","23":"3308630","24":"73100","25":"Luan Santana","26":"Eu, Você, O Mar e Ela","27":"2016-06-20","28":"other","29":"Independent","30":"1","31":"excellent"},{"1":"USUM71808193","2":"5239","3":"8934097","4":"51","5":"21","6":"35.3","7":"75.5","8":"73.3","9":"0.00","10":"39.0","11":"43.7","12":"191.153","13":"3.22800","14":"144.2857","15":"0","16":"768","17":"54","18":"13188411","19":"358700","20":"3693566","21":"18367363","22":"143384531","23":"465412","24":"588550","25":"Alessia Cara","26":"Growing Pains","27":"2018-06-14","28":"Pop","29":"Universal Music","30":"0","31":"good"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="task-1" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Task 1<a href="r-markdown.html#task-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Determine the most popular song by the artist “BTS”.</li>
<li>Create a new <code>data.frame</code> that only contains songs by “BTS” (Bonus: Also include songs that feature both BTS and other artists, see e.g., “BTS feat. Charli XCX”)</li>
<li>Save the <code>data.frame</code> sorted by success (number of streams) with the most popular songs occurring first.</li>
</ol>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="r-markdown.html#cb700-1" tabindex="-1"></a><span class="co"># provide your code here 1.</span></span>
<span id="cb700-2"><a href="r-markdown.html#cb700-2" tabindex="-1"></a>music_data <span class="sc">|&gt;</span></span>
<span id="cb700-3"><a href="r-markdown.html#cb700-3" tabindex="-1"></a>    <span class="fu">filter</span>(artistName <span class="sc">==</span> <span class="st">&quot;BTS&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb700-4"><a href="r-markdown.html#cb700-4" tabindex="-1"></a>    <span class="fu">slice_max</span>(<span class="at">order_by =</span> streams, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb700-5"><a href="r-markdown.html#cb700-5" tabindex="-1"></a>    <span class="fu">select</span>(artistName, trackName)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["artistName"],"name":[1],"type":["chr"],"align":["left"]},{"label":["trackName"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"BTS","2":"Dynamite"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="r-markdown.html#cb701-1" tabindex="-1"></a><span class="do">## 2.</span></span>
<span id="cb701-2"><a href="r-markdown.html#cb701-2" tabindex="-1"></a>bts_data <span class="ot">&lt;-</span> music_data <span class="sc">|&gt;</span></span>
<span id="cb701-3"><a href="r-markdown.html#cb701-3" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">str_detect</span>(artistName, <span class="st">&quot;BTS&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb701-4"><a href="r-markdown.html#cb701-4" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(streams))</span>
<span id="cb701-5"><a href="r-markdown.html#cb701-5" tabindex="-1"></a><span class="fu">distinct</span>(bts_data, artistName)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["artistName"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"BTS feat. Halsey"},{"1":"BTS"},{"1":"BTS feat. Lauv"},{"1":"BTS feat. Desiigner feat. Steve Aoki"},{"1":"Steve Aoki feat. BTS"},{"1":"BTS feat. Nicki Minaj"},{"1":"Lil Nas X feat. RM feat. BTS"},{"1":"BTS feat. Charli XCX"},{"1":"BTS feat. Steve Aoki"},{"1":"Lauv feat. BTS"},{"1":"BTS feat. Zara Larsson"},{"1":"BTS feat. Juice WRLD"},{"1":"Halsey feat. SUGA feat. BTS"},{"1":"BTS feat. Lauv feat. Frants"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="r-markdown.html#cb702-1" tabindex="-1"></a><span class="fu">head</span>(bts_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["isrc"],"name":[1],"type":["chr"],"align":["left"]},{"label":["artist_id"],"name":[2],"type":["int"],"align":["right"]},{"label":["streams"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["weeks_in_charts"],"name":[4],"type":["int"],"align":["right"]},{"label":["n_regions"],"name":[5],"type":["int"],"align":["right"]},{"label":["danceability"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["energy"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["speechiness"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["instrumentalness"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["liveness"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["valence"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["tempo"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["song_length"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["song_age"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["explicit"],"name":[15],"type":["int"],"align":["right"]},{"label":["n_playlists"],"name":[16],"type":["int"],"align":["right"]},{"label":["sp_popularity"],"name":[17],"type":["int"],"align":["right"]},{"label":["youtube_views"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["tiktok_counts"],"name":[19],"type":["int"],"align":["right"]},{"label":["ins_followers_artist"],"name":[20],"type":["int"],"align":["right"]},{"label":["monthly_listeners_artist"],"name":[21],"type":["int"],"align":["right"]},{"label":["playlist_total_reach_artist"],"name":[22],"type":["int"],"align":["right"]},{"label":["sp_fans_artist"],"name":[23],"type":["int"],"align":["right"]},{"label":["shazam_counts"],"name":[24],"type":["int"],"align":["right"]},{"label":["artistName"],"name":[25],"type":["chr"],"align":["left"]},{"label":["trackName"],"name":[26],"type":["chr"],"align":["left"]},{"label":["release_date"],"name":[27],"type":["chr"],"align":["left"]},{"label":["genre"],"name":[28],"type":["chr"],"align":["left"]},{"label":["label"],"name":[29],"type":["chr"],"align":["left"]},{"label":["top10"],"name":[30],"type":["int"],"align":["right"]},{"label":["expert_rating"],"name":[31],"type":["chr"],"align":["left"]}],"data":[{"1":"QM6MZ1917908","2":"206557","3":"275102347","4":"709","5":"35","6":"64.5","7":"86.2","8":"9.65","9":"0","10":"19.20","11":"79.8","12":"119.991","13":"3.829550","14":"101.28571","15":"0","16":"2604","17":"83","18":"1169494158","19":"1400000","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"2602443","25":"BTS feat. Halsey","26":"Boy With Luv (feat. Halsey)","27":"2019-04-12","28":"other","29":"Independent","30":"1","31":"excellent"},{"1":"QM7282022872","2":"206557","3":"267700100","4":"121","5":"35","6":"74.6","7":"76.5","8":"9.93","9":"0","10":"9.36","11":"73.7","12":"114.044","13":"3.317567","14":"17.28571","15":"0","16":"3582","17":"91","18":"935819744","19":"3000000","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"5295990","25":"BTS","26":"Dynamite","27":"2020-08-21","28":"other","29":"Independent","30":"1","31":"good"},{"1":"QM7282022872","2":"206557","3":"261662772","4":"81","5":"35","6":"74.6","7":"76.5","8":"9.93","9":"0","10":"9.36","11":"73.7","12":"114.044","13":"3.317567","14":"29.28571","15":"0","16":"3582","17":"91","18":"935819744","19":"3000000","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"5295990","25":"BTS","26":"Dynamite","27":"2020-08-21","28":"other","29":"Independent","30":"1","31":"excellent"},{"1":"QMBZ92051791","2":"206557","3":"98155659","4":"121","5":"35","6":"56.6","7":"71.6","8":"4.24","9":"0","10":"37.00","11":"45.0","12":"81.068","13":"3.458017","14":"17.28571","15":"0","16":"659","17":"89","18":"293571799","19":"908000","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"1089231","25":"BTS","26":"Life Goes On","27":"2020-11-20","28":"other","29":"Independent","30":"1","31":"fair"},{"1":"KRA381702187","2":"206557","3":"53816537","4":"906","5":"35","6":"59.8","7":"77.5","8":"5.45","9":"0","10":"6.77","11":"68.7","12":"129.819","13":"3.718717","14":"182.85714","15":"1","16":"2459","17":"72","18":"1226858563","19":"189000","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"718165","25":"BTS","26":"DNA","27":"2017-09-18","28":"other","29":"Independent","30":"1","31":"masterpiece"},{"1":"QM4TX2001949","2":"206557","3":"49160372","4":"345","5":"34","6":"58.3","7":"81.7","8":"9.87","9":"0","10":"33.80","11":"43.8","12":"105.936","13":"4.106350","14":"56.28571","15":"0","16":"722","17":"79","18":"339282518","19":"260900","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"0","25":"BTS","26":"ON","27":"2020-02-21","28":"other","29":"Independent","30":"1","31":"excellent"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="r-markdown.html#cb703-1" tabindex="-1"></a><span class="fu">tail</span>(bts_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["isrc"],"name":[1],"type":["chr"],"align":["left"]},{"label":["artist_id"],"name":[2],"type":["int"],"align":["right"]},{"label":["streams"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["weeks_in_charts"],"name":[4],"type":["int"],"align":["right"]},{"label":["n_regions"],"name":[5],"type":["int"],"align":["right"]},{"label":["danceability"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["energy"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["speechiness"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["instrumentalness"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["liveness"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["valence"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["tempo"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["song_length"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["song_age"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["explicit"],"name":[15],"type":["int"],"align":["right"]},{"label":["n_playlists"],"name":[16],"type":["int"],"align":["right"]},{"label":["sp_popularity"],"name":[17],"type":["int"],"align":["right"]},{"label":["youtube_views"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["tiktok_counts"],"name":[19],"type":["int"],"align":["right"]},{"label":["ins_followers_artist"],"name":[20],"type":["int"],"align":["right"]},{"label":["monthly_listeners_artist"],"name":[21],"type":["int"],"align":["right"]},{"label":["playlist_total_reach_artist"],"name":[22],"type":["int"],"align":["right"]},{"label":["sp_fans_artist"],"name":[23],"type":["int"],"align":["right"]},{"label":["shazam_counts"],"name":[24],"type":["int"],"align":["right"]},{"label":["artistName"],"name":[25],"type":["chr"],"align":["left"]},{"label":["trackName"],"name":[26],"type":["chr"],"align":["left"]},{"label":["release_date"],"name":[27],"type":["chr"],"align":["left"]},{"label":["genre"],"name":[28],"type":["chr"],"align":["left"]},{"label":["label"],"name":[29],"type":["chr"],"align":["left"]},{"label":["top10"],"name":[30],"type":["int"],"align":["right"]},{"label":["expert_rating"],"name":[31],"type":["chr"],"align":["left"]}],"data":[{"1":"JPPO01701387","2":"206557","3":"9278","4":"2","5":"2","6":"54.8","7":"83.7","8":"3.64","9":"0.00","10":"13.0","11":"32.7","12":"107.004","13":"4.569333","14":"201.5714","15":"0","16":"245","17":"37","18":"603945","19":"575","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"0","25":"BTS","26":"Spring Day - Japanese ver.","27":"2017-05-09","28":"HipHop/Rap","29":"Universal Music","30":"0","31":"fair"},{"1":"KRA381601893","2":"206557","3":"9218","4":"1","5":"2","6":"56.4","7":"82.7","8":"4.26","9":"0.01","10":"14.7","11":"31.3","12":"131.052","13":"3.829133","14":"231.8571","15":"1","16":"1788","17":"64","18":"5313984","19":"4013","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"74165","25":"BTS","26":"Begin","27":"2016-10-09","28":"other","29":"Independent","30":"0","31":"poor"},{"1":"KRA381601904","2":"206557","3":"5035","4":"1","5":"1","6":"44.2","7":"92.1","8":"20.20","9":"0.00","10":"10.0","11":"61.2","12":"169.892","13":"4.542717","14":"231.8571","15":"1","16":"1578","17":"62","18":"0","19":"0","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"90121","25":"BTS","26":"2! 3!","27":"2016-10-09","28":"other","29":"Independent","30":"0","31":"excellent"},{"1":"JPPO01701386","2":"206557","3":"4839","4":"3","5":"1","6":"59.4","7":"95.1","8":"14.50","9":"0.00","10":"96.5","11":"65.3","12":"110.041","13":"3.868883","14":"201.5714","15":"0","16":"247","17":"47","18":"0","19":"545","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"0","25":"BTS","26":"Not Today - Japanese ver.","27":"2017-05-09","28":"HipHop/Rap","29":"Universal Music","30":"0","31":"excellent"},{"1":"JPPO01701387","2":"206557","3":"3085","4":"2","5":"1","6":"54.8","7":"82.9","8":"3.71","9":"0.00","10":"13.6","11":"33.1","12":"106.996","13":"4.569333","14":"201.5714","15":"0","16":"245","17":"37","18":"603945","19":"575","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"0","25":"BTS","26":"Spring Day - Japanese ver.","27":"2017-05-09","28":"HipHop/Rap","29":"Universal Music","30":"0","31":"excellent"},{"1":"JPPO01701386","2":"206557","3":"2178","4":"1","5":"1","6":"59.1","7":"95.5","8":"14.30","9":"0.00","10":"96.3","11":"64.1","12":"110.063","13":"3.868883","14":"201.5714","15":"0","16":"247","17":"47","18":"0","19":"545","20":"38700892","21":"26147576","22":"152858657","23":"2166028","24":"0","25":"BTS","26":"Not Today - Japanese ver.","27":"2017-05-09","28":"HipHop/Rap","29":"Universal Music","30":"0","31":"excellent"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="task-2" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Task 2<a href="r-markdown.html#task-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a new <code>data.frame</code> containing the 100 most streamed songs.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="r-markdown.html#cb704-1" tabindex="-1"></a><span class="co"># provide your code here</span></span>
<span id="cb704-2"><a href="r-markdown.html#cb704-2" tabindex="-1"></a>top100 <span class="ot">&lt;-</span> <span class="fu">slice_max</span>(music_data, <span class="at">order_by =</span> streams,</span>
<span id="cb704-3"><a href="r-markdown.html#cb704-3" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb704-4"><a href="r-markdown.html#cb704-4" tabindex="-1"></a><span class="fu">range</span>(top100<span class="sc">$</span>streams)</span></code></pre></div>
<pre><code>## [1]  490037377 2165692479</code></pre>
</div>
<div id="task-3" class="section level3 hasAnchor" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> Task 3<a href="r-markdown.html#task-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Determine the most popular genres.</li>
</ol>
<ul>
<li>Group the data by genre and calculate the total number of streams within each genre.</li>
<li>Sort the result to show the most popular genre first.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Create a bar plot in which the heights of the bars correspond to the total number of streams within a genre (Bonus: order the bars by their height)</li>
</ol>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="r-markdown.html#cb706-1" tabindex="-1"></a><span class="co"># provide your code here</span></span>
<span id="cb706-2"><a href="r-markdown.html#cb706-2" tabindex="-1"></a>genre_data <span class="ot">&lt;-</span> music_data <span class="sc">|&gt;</span></span>
<span id="cb706-3"><a href="r-markdown.html#cb706-3" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">.by =</span> genre, <span class="at">total_streams =</span> <span class="fu">sum</span>(streams)) <span class="sc">|&gt;</span></span>
<span id="cb706-4"><a href="r-markdown.html#cb706-4" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(total_streams)) <span class="sc">|&gt;</span></span>
<span id="cb706-5"><a href="r-markdown.html#cb706-5" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">genre =</span> <span class="fu">fct_reorder</span>(<span class="fu">as.factor</span>(genre), total_streams))</span>
<span id="cb706-6"><a href="r-markdown.html#cb706-6" tabindex="-1"></a><span class="fu">head</span>(genre_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["genre"],"name":[1],"type":["fct"],"align":["left"]},{"label":["total_streams"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Pop","2":"173713597202"},{"1":"HipHop/Rap","2":"143116357087"},{"1":"other","2":"65952433233"},{"1":"Electro/Dance","2":"33815774273"},{"1":"Rock","2":"29085255798"},{"1":"R&B","2":"28843269808"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="r-markdown.html#cb707-1" tabindex="-1"></a><span class="fu">ggplot</span>(genre_data, <span class="fu">aes</span>(<span class="at">y =</span> genre, <span class="at">x =</span> total_streams)) <span class="sc">+</span></span>
<span id="cb707-2"><a href="r-markdown.html#cb707-2" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/question_3_a1-1.png" width="672" /></p>
</div>
<div id="task-4" class="section level3 hasAnchor" number="8.2.5">
<h3><span class="header-section-number">8.2.5</span> Task 4<a href="r-markdown.html#task-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Rank the music labels by their success (total number of streams of all their songs)</li>
<li>Show the total number of streams as well as the average and the median of all songs by label. (Bonus: Also add the artist and track names and the number of streams of each label’s top song to the result)</li>
</ol>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="r-markdown.html#cb708-1" tabindex="-1"></a><span class="co"># provide your code here</span></span>
<span id="cb708-2"><a href="r-markdown.html#cb708-2" tabindex="-1"></a>label_data <span class="ot">&lt;-</span> music_data <span class="sc">|&gt;</span></span>
<span id="cb708-3"><a href="r-markdown.html#cb708-3" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">.by =</span> label, <span class="at">total_streams =</span> <span class="fu">sum</span>(streams),</span>
<span id="cb708-4"><a href="r-markdown.html#cb708-4" tabindex="-1"></a>        <span class="at">avg_streams =</span> <span class="fu">mean</span>(streams), <span class="at">med_streams =</span> <span class="fu">median</span>(streams),</span>
<span id="cb708-5"><a href="r-markdown.html#cb708-5" tabindex="-1"></a>        <span class="at">top_song_artist =</span> artistName[<span class="fu">which.max</span>(streams)],</span>
<span id="cb708-6"><a href="r-markdown.html#cb708-6" tabindex="-1"></a>        <span class="at">top_song_title =</span> trackName[<span class="fu">which.max</span>(streams)],</span>
<span id="cb708-7"><a href="r-markdown.html#cb708-7" tabindex="-1"></a>        <span class="at">top_song_streams =</span> <span class="fu">max</span>(streams)) <span class="sc">|&gt;</span></span>
<span id="cb708-8"><a href="r-markdown.html#cb708-8" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label_rank =</span> <span class="fu">dense_rank</span>(<span class="sc">-</span>total_streams)) <span class="sc">|&gt;</span></span>
<span id="cb708-9"><a href="r-markdown.html#cb708-9" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(total_streams))</span>
<span id="cb708-10"><a href="r-markdown.html#cb708-10" tabindex="-1"></a>label_data</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["label"],"name":[1],"type":["chr"],"align":["left"]},{"label":["total_streams"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["avg_streams"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["med_streams"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["top_song_artist"],"name":[5],"type":["chr"],"align":["left"]},{"label":["top_song_title"],"name":[6],"type":["chr"],"align":["left"]},{"label":["top_song_streams"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["label_rank"],"name":[8],"type":["int"],"align":["right"]}],"data":[{"1":"Universal Music","2":"197499391883","3":"9129964","4":"434943.0","5":"Billie Eilish","6":"bad guy","7":"1459149566","8":"1"},{"1":"Sony Music","2":"108111852495","3":"8725735","4":"355898.5","5":"Travis Scott","6":"SICKO MODE","7":"1032407145","8":"2"},{"1":"Independent","2":"94289773362","3":"4177659","4":"238884.0","5":"XXXTENTACION","6":"Jocelyn Flores","7":"936906948","8":"3"},{"1":"Warner Music","2":"88689942555","3":"8691684","4":"347152.5","5":"Ed Sheeran","6":"Shape of You","7":"2165692479","8":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="task-5" class="section level3 hasAnchor" number="8.2.6">
<h3><span class="header-section-number">8.2.6</span> Task 5<a href="r-markdown.html#task-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>How do genres differ in terms of song features (audio features + song length + explicitness + song age)?</li>
</ol>
<ul>
<li>Select appropriate summary statistics for each of the variables and highlight the differences between genres using the summary statistics.</li>
<li>Create an appropriate plot showing the differences of “energy” across genres.</li>
</ul>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="r-markdown.html#cb709-1" tabindex="-1"></a><span class="co"># provide your code here</span></span>
<span id="cb709-2"><a href="r-markdown.html#cb709-2" tabindex="-1"></a>music_data <span class="sc">|&gt;</span></span>
<span id="cb709-3"><a href="r-markdown.html#cb709-3" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">.by =</span> genre, <span class="fu">across</span>(danceability<span class="sc">:</span>explicit,</span>
<span id="cb709-4"><a href="r-markdown.html#cb709-4" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">avg =</span> mean, <span class="at">std.dev =</span> sd, <span class="at">median =</span> median,</span>
<span id="cb709-5"><a href="r-markdown.html#cb709-5" tabindex="-1"></a>            <span class="at">pct_10 =</span> \(x) <span class="fu">quantile</span>(x, <span class="fl">0.1</span>),</span>
<span id="cb709-6"><a href="r-markdown.html#cb709-6" tabindex="-1"></a>            <span class="at">pct_90 =</span> \(x) <span class="fu">quantile</span>(x, <span class="fl">0.9</span>))))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["genre"],"name":[1],"type":["chr"],"align":["left"]},{"label":["danceability_avg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["danceability_std.dev"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["danceability_median"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["danceability_pct_10"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["danceability_pct_90"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["energy_avg"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["energy_std.dev"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["energy_median"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["energy_pct_10"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["energy_pct_90"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["speechiness_avg"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["speechiness_std.dev"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["speechiness_median"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["speechiness_pct_10"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["speechiness_pct_90"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["instrumentalness_avg"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["instrumentalness_std.dev"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["instrumentalness_median"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["instrumentalness_pct_10"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["instrumentalness_pct_90"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["liveness_avg"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["liveness_std.dev"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["liveness_median"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["liveness_pct_10"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["liveness_pct_90"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["valence_avg"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["valence_std.dev"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["valence_median"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["valence_pct_10"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["valence_pct_90"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["tempo_avg"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["tempo_std.dev"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["tempo_median"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["tempo_pct_10"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["tempo_pct_90"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["song_length_avg"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["song_length_std.dev"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["song_length_median"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["song_length_pct_10"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["song_length_pct_90"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["song_age_avg"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["song_age_std.dev"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["song_age_median"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["song_age_pct_10"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["song_age_pct_90"],"name":[46],"type":["dbl"],"align":["right"]},{"label":["explicit_avg"],"name":[47],"type":["dbl"],"align":["right"]},{"label":["explicit_std.dev"],"name":[48],"type":["dbl"],"align":["right"]},{"label":["explicit_median"],"name":[49],"type":["dbl"],"align":["right"]},{"label":["explicit_pct_10"],"name":[50],"type":["dbl"],"align":["right"]},{"label":["explicit_pct_90"],"name":[51],"type":["dbl"],"align":["right"]}],"data":[{"1":"other","2":"64.52704","3":"15.390890","4":"67.0","5":"42.90","6":"82.40","7":"63.90804","8":"20.45958","9":"67.70","10":"33.10","11":"87.60","12":"9.304199","13":"10.379459","14":"5.585","15":"3.100","16":"20.100","17":"0.7217099","18":"6.321211","19":"0.000000","20":"0","21":"0.050000","22":"21.91372","23":"20.269202","24":"13.30","25":"7.287","26":"45.10","27":"60.15862","28":"22.73370","29":"62.15","30":"27.50","31":"89.83","32":"123.6489","33":"31.97948","34":"120.0090","35":"87.5033","36":"172.0260","37":"3.428663","38":"0.9649817","39":"3.347550","40":"2.500895","41":"4.458583","42":"395.4522","43":"651.77910","44":"142.42857","45":"28.28571","46":"1237.7143","47":"0.07785004","48":"0.2679611","49":"0","50":"0","51":"0"},{"1":"Pop","2":"63.73658","3":"14.455431","4":"65.1","5":"44.10","6":"81.50","7":"62.91020","8":"18.62437","9":"65.00","10":"36.90","11":"86.00","12":"9.848424","13":"10.197396","14":"5.370","15":"3.020","16":"25.000","17":"1.1608197","18":"7.761208","19":"0.000000","20":"0","21":"0.160000","22":"17.26369","23":"13.163811","24":"12.20","25":"7.360","26":"33.90","27":"50.32584","28":"22.57102","29":"49.20","30":"20.60","31":"82.10","32":"120.9394","33":"28.44137","34":"119.9860","35":"86.0718","36":"160.1132","37":"3.524695","38":"0.8421095","39":"3.430200","40":"2.659957","41":"4.514137","42":"238.3576","43":"374.53971","44":"143.28571","45":"28.28571","46":"533.1429","47":"0.15527620","48":"0.3621738","49":"0","50":"0","51":"1"},{"1":"HipHop/Rap","2":"73.04785","3":"12.304102","4":"74.8","5":"55.50","6":"87.70","7":"65.09905","8":"13.27987","9":"65.70","10":"48.10","11":"82.10","12":"20.920469","13":"13.551478","14":"19.000","15":"5.310","16":"39.100","17":"0.6114178","18":"5.031168","19":"0.000000","20":"0","21":"0.060000","22":"16.89957","23":"12.485381","24":"12.10","25":"7.840","26":"33.30","27":"49.03505","28":"20.72870","29":"49.00","30":"21.10","31":"77.20","32":"121.6765","33":"28.21902","34":"121.9980","35":"85.6640","36":"159.8800","37":"3.215201","38":"0.8119683","39":"3.144667","40":"2.417933","41":"4.065967","42":"109.2966","43":"96.82665","44":"96.28571","45":"21.57143","46":"195.2857","47":"0.05153566","48":"0.2210928","49":"0","50":"0","51":"0"},{"1":"Rock","2":"54.75486","3":"13.975973","4":"55.0","5":"36.43","6":"72.30","7":"67.76872","8":"21.36872","9":"70.85","10":"36.93","11":"93.50","12":"6.186818","13":"5.224305","14":"4.320","15":"2.900","16":"11.400","17":"5.6923038","18":"17.465641","19":"0.000948","20":"0","21":"13.800000","22":"18.64689","23":"14.519118","24":"12.50","25":"7.490","26":"36.30","27":"45.64841","28":"22.53212","29":"44.00","30":"16.33","31":"77.00","32":"122.2531","33":"28.70089","34":"120.0240","35":"86.0453","36":"164.0598","37":"3.846571","38":"0.9930482","39":"3.723783","40":"2.854098","41":"4.954112","42":"356.1687","43":"531.81309","44":"160.28571","45":"36.88571","46":"1085.4286","47":"0.17180826","48":"0.3772585","49":"0","50":"0","51":"1"},{"1":"R&B","2":"67.96766","3":"13.432997","4":"70.1","5":"48.90","6":"83.10","7":"61.25491","8":"15.79594","9":"62.30","10":"40.50","11":"81.20","12":"12.337241","13":"10.098873","14":"8.380","15":"3.670","16":"27.200","17":"0.9564108","18":"6.863960","19":"0.000000","20":"0","21":"0.210000","22":"16.03997","23":"11.622330","24":"11.60","25":"7.400","26":"32.00","27":"52.83072","28":"23.01094","29":"54.10","30":"20.70","31":"83.40","32":"120.1679","33":"32.02157","34":"111.0040","35":"84.9870","36":"172.0370","37":"3.463912","38":"0.7241622","39":"3.426667","40":"2.640000","41":"4.334617","42":"229.7397","43":"460.38072","44":"109.71429","45":"31.28571","46":"318.1429","47":"0.07761829","48":"0.2676411","49":"0","50":"0","51":"0"},{"1":"Electro/Dance","2":"66.55213","3":"11.872900","4":"67.4","5":"50.90","6":"80.70","7":"74.50546","8":"13.98508","9":"76.20","10":"56.00","11":"90.78","12":"7.818187","13":"6.331865","14":"5.380","15":"3.350","16":"15.780","17":"5.0453373","18":"16.745219","19":"0.000379","20":"0","21":"9.774000","22":"18.57029","23":"14.118595","24":"13.00","25":"7.122","26":"35.80","27":"47.49889","28":"21.48897","29":"47.80","30":"18.90","31":"77.00","32":"120.7373","33":"19.41664","34":"121.9960","35":"97.9774","36":"144.0156","37":"3.361686","38":"0.7369606","39":"3.247333","40":"2.669757","41":"4.088967","42":"187.7736","43":"194.72333","44":"157.28571","45":"42.62857","46":"285.5714","47":"0.33999260","48":"0.4737939","49":"0","50":"0","51":"1"},{"1":"German Folk","2":"63.03265","3":"15.356337","4":"65.2","5":"41.44","6":"81.50","7":"61.72835","8":"22.55591","9":"66.60","10":"28.00","11":"88.54","12":"9.797514","13":"10.198743","14":"4.910","15":"2.958","16":"27.420","17":"1.7509195","18":"10.019071","19":"0.000000","20":"0","21":"0.782000","22":"18.64599","23":"15.381588","24":"12.30","25":"7.580","26":"35.42","27":"56.06759","28":"24.07133","29":"58.30","30":"22.00","31":"87.70","32":"119.3801","33":"28.53437","34":"118.0580","35":"86.1198","36":"159.8366","37":"3.646470","38":"0.9724464","39":"3.628000","40":"2.616707","41":"4.905423","42":"436.3941","43":"552.94134","44":"212.28571","45":"123.28571","46":"1276.3143","47":"0.29870130","48":"0.4581137","49":"0","50":"0","51":"1"},{"1":"Reggae","2":"75.06198","3":"9.332347","4":"76.7","5":"62.80","6":"86.40","7":"67.60661","8":"14.90742","9":"69.60","10":"48.70","11":"88.20","12":"11.956198","13":"8.686172","14":"7.850","15":"4.150","16":"24.400","17":"1.8236761","18":"9.522788","19":"0.000000","20":"0","21":"0.930000","22":"18.02198","23":"14.894363","24":"12.70","25":"6.550","26":"36.80","27":"69.73140","28":"18.37510","29":"73.40","30":"44.90","31":"90.70","32":"111.8039","33":"31.02950","34":"100.0450","35":"81.9860","36":"165.8500","37":"3.498592","38":"0.5732457","39":"3.435617","40":"2.911617","41":"4.241333","42":"343.6765","43":"530.67362","44":"152.28571","45":"16.28571","46":"794.0000","47":"0.09090909","48":"0.2886751","49":"0","50":"0","51":"0"},{"1":"Country","2":"59.67282","3":"11.984577","4":"59.7","5":"44.70","6":"74.47","7":"69.70504","8":"18.70773","9":"75.00","10":"42.13","11":"90.02","12":"5.159821","13":"4.095142","14":"3.775","15":"2.800","16":"8.967","17":"0.2375129","18":"4.044887","19":"0.000000","20":"0","21":"0.000737","22":"23.70347","23":"21.428114","24":"13.95","25":"8.490","26":"53.02","27":"58.90298","28":"21.07777","29":"61.85","30":"29.33","31":"87.18","32":"124.5243","33":"31.19017","34":"125.0975","35":"80.6458","36":"166.9938","37":"3.347030","38":"0.5425821","39":"3.267225","40":"2.726887","41":"3.969117","42":"244.2112","43":"437.55352","44":"109.28571","45":"15.88571","46":"641.9286","47":"0.01984127","48":"0.1395932","49":"0","50":"0","51":"0"},{"1":"Soundtrack","2":"52.81687","3":"16.248094","4":"54.1","5":"28.95","6":"73.30","7":"52.04574","8":"21.95865","9":"50.20","10":"22.50","11":"82.20","12":"6.821503","13":"7.511140","14":"3.990","15":"2.930","16":"15.500","17":"5.0177189","18":"19.372151","19":"0.000000","20":"0","21":"0.900000","22":"17.48736","23":"14.798672","24":"11.85","25":"7.895","26":"32.85","27":"37.98939","28":"22.43526","29":"32.30","30":"13.35","31":"71.00","32":"119.5009","33":"30.79834","34":"118.0340","35":"78.4770","36":"159.2905","37":"3.545621","38":"0.9855004","39":"3.503333","40":"2.387975","41":"4.631550","42":"230.1586","43":"318.20296","44":"147.28571","45":"61.50000","46":"405.6429","47":"0.13190184","48":"0.3389042","49":"0","50":"0","51":"1"},{"1":"Classics/Jazz","2":"45.99988","3":"18.339914","4":"46.6","5":"21.20","6":"69.22","7":"30.85225","8":"19.50915","9":"28.10","10":"8.19","11":"60.78","12":"6.110000","13":"6.549996","14":"3.920","15":"3.029","16":"11.110","17":"11.3441542","18":"25.648211","19":"0.020000","20":"0","21":"38.080000","22":"13.43700","23":"7.628625","24":"10.55","25":"7.515","26":"24.20","27":"38.23663","28":"24.30260","29":"30.95","30":"11.63","31":"74.70","32":"113.2287","33":"33.74192","34":"108.4460","35":"73.1532","36":"147.4277","37":"3.690025","38":"1.2866242","39":"3.457267","40":"2.188422","41":"5.254717","42":"819.6607","43":"780.20855","44":"590.92857","45":"153.38571","46":"1746.7714","47":"0.17500000","48":"0.3823644","49":"0","50":"0","51":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="r-markdown.html#cb710-1" tabindex="-1"></a><span class="fu">ggplot</span>(music_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(<span class="fu">factor</span>(genre),</span>
<span id="cb710-2"><a href="r-markdown.html#cb710-2" tabindex="-1"></a>    energy, median), <span class="at">y =</span> energy)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb710-3"><a href="r-markdown.html#cb710-3" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/question_5_a1-1.png" width="672" /></p>
</div>
<div id="task-6" class="section level3 hasAnchor" number="8.2.7">
<h3><span class="header-section-number">8.2.7</span> Task 6<a href="r-markdown.html#task-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Visualize the number of songs by label.</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="r-markdown.html#cb711-1" tabindex="-1"></a><span class="co"># provide your code here</span></span>
<span id="cb711-2"><a href="r-markdown.html#cb711-2" tabindex="-1"></a>music_data <span class="sc">|&gt;</span></span>
<span id="cb711-3"><a href="r-markdown.html#cb711-3" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">.by =</span> label, <span class="at">n_songs =</span> <span class="fu">n_distinct</span>(isrc)) <span class="sc">|&gt;</span></span>
<span id="cb711-4"><a href="r-markdown.html#cb711-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">fct_reorder</span>(<span class="fu">as.factor</span>(label), n_songs)) <span class="sc">|&gt;</span></span>
<span id="cb711-5"><a href="r-markdown.html#cb711-5" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> label, <span class="at">x =</span> n_songs)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/question_6_a1-1.png" width="672" /></p>
</div>
<div id="task-7" class="section level3 hasAnchor" number="8.2.8">
<h3><span class="header-section-number">8.2.8</span> Task 7<a href="r-markdown.html#task-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Visualize the average monthly artist listeners (<code>monthly_listeners_artist</code>) by genre.</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="r-markdown.html#cb712-1" tabindex="-1"></a><span class="co"># provide your code here</span></span>
<span id="cb712-2"><a href="r-markdown.html#cb712-2" tabindex="-1"></a>music_data <span class="sc">|&gt;</span></span>
<span id="cb712-3"><a href="r-markdown.html#cb712-3" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">.by =</span> genre, <span class="at">avg_m_listeners =</span> <span class="fu">mean</span>(monthly_listeners_artist)) <span class="sc">|&gt;</span></span>
<span id="cb712-4"><a href="r-markdown.html#cb712-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">genre =</span> <span class="fu">fct_reorder</span>(<span class="fu">factor</span>(genre), avg_m_listeners)) <span class="sc">|&gt;</span></span>
<span id="cb712-5"><a href="r-markdown.html#cb712-5" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_m_listeners, <span class="at">y =</span> genre)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb712-6"><a href="r-markdown.html#cb712-6" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Average monthly artist listeners&quot;</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/question_7_a1-1.png" width="672" /></p>
</div>
<div id="task-8" class="section level3 hasAnchor" number="8.2.9">
<h3><span class="header-section-number">8.2.9</span> Task 8<a href="r-markdown.html#task-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a histogram of the variable “valence”.</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="r-markdown.html#cb713-1" tabindex="-1"></a><span class="co"># provide your code here</span></span>
<span id="cb713-2"><a href="r-markdown.html#cb713-2" tabindex="-1"></a><span class="fu">ggplot</span>(music_data, <span class="fu">aes</span>(<span class="at">x =</span> valence)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="14-rmdIntro_files/figure-html/question_8_a1-1.png" width="672" /></p>
</div>
<div id="task-9" class="section level3 hasAnchor" number="8.2.10">
<h3><span class="header-section-number">8.2.10</span> Task 9<a href="r-markdown.html#task-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a scatter plot showing <code>youtube_views</code> and <code>shazam_counts</code> (Bonus: add a linear regression line). Interpret the plot briefly.</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="r-markdown.html#cb715-1" tabindex="-1"></a><span class="co"># provide your code here</span></span>
<span id="cb715-2"><a href="r-markdown.html#cb715-2" tabindex="-1"></a><span class="fu">ggplot</span>(music_data, <span class="fu">aes</span>(<span class="at">x =</span> youtube_views, <span class="at">y =</span> shazam_counts)) <span class="sc">+</span></span>
<span id="cb715-3"><a href="r-markdown.html#cb715-3" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="14-rmdIntro_files/figure-html/question_9_a1-1.png" width="672" /></p>
<p>On average Youtube views and Shazam counts show a positive coefficient in the linear regression. However, the relationship does not appear to be linear.</p>
</div>
</div>
<div id="assignment-2" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Assignment 2<a href="r-markdown.html#assignment-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This assignment consists of four parts. When answering the questions, please remember to address the following points, where appropriate:</p>
<ul>
<li>Formulate the corresponding hypotheses and choose an appropriate statistical test</li>
<li>Provide the reason for your choice and discuss if the assumptions of the test are met</li>
<li>Convert the variables to the appropriate type (e.g., factor variables)</li>
<li>Create appropriate graphs to explore the data (e.g., plot of means incl. confidence intervals, histogram, boxplot)</li>
<li>Provide appropriate descriptive statistics for the variables (e.g., mean, median, standard deviation, etc.)</li>
<li>Report and interpret the test results accurately (including confidence intervals)<br />
</li>
<li>Finally, don’t forget to report your research conclusion</li>
</ul>
<p>When you are done with your analysis, click on “Knit to HTML” button above the code editor. This will create a HTML document of your results in the folder where the “assignment2.Rmd” file is stored. Open this file in your Internet browser to see if the output is correct. If the output is correct, submit the HTML file via Learn@WU. The file name should be “assignment2_studendID_lastname.html”.</p>
<div id="assignment-2a" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Assignment 2a<a href="r-markdown.html#assignment-2a" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As a mobile app product manager, you are looking for ways to improve user engagement and in-app purchases. Your team has launched an A/B test to analyze the effect of a new user interface (UI) feature. You have data that contains information about user behavior within your app.</p>
<p>The data file contains the following variables:</p>
<ul>
<li><strong>userID:</strong> Unique user ID.</li>
<li><strong>exp_group:</strong> Experimental group (indicator variable w/ 2 levels: 0 = control, 1 = treatment).</li>
<li><strong>in_app_purchases:</strong> Total amount spent by a user in the app in the past month (in USD).</li>
<li><strong>time_in_app:</strong> Average time a user spends in your app per session (in minutes).</li>
</ul>
<p>Use R and appropriate methods to answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>The finance department asks you to provide an estimate of the average amount spent by users through in-app purchases. Compute the 95% confidence interval for the mean amount spent and provide an interpretation of the interval.</li>
<li>You run an A/B test to analyze the effect of a new UI feature on in-app purchases and time spent in the app. The information regarding which group a user has been assigned to is stored in the variable “exp_group”. Is there a significant difference regarding in-app purchases and time spent between users from the control and treatment groups? Please include the effect size (Cohen’s d) and confidence intervals in your report.</li>
<li>Assume that you plan to run an experiment to test two different notification strategies. You randomly assign app users to the control and experimental conditions. How many users would you need to include in each group if you assume the effect size to be 0.1 for a significance level of 0.05 and power of 0.8?</li>
</ol>
</div>
<div id="data-analysis" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Data analysis<a href="r-markdown.html#data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="load-data" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Load data<a href="r-markdown.html#load-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="r-markdown.html#cb717-1" tabindex="-1"></a>app_user_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/WU-RDS/MA2024/main/user_data_q1.csv&quot;</span>,</span>
<span id="cb717-2"><a href="r-markdown.html#cb717-2" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)  <span class="co">#read in data</span></span>
<span id="cb717-3"><a href="r-markdown.html#cb717-3" tabindex="-1"></a><span class="fu">head</span>(app_user_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["userID"],"name":[1],"type":["int"],"align":["right"]},{"label":["exp_group"],"name":[2],"type":["int"],"align":["right"]},{"label":["in_app_purchases"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["time_in_app"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0","3":"7.20","4":"18.55488"},{"1":"2","2":"0","3":"8.85","4":"23.28257"},{"1":"3","2":"0","3":"17.79","4":"17.73001"},{"1":"4","2":"0","3":"10.35","4":"17.03068"},{"1":"5","2":"0","3":"10.65","4":"11.44810"},{"1":"6","2":"0","3":"18.58","4":"18.95276"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="r-markdown.html#cb718-1" tabindex="-1"></a><span class="fu">str</span>(app_user_data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1600 obs. of  4 variables:
##  $ userID          : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ exp_group       : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ in_app_purchases: num  7.2 8.85 17.79 10.35 10.65 ...
##  $ time_in_app     : num  18.6 23.3 17.7 17 11.4 ...</code></pre>
</div>
<div id="question-1" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Question 1<a href="r-markdown.html#question-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we take a look at the statistics for the amount spent for in app purchases our customers make and at the graph with the distribution of purchases made in app per customer.</p>
<p>To compute the confidence interval for the average customer, we will need the mean, the standard error and the critical value for a t-distribution (because we don’t know exactly the variance in the population).</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="r-markdown.html#cb720-1" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(ggplot2))</span>
<span id="cb720-2"><a href="r-markdown.html#cb720-2" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(psych))</span>
<span id="cb720-3"><a href="r-markdown.html#cb720-3" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(dplyr))</span>
<span id="cb720-4"><a href="r-markdown.html#cb720-4" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(ggstatsplot))</span></code></pre></div>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="r-markdown.html#cb721-1" tabindex="-1"></a><span class="co"># First let&#39;s have a look at the purchases in the</span></span>
<span id="cb721-2"><a href="r-markdown.html#cb721-2" tabindex="-1"></a><span class="co"># app in the data</span></span>
<span id="cb721-3"><a href="r-markdown.html#cb721-3" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(app_user_data<span class="sc">$</span>in_app_purchases)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["vars"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["trimmed"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mad"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["min"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["range"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["skew"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["kurtosis"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["se"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1600","3":"11.11889","4":"4.996944","5":"11.18","6":"11.08962","7":"4.922232","8":"0","9":"28.95","10":"28.95","11":"0.102741","12":"-0.1035079","13":"0.1249236"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="r-markdown.html#cb722-1" tabindex="-1"></a><span class="fu">ggplot</span>(app_user_data, <span class="fu">aes</span>(in_app_purchases)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">col =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb722-2"><a href="r-markdown.html#cb722-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>, <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">data =</span> app_user_data <span class="sc">%&gt;%</span></span>
<span id="cb722-3"><a href="r-markdown.html#cb722-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(in_app_purchases)),</span>
<span id="cb722-4"><a href="r-markdown.html#cb722-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xintercept =</span> mean), <span class="at">linewidth =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;gray19&quot;</span>) <span class="sc">+</span></span>
<span id="cb722-5"><a href="r-markdown.html#cb722-5" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Purchases&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Distribution of purchases per customer&quot;</span>) <span class="sc">+</span></span>
<span id="cb722-6"><a href="r-markdown.html#cb722-6" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/question_1_1-1.png" width="672" /></p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="r-markdown.html#cb723-1" tabindex="-1"></a><span class="co"># Compute mean, standard error, and confidence</span></span>
<span id="cb723-2"><a href="r-markdown.html#cb723-2" tabindex="-1"></a><span class="co"># interval for in-app purchases</span></span>
<span id="cb723-3"><a href="r-markdown.html#cb723-3" tabindex="-1"></a>mean_purchases <span class="ot">&lt;-</span> <span class="fu">mean</span>(app_user_data<span class="sc">$</span>in_app_purchases)</span>
<span id="cb723-4"><a href="r-markdown.html#cb723-4" tabindex="-1"></a>sd_purchases <span class="ot">&lt;-</span> <span class="fu">sd</span>(app_user_data<span class="sc">$</span>in_app_purchases)</span>
<span id="cb723-5"><a href="r-markdown.html#cb723-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(app_user_data)</span>
<span id="cb723-6"><a href="r-markdown.html#cb723-6" tabindex="-1"></a>se_purchases <span class="ot">&lt;-</span> sd_purchases<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb723-7"><a href="r-markdown.html#cb723-7" tabindex="-1"></a>df <span class="ot">&lt;-</span> n <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb723-8"><a href="r-markdown.html#cb723-8" tabindex="-1"></a>t_crit <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, df)</span>
<span id="cb723-9"><a href="r-markdown.html#cb723-9" tabindex="-1"></a></span>
<span id="cb723-10"><a href="r-markdown.html#cb723-10" tabindex="-1"></a><span class="co"># Confidence Interval</span></span>
<span id="cb723-11"><a href="r-markdown.html#cb723-11" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> mean_purchases <span class="sc">-</span> t_crit <span class="sc">*</span> se_purchases</span>
<span id="cb723-12"><a href="r-markdown.html#cb723-12" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> mean_purchases <span class="sc">+</span> t_crit <span class="sc">*</span> se_purchases</span>
<span id="cb723-13"><a href="r-markdown.html#cb723-13" tabindex="-1"></a></span>
<span id="cb723-14"><a href="r-markdown.html#cb723-14" tabindex="-1"></a><span class="fu">print</span>(ci_lower)</span></code></pre></div>
<pre><code>## [1] 10.87386</code></pre>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="r-markdown.html#cb725-1" tabindex="-1"></a><span class="fu">print</span>(ci_upper)</span></code></pre></div>
<pre><code>## [1] 11.36392</code></pre>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="r-markdown.html#cb727-1" tabindex="-1"></a><span class="co"># Alternatively: get confidence interval from</span></span>
<span id="cb727-2"><a href="r-markdown.html#cb727-2" tabindex="-1"></a><span class="co"># t.test</span></span>
<span id="cb727-3"><a href="r-markdown.html#cb727-3" tabindex="-1"></a><span class="fu">t.test</span>(app_user_data<span class="sc">$</span>in_app_purchases)<span class="sc">$</span>conf.int</span></code></pre></div>
<pre><code>## [1] 10.87386 11.36392
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
<p>The confidence interval for in app purchases is CI = [10.87;11.36]
Interpretation: If we take 100 samples and calculate the mean and confidence interval for each of them, then the true population mean would be included in 95% of these intervals. In the sample we have, this interval spans from 10.87 to 11.36.</p>
</div>
<div id="question-2" class="section level3 hasAnchor" number="8.3.5">
<h3><span class="header-section-number">8.3.5</span> Question 2<a href="r-markdown.html#question-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We need to analyze if a new UI feature has an effect on in app purchases. We need to formulate the null hypothesis as the first step. In our case the null hypothesis is that the new UI feature has no effect on the mean in-app purchases, that there is no difference in the mean in-app purchases between two populations. The alternative hypothesis states that the new UI feature has an effect on the mean in-app purchases, meaning that there is a difference in the mean in-app purchases between the two populations.</p>
<p>We first transform the variable exp_group into a factor and inspect the data with descriptive statistics. It can be already seen that the mean of in app-purchases is higher in the treatment group. Next we visualize the data, for this we can use a boxplot.</p>
<p>To test whether or not this difference is significant, we need to use an independent-means t-test, since we have different customers in each group, meaning that we have collected the data using a between-subjects design (the customers in one condition are independent of the customers in the other condition). The requirements are met:
1) the DV (in-app purchases) is measured on a ratio scale; 2) there are more than 30 observations in each group, so the data is normally distributed according to Central Limit Theorem; 3) the feature was assigned randomly, so the groups are independent; 4) Welch’s t-test corrects for unequal variance.</p>
<p>We also then calculate the effect size (Cohen’s d). Then we can also visualize the results of the test.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="r-markdown.html#cb729-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb729-2"><a href="r-markdown.html#cb729-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb729-3"><a href="r-markdown.html#cb729-3" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb729-4"><a href="r-markdown.html#cb729-4" tabindex="-1"></a><span class="fu">library</span>(lsr)</span>
<span id="cb729-5"><a href="r-markdown.html#cb729-5" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb729-6"><a href="r-markdown.html#cb729-6" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb729-7"><a href="r-markdown.html#cb729-7" tabindex="-1"></a></span>
<span id="cb729-8"><a href="r-markdown.html#cb729-8" tabindex="-1"></a><span class="co">#making IV a factor</span></span>
<span id="cb729-9"><a href="r-markdown.html#cb729-9" tabindex="-1"></a>app_user_data<span class="sc">$</span>exp_group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(app_user_data<span class="sc">$</span>exp_group)</span>
<span id="cb729-10"><a href="r-markdown.html#cb729-10" tabindex="-1"></a></span>
<span id="cb729-11"><a href="r-markdown.html#cb729-11" tabindex="-1"></a><span class="co">#looking at descriptive statistics</span></span>
<span id="cb729-12"><a href="r-markdown.html#cb729-12" tabindex="-1"></a><span class="fu">describeBy</span>(app_user_data<span class="sc">$</span>in_app_purchases, app_user_data<span class="sc">$</span>exp_group) <span class="co">#description of control and treatment groups</span></span></code></pre></div>
<pre><code>## 
##  Descriptive statistics by group 
## group: 0
##    vars   n  mean   sd median trimmed  mad min   max range skew kurtosis   se
## X1    1 800 10.08 4.84  10.05   10.05 4.75   0 26.21 26.21 0.09    -0.22 0.17
## ------------------------------------------------------------ 
## group: 1
##    vars   n  mean   sd median trimmed  mad min   max range skew kurtosis   se
## X1    1 800 12.15 4.94  12.27   12.12 4.98   0 28.95 28.95  0.1    -0.03 0.17</code></pre>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="r-markdown.html#cb731-1" tabindex="-1"></a><span class="co"># Boxplot for In-App Purchases by Experimental Group</span></span>
<span id="cb731-2"><a href="r-markdown.html#cb731-2" tabindex="-1"></a><span class="fu">ggplot</span>(app_user_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(exp_group), <span class="at">y =</span> in_app_purchases, <span class="at">fill =</span> <span class="fu">factor</span>(exp_group))) <span class="sc">+</span></span>
<span id="cb731-3"><a href="r-markdown.html#cb731-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb731-4"><a href="r-markdown.html#cb731-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Boxplot of In-App Purchases by Experimental Group&quot;</span>,</span>
<span id="cb731-5"><a href="r-markdown.html#cb731-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Group (0 = Control, 1 = Treatment)&quot;</span>,</span>
<span id="cb731-6"><a href="r-markdown.html#cb731-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;In-App Purchases (USD)&quot;</span>) <span class="sc">+</span></span>
<span id="cb731-7"><a href="r-markdown.html#cb731-7" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>)) <span class="sc">+</span></span>
<span id="cb731-8"><a href="r-markdown.html#cb731-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/question_2_1-1.png" width="672" /></p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="r-markdown.html#cb732-1" tabindex="-1"></a><span class="co"># t-test for differences in in-app purchases</span></span>
<span id="cb732-2"><a href="r-markdown.html#cb732-2" tabindex="-1"></a>t_test_purchases <span class="ot">&lt;-</span> <span class="fu">t.test</span>(in_app_purchases <span class="sc">~</span> exp_group, <span class="at">data =</span> app_user_data)</span>
<span id="cb732-3"><a href="r-markdown.html#cb732-3" tabindex="-1"></a><span class="fu">print</span>(t_test_purchases)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  in_app_purchases by exp_group
## t = -8.4689, df = 1597.3, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -2.550210 -1.591065
## sample estimates:
## mean in group 0 mean in group 1 
##        10.08357        12.15421</code></pre>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="r-markdown.html#cb734-1" tabindex="-1"></a><span class="co"># Compute Cohen&#39;s d for in app purchases</span></span>
<span id="cb734-2"><a href="r-markdown.html#cb734-2" tabindex="-1"></a>cohen_d_purchases <span class="ot">&lt;-</span> <span class="fu">cohensD</span>(in_app_purchases <span class="sc">~</span> exp_group, <span class="at">data =</span> app_user_data)</span>
<span id="cb734-3"><a href="r-markdown.html#cb734-3" tabindex="-1"></a><span class="fu">print</span>(cohen_d_purchases)</span></code></pre></div>
<pre><code>## [1] 0.4234454</code></pre>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="r-markdown.html#cb736-1" tabindex="-1"></a><span class="co">#Visualization of test results</span></span>
<span id="cb736-2"><a href="r-markdown.html#cb736-2" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(</span>
<span id="cb736-3"><a href="r-markdown.html#cb736-3" tabindex="-1"></a>  <span class="at">data =</span> app_user_data,</span>
<span id="cb736-4"><a href="r-markdown.html#cb736-4" tabindex="-1"></a>  <span class="at">plot.type =</span> <span class="st">&quot;box&quot;</span>,</span>
<span id="cb736-5"><a href="r-markdown.html#cb736-5" tabindex="-1"></a>  <span class="at">x =</span> exp_group, <span class="co">#2 groups</span></span>
<span id="cb736-6"><a href="r-markdown.html#cb736-6" tabindex="-1"></a>  <span class="at">y =</span> in_app_purchases ,</span>
<span id="cb736-7"><a href="r-markdown.html#cb736-7" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="co">#default</span></span>
<span id="cb736-8"><a href="r-markdown.html#cb736-8" tabindex="-1"></a>  <span class="at">effsize.type =</span> <span class="st">&quot;d&quot;</span>, <span class="co">#display effect size (Cohen&#39;s d in output)</span></span>
<span id="cb736-9"><a href="r-markdown.html#cb736-9" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span>,</span>
<span id="cb736-10"><a href="r-markdown.html#cb736-10" tabindex="-1"></a>  <span class="at">bf.message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb736-11"><a href="r-markdown.html#cb736-11" tabindex="-1"></a>  <span class="at">mean.ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb736-12"><a href="r-markdown.html#cb736-12" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Average revenue per customer by group&quot;</span></span>
<span id="cb736-13"><a href="r-markdown.html#cb736-13" tabindex="-1"></a>) </span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/question_2_1-2.png" width="672" /></p>
<p>Interpretations: As we can see from the descriptive statistics and the plot for control and treatment groups, the in-app purchases are higher in the group that was exposed to the new UI feature. The t-test showed significant result because the p-value is smaller than 0,05, meaning that we can reject the null hypothesis that there is no difference in the mean of the in-app purchases. The p-value states that the probability of finding a difference of the observed magnitude or higher, if the null hypothesis was in fact true (if there was in fact no difference between the populations). For us it means that the new UI feature in fact has an effect on the average in-app purchases. Also: Since 0 (the hypothetical difference in means from H0) is not included in the interval, it confirms that we can reject the null hypothesis. The Cohen’s d effect size value of 0.4234 suggests that the effect of the new UI feature is small to medium.</p>
<p>The plot shows us that in app purchases are higher in the treatment group (Mean = 12.15) compared to the control group (Mean = 10.08). This means that, on average, the in app purchases were 2.07 higher in the treatment group, compared to the control group. An independent-means t-test showed that this difference is significant: t(1597) = 8.47, p &lt; .05 (95% CI = [1.59, 2.55]); effect size is small to medium = 0.42.</p>
<p>Now we can look at the influence of the new UI feature on the time spent in app.</p>
<p>First, we need to formulate the null hypothesis. In this case the null hypothesis is that the new UI feature has no effect on the mean time spent in app, that there is no difference in the mean time spent in app between two populations. The alternative hypothesis states that the new UI feature has an effect on the mean time spent in app, meaning that there is a difference in the mean time in app between the two populations.</p>
<p>First, we inspect the data with descriptive statistics. It can be already seen that the mean of in app purchases is slightly higher in the treatment group. Next we visualize the data, for this we can use a boxplot.</p>
<p>We can use the independent means t-test because again the necessary assumptions are met: 1) The dependent variable (time in app) is measured on an ratio scale; 2) We have more than 30 observations per group; 3) The groups are independent.</p>
<p>We also then calculate the effect size (Cohen’s d). Then we can also visualize the results of the test.</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="r-markdown.html#cb737-1" tabindex="-1"></a><span class="fu">describeBy</span>(app_user_data<span class="sc">$</span>time_in_app, app_user_data<span class="sc">$</span>exp_group)</span></code></pre></div>
<pre><code>## 
##  Descriptive statistics by group 
## group: 0
##    vars   n  mean   sd median trimmed  mad  min   max range  skew kurtosis   se
## X1    1 800 19.99 4.98  19.83   20.02 5.03 4.76 36.45 31.69 -0.04    -0.04 0.18
## ------------------------------------------------------------ 
## group: 1
##    vars   n  mean   sd median trimmed  mad  min   max range skew kurtosis   se
## X1    1 800 21.92 5.02   21.7   21.88 4.81 7.41 39.11  31.7  0.1    -0.05 0.18</code></pre>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="r-markdown.html#cb739-1" tabindex="-1"></a><span class="co"># Boxplot for Time Spent in the App</span></span>
<span id="cb739-2"><a href="r-markdown.html#cb739-2" tabindex="-1"></a><span class="fu">ggplot</span>(app_user_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(exp_group), <span class="at">y =</span> time_in_app, <span class="at">fill =</span> <span class="fu">factor</span>(exp_group))) <span class="sc">+</span></span>
<span id="cb739-3"><a href="r-markdown.html#cb739-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb739-4"><a href="r-markdown.html#cb739-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Boxplot of Time Spent in App by Experimental Group&quot;</span>,</span>
<span id="cb739-5"><a href="r-markdown.html#cb739-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Group (0 = Control, 1 = Treatment)&quot;</span>,</span>
<span id="cb739-6"><a href="r-markdown.html#cb739-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Time Spent in App (minutes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb739-7"><a href="r-markdown.html#cb739-7" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>)) <span class="sc">+</span></span>
<span id="cb739-8"><a href="r-markdown.html#cb739-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="r-markdown.html#cb740-1" tabindex="-1"></a><span class="co"># t-test for differences in time spent in app</span></span>
<span id="cb740-2"><a href="r-markdown.html#cb740-2" tabindex="-1"></a>t_test_time_in_app <span class="ot">&lt;-</span> <span class="fu">t.test</span>(time_in_app <span class="sc">~</span> exp_group, <span class="at">data =</span> app_user_data)</span>
<span id="cb740-3"><a href="r-markdown.html#cb740-3" tabindex="-1"></a><span class="fu">print</span>(t_test_time_in_app)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  time_in_app by exp_group
## t = -7.7392, df = 1597.9, p-value = 1.762e-14
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -2.426037 -1.444958
## sample estimates:
## mean in group 0 mean in group 1 
##        19.98501        21.92051</code></pre>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="r-markdown.html#cb742-1" tabindex="-1"></a><span class="co"># Compute Cohen&#39;s d for in app purchases</span></span>
<span id="cb742-2"><a href="r-markdown.html#cb742-2" tabindex="-1"></a>cohen_d_time_in_app <span class="ot">&lt;-</span> <span class="fu">cohensD</span>(time_in_app <span class="sc">~</span> exp_group, <span class="at">data =</span> app_user_data)</span>
<span id="cb742-3"><a href="r-markdown.html#cb742-3" tabindex="-1"></a><span class="fu">print</span>(cohen_d_time_in_app)</span></code></pre></div>
<pre><code>## [1] 0.3869598</code></pre>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="r-markdown.html#cb744-1" tabindex="-1"></a><span class="co">#Visualization of test results</span></span>
<span id="cb744-2"><a href="r-markdown.html#cb744-2" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(</span>
<span id="cb744-3"><a href="r-markdown.html#cb744-3" tabindex="-1"></a>  <span class="at">data =</span> app_user_data,</span>
<span id="cb744-4"><a href="r-markdown.html#cb744-4" tabindex="-1"></a>  <span class="at">plot.type =</span> <span class="st">&quot;box&quot;</span>,</span>
<span id="cb744-5"><a href="r-markdown.html#cb744-5" tabindex="-1"></a>  <span class="at">x =</span> exp_group, <span class="co">#2 groups</span></span>
<span id="cb744-6"><a href="r-markdown.html#cb744-6" tabindex="-1"></a>  <span class="at">y =</span> time_in_app ,</span>
<span id="cb744-7"><a href="r-markdown.html#cb744-7" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="co">#default</span></span>
<span id="cb744-8"><a href="r-markdown.html#cb744-8" tabindex="-1"></a>  <span class="at">effsize.type =</span> <span class="st">&quot;d&quot;</span>, <span class="co">#display effect size (Cohen&#39;s d in output)</span></span>
<span id="cb744-9"><a href="r-markdown.html#cb744-9" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span>,</span>
<span id="cb744-10"><a href="r-markdown.html#cb744-10" tabindex="-1"></a>  <span class="at">bf.message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb744-11"><a href="r-markdown.html#cb744-11" tabindex="-1"></a>  <span class="at">mean.ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb744-12"><a href="r-markdown.html#cb744-12" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Average revenue per customer by group&quot;</span></span>
<span id="cb744-13"><a href="r-markdown.html#cb744-13" tabindex="-1"></a>) </span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<p>Interpretations: From the descriptive statistics and the boxplot, we can already see that the mean time spent in app is higher in the treatment group. However, we need to conduct the test to see if this result is significant. The t-test showed significant result because the p-value is smaller than 0,05, meaning that we can reject the null hypothesis that there is no difference in the mean of time spent in app. The p-value states that the probability of finding a difference of the observed magnitude or higher, if the null hypothesis was in fact true (if there was in fact no difference between the populations). For us it means that the new UI feature in fact has an effect on the average time spent in app. Also: Since 0 (the hypothetical difference in means from H0) is not included in the interval, it confirms that we can reject the null hypothesis. The Cohen’s d effect size value of 0.387 suggests that the effect of the new UI feature is small to medium.</p>
<p>The plot shows us that time spent in app is higher in the treatment group (Mean = 21.92) compared to the control group (Mean = 19.99). This means that, on average, the time spent in app was 1.93 higher in the treatment group, compared to the control group. An independent-means t-test showed that this difference is significant: t(1598) = 7.74, p &lt; .05 (95% CI = [1.45, 2.43]); effect size is small to medium = 0.387.</p>
</div>
<div id="question-3" class="section level3 hasAnchor" number="8.3.6">
<h3><span class="header-section-number">8.3.6</span> Question 3<a href="r-markdown.html#question-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To define the number of users that should be placed in two different conditions, pwr.t.test() function should be used. If the goal of the experiment is to simply detect significant difference between the groups, the sample size definition should be based on two-sided test.</p>
<p>Given the effect size = 0.1, significance level = 0.05, and power = 0.8, sample size for each group will be:</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="r-markdown.html#cb745-1" tabindex="-1"></a><span class="co"># provide your code here (you can use multiple</span></span>
<span id="cb745-2"><a href="r-markdown.html#cb745-2" tabindex="-1"></a><span class="co"># code chunks per question if you like)</span></span>
<span id="cb745-3"><a href="r-markdown.html#cb745-3" tabindex="-1"></a></span>
<span id="cb745-4"><a href="r-markdown.html#cb745-4" tabindex="-1"></a><span class="co"># Power analysis for sample size calculation</span></span>
<span id="cb745-5"><a href="r-markdown.html#cb745-5" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(<span class="at">d =</span> <span class="fl">0.1</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb745-6"><a href="r-markdown.html#cb745-6" tabindex="-1"></a>    <span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>)</span>
<span id="cb745-7"><a href="r-markdown.html#cb745-7" tabindex="-1"></a><span class="fu">print</span>(sample_size)</span></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 1570.733
##               d = 0.1
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
<p>To achieve our desired effect size of 0.1, a significance level of 0.5 and a power of 0.8 we would need to include at least 1571 customers per group in the experiment.</p>
</div>
<div id="assignment-2b" class="section level3 hasAnchor" number="8.3.7">
<h3><span class="header-section-number">8.3.7</span> Assignment 2b<a href="r-markdown.html#assignment-2b" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After conducting the experiment described above, you would like to find out whether push notifications can further improve user engagement with your mobile app. You expose a set of users, who were already exposed to the new UI feature, to push notifications and record the time they spend in the app before and after implementing the notifications.</p>
<p>You obtain a new data set with the following variables:</p>
<ul>
<li><strong>userID:</strong> Unique user ID.</li>
<li><strong>time_in_app_1:</strong> Average time (in minutes) a user spends in your app per session before receiving push notifications.</li>
<li><strong>time_in_app_2:</strong> Average time (in minutes) a user spends in your app per session after receiving push notifications.</li>
</ul>
<p>Use R and appropriate methods to answer the following question:</p>
<ol start="4" style="list-style-type: decimal">
<li>Did the push notifications lead to a significant increase in the time that users spend in the app compared to before the notifications were implemented ? Conduct an appropriate statistical test to determine if the difference is statistically significant. Please include the effect size (Cohen’s d) and the confidence intervals in your report.</li>
</ol>
</div>
<div id="data-analysis-1" class="section level3 hasAnchor" number="8.3.8">
<h3><span class="header-section-number">8.3.8</span> Data analysis<a href="r-markdown.html#data-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="load-data-1" class="section level3 hasAnchor" number="8.3.9">
<h3><span class="header-section-number">8.3.9</span> Load data<a href="r-markdown.html#load-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="r-markdown.html#cb747-1" tabindex="-1"></a>app_user_data_time <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/WU-RDS/MA2024/main/user_data_q2.csv&quot;</span>,</span>
<span id="cb747-2"><a href="r-markdown.html#cb747-2" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)  <span class="co">#read in data</span></span>
<span id="cb747-3"><a href="r-markdown.html#cb747-3" tabindex="-1"></a><span class="fu">head</span>(app_user_data_time)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["userID"],"name":[1],"type":["int"],"align":["right"]},{"label":["time_in_app_1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["time_in_app_2"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"21.20","3":"29.96"},{"1":"2","2":"38.42","3":"26.40"},{"1":"3","2":"22.71","3":"27.37"},{"1":"4","2":"25.32","3":"30.71"},{"1":"5","2":"28.25","3":"30.77"},{"1":"6","2":"24.87","3":"25.69"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="r-markdown.html#cb748-1" tabindex="-1"></a><span class="fu">str</span>(app_user_data_time)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    417 obs. of  3 variables:
##  $ userID       : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ time_in_app_1: num  21.2 38.4 22.7 25.3 28.2 ...
##  $ time_in_app_2: num  30 26.4 27.4 30.7 30.8 ...</code></pre>
</div>
<div id="question-4" class="section level3 hasAnchor" number="8.3.10">
<h3><span class="header-section-number">8.3.10</span> Question 4<a href="r-markdown.html#question-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We want to examine if push notifications have an effect on average time a user spends in the app. The null hypothesis here is that there is no difference in the mean time spent in the app for the same customers between the presence and absence of push notifications. Because the observations come from the same population of customers (a within-subject design), we refer to the difference in the means for the same population when stating our hypotheses. The alternative hypothesis states that there is a difference between the time in app for the same customers.</p>
<p>We start our analysis with looking at the descriptive statistics and at the plot. Then we conduct a dependent means t-test to see if the difference is significant.</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="r-markdown.html#cb750-1" tabindex="-1"></a><span class="co"># provide your code here (you can use multiple</span></span>
<span id="cb750-2"><a href="r-markdown.html#cb750-2" tabindex="-1"></a><span class="co"># code chunks per question if you like)</span></span>
<span id="cb750-3"><a href="r-markdown.html#cb750-3" tabindex="-1"></a></span>
<span id="cb750-4"><a href="r-markdown.html#cb750-4" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(Rmisc))</span>
<span id="cb750-5"><a href="r-markdown.html#cb750-5" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb750-6"><a href="r-markdown.html#cb750-6" tabindex="-1"></a></span>
<span id="cb750-7"><a href="r-markdown.html#cb750-7" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb750-8"><a href="r-markdown.html#cb750-8" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(app_user_data_time[<span class="sc">!</span><span class="fu">is.na</span>(app_user_data_time<span class="sc">$</span>time_in_app_2),</span>
<span id="cb750-9"><a href="r-markdown.html#cb750-9" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;time_in_app_1&quot;</span>, <span class="st">&quot;time_in_app_2&quot;</span>)])</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["vars"],"name":[1],"type":["int"],"align":["right"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["trimmed"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mad"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["min"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["range"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["skew"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["kurtosis"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["se"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"417","3":"25.20940","4":"5.125614","5":"25.27","6":"25.07236","7":"5.174274","8":"12.25","9":"40.92","10":"28.67","11":"0.24933971","12":"-0.06751811","13":"0.2510024"},{"1":"2","2":"417","3":"27.23995","4":"4.893298","5":"27.33","6":"27.32639","7":"4.892580","8":"13.52","9":"43.95","10":"30.43","11":"-0.06761595","12":"0.01387987","13":"0.2396258"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="r-markdown.html#cb751-1" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb751-2"><a href="r-markdown.html#cb751-2" tabindex="-1"></a></span>
<span id="cb751-3"><a href="r-markdown.html#cb751-3" tabindex="-1"></a>time_data <span class="ot">&lt;-</span> app_user_data_time <span class="sc">|&gt;</span></span>
<span id="cb751-4"><a href="r-markdown.html#cb751-4" tabindex="-1"></a>    <span class="fu">drop_na</span>(time_in_app_2) <span class="sc">|&gt;</span></span>
<span id="cb751-5"><a href="r-markdown.html#cb751-5" tabindex="-1"></a>    <span class="fu">select</span>(time_in_app_1, time_in_app_2) <span class="sc">|&gt;</span></span>
<span id="cb751-6"><a href="r-markdown.html#cb751-6" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(time_in_app_1, time_in_app_2),</span>
<span id="cb751-7"><a href="r-markdown.html#cb751-7" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">&quot;push_notifications&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;time_in_app&quot;</span>)</span>
<span id="cb751-8"><a href="r-markdown.html#cb751-8" tabindex="-1"></a></span>
<span id="cb751-9"><a href="r-markdown.html#cb751-9" tabindex="-1"></a><span class="fu">ggplot</span>(time_data, <span class="fu">aes</span>(<span class="at">x =</span> push_notifications, <span class="at">y =</span> time_in_app)) <span class="sc">+</span></span>
<span id="cb751-10"><a href="r-markdown.html#cb751-10" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush4&quot;</span>) <span class="sc">+</span></span>
<span id="cb751-11"><a href="r-markdown.html#cb751-11" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Time spent in app&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Boxplot of time in app by group&quot;</span>) <span class="sc">+</span></span>
<span id="cb751-12"><a href="r-markdown.html#cb751-12" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_4_1-1.png" width="672" /></p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="r-markdown.html#cb752-1" tabindex="-1"></a><span class="co"># Paired t-test for time spent in app before and</span></span>
<span id="cb752-2"><a href="r-markdown.html#cb752-2" tabindex="-1"></a><span class="co"># after push notifications</span></span>
<span id="cb752-3"><a href="r-markdown.html#cb752-3" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(app_user_data_time<span class="sc">$</span>time_in_app_2,</span>
<span id="cb752-4"><a href="r-markdown.html#cb752-4" tabindex="-1"></a>    app_user_data_time<span class="sc">$</span>time_in_app_1, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb752-5"><a href="r-markdown.html#cb752-5" tabindex="-1"></a><span class="fu">print</span>(t_test_result)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  app_user_data_time$time_in_app_2 and app_user_data_time$time_in_app_1
## t = 5.8341, df = 416, p-value = 1.088e-08
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  1.346398 2.714706
## sample estimates:
## mean difference 
##        2.030552</code></pre>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="r-markdown.html#cb754-1" tabindex="-1"></a><span class="co"># Compute Cohen&#39;s d for paired samples</span></span>
<span id="cb754-2"><a href="r-markdown.html#cb754-2" tabindex="-1"></a>cohen_d_result <span class="ot">&lt;-</span> <span class="fu">cohensD</span>(app_user_data_time<span class="sc">$</span>time_in_app_2,</span>
<span id="cb754-3"><a href="r-markdown.html#cb754-3" tabindex="-1"></a>    app_user_data_time<span class="sc">$</span>time_in_app_1, <span class="at">method =</span> <span class="st">&quot;paired&quot;</span>)</span>
<span id="cb754-4"><a href="r-markdown.html#cb754-4" tabindex="-1"></a><span class="fu">print</span>(cohen_d_result)</span></code></pre></div>
<pre><code>## [1] 0.2856969</code></pre>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="r-markdown.html#cb756-1" tabindex="-1"></a><span class="co"># Visualization of the test</span></span>
<span id="cb756-2"><a href="r-markdown.html#cb756-2" tabindex="-1"></a><span class="fu">ggwithinstats</span>(<span class="at">data =</span> time_data, <span class="at">x =</span> push_notifications,</span>
<span id="cb756-3"><a href="r-markdown.html#cb756-3" tabindex="-1"></a>    <span class="at">y =</span> time_in_app, <span class="at">path.point =</span> <span class="cn">FALSE</span>, <span class="at">path.mean =</span> <span class="cn">TRUE</span>,</span>
<span id="cb756-4"><a href="r-markdown.html#cb756-4" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Time on site with or without push notifications&quot;</span>,</span>
<span id="cb756-5"><a href="r-markdown.html#cb756-5" tabindex="-1"></a>    <span class="at">messages =</span> <span class="cn">FALSE</span>, <span class="at">bf.message =</span> <span class="cn">FALSE</span>, <span class="at">mean.ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb756-6"><a href="r-markdown.html#cb756-6" tabindex="-1"></a>    <span class="at">effsize.type =</span> <span class="st">&quot;d&quot;</span>  <span class="co"># display effect size (Cohen&#39;s d in output)</span></span>
<span id="cb756-7"><a href="r-markdown.html#cb756-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_4_1-2.png" width="672" /></p>
<p>Interpretation: It appears that there is a difference in the means from the descriptive statistics and the plots. To test whether it is significant, we need to run a t-test. This time we need a different version of the t-test because the same customers are observed for the app with and without push notifications (the same customers are shown both versions of the app). This means that we need a dependent means t-test, or paired samples t-test. The other assumptions are identical to the independent-means t-test.</p>
<p>The p-value is lower than the significance level of 5% (p &lt; .05), which means that we can reject the null hypothesis that there is no difference in the mean time in app between absence and presence of push notifications. The confidence interval confirms the conclusion to reject the null hypothesis since 0 is not contained in the range of plausible values.</p>
<p>The Cohen’s d effect size of 0.2857 shows us that the effect is rather small.</p>
<p>The results of the experiment show that, on average, the same users used the app on average 2.03 minutes longer when it included the push notifications (Mean = 27.24) compared to the app without the push notifications (Mean = 25.21). This difference was significant: t(416) = 5.83, p &lt; .05 (95% CI = [1.35, 2.72]); effect size is small = 0.29.</p>
<p>This means that it makes sense to include push notifications to the app as standard practice.</p>
</div>
<div id="assignment-2c" class="section level3 hasAnchor" number="8.3.11">
<h3><span class="header-section-number">8.3.11</span> Assignment 2c<a href="r-markdown.html#assignment-2c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As a marketing analyst for an online retailer, you’re tasked with evaluating how different levels of GDPR-compliant behavioral targeting affect purchase behavior. Given the restrictions imposed by GDPR on using personal data, the retailer conducts an experiment with three levels of targeting:</p>
<ol style="list-style-type: decimal">
<li>No targeting: Users receive no targeted ads (default ad experience).</li>
<li>Segment-based targeting: Ads are tailored using aggregate-level data (e.g., based on product categories users browse, not their personal data).</li>
<li>Individual personalized behavioral targeting: Ads are personalized based on the specific behavior of individual users (using compliant first-party data).</li>
</ol>
<p>You obtain a data set with the following variables:</p>
<ul>
<li><strong>customerID:</strong> Unique customer ID.</li>
<li><strong>revenue:</strong> Total revenue generated by the customer during the experiment (in USD).</li>
<li><strong>satisfaction:</strong> Customer satisfaction score from a post-purchase survey (measured in 11 categories from 0 [very dissatisfied] to 10 [very satisfied]).</li>
<li><strong>targeting:</strong> Type of targeting the customer was exposed to (1 = no targeting, 2 = segment-based targeting, 3 = personalized behavioral targeting).</li>
</ul>
<p>Use R and appropriate methods to answer the following question:</p>
<ol start="5" style="list-style-type: decimal">
<li>Are there significant differences in revenue between the three targeting strategies?</li>
<li>Did the targeting strategy significantly influence customer satisfaction?</li>
</ol>
</div>
<div id="data-analysis-2" class="section level3 hasAnchor" number="8.3.12">
<h3><span class="header-section-number">8.3.12</span> Data analysis<a href="r-markdown.html#data-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="load-data-2" class="section level3 hasAnchor" number="8.3.13">
<h3><span class="header-section-number">8.3.13</span> Load data<a href="r-markdown.html#load-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="r-markdown.html#cb757-1" tabindex="-1"></a>targeting_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/WU-RDS/MA2024/main/user_targeting_data.csv&quot;</span>,</span>
<span id="cb757-2"><a href="r-markdown.html#cb757-2" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)  <span class="co">#read in data</span></span>
<span id="cb757-3"><a href="r-markdown.html#cb757-3" tabindex="-1"></a><span class="fu">head</span>(targeting_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["customerID"],"name":[1],"type":["int"],"align":["right"]},{"label":["targeting"],"name":[2],"type":["chr"],"align":["left"]},{"label":["revenue"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["satisfaction"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"Personalized Targeting","3":"217.03","4":"6"},{"1":"2","2":"Personalized Targeting","3":"181.27","4":"7"},{"1":"3","2":"Personalized Targeting","3":"182.09","4":"1"},{"1":"4","2":"Segment-Based Targeting","3":"180.97","4":"10"},{"1":"5","2":"Personalized Targeting","3":"142.71","4":"5"},{"1":"6","2":"Segment-Based Targeting","3":"115.86","4":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="r-markdown.html#cb758-1" tabindex="-1"></a><span class="fu">str</span>(targeting_data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    300 obs. of  4 variables:
##  $ customerID  : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ targeting   : chr  &quot;Personalized Targeting&quot; &quot;Personalized Targeting&quot; &quot;Personalized Targeting&quot; &quot;Segment-Based Targeting&quot; ...
##  $ revenue     : num  217 181 182 181 143 ...
##  $ satisfaction: int  6 7 1 10 5 0 10 9 5 4 ...</code></pre>
</div>
<div id="question-5" class="section level3 hasAnchor" number="8.3.14">
<h3><span class="header-section-number">8.3.14</span> Question 5<a href="r-markdown.html#question-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To answer the question of whether the type of targeting has an effect on revenue, we need to formulate the null hypothesis first. In this case, the null hypothesis is that the average level of sales is equal for all three targeting types. The alternative hypothesis states that mean revenue is not equal among three targeting types.</p>
<p>The appropriate test for such a hypothesis is one-way ANOVA since we have a metric-scaled dependent variable and a categorical independent variable with more than two levels. First, we need to recode the independent variable into factor. Next we take a look at descriptive statistics for the data and create appropriate plots.</p>
<p>Before we move to the formal test, we need to see if a series of assumptions are met, namely: 1) Independence of observations; 2) Distributional assumptions; 3) Homogeneity of variances.</p>
<p>Due to the fact that there are more than 30 observations in each group we can rely on the Central Limit Theorem to satisfy the distributional assumptions. We can still test this assumption using Shapiro-Wilk normality test and Q-Q plots. Homogeneity of variances can be checked with Levene’s test.</p>
<p>After checking that the assumptions are met, we can proceed with ANOVA and show also the plot for the test. Next we will briefly inspect the residuals of the ANOVA to see if the assumptions of the test really are justified.</p>
<p>The ANOVA result only tells us that the means of the three groups are not equal, but it does not tell us anything about which pairs of means are unequal. To find this out we need to conduct a post-hoc test.</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="r-markdown.html#cb760-1" tabindex="-1"></a><span class="co"># provide your code here (you can use multiple code chunks per question if you like)</span></span>
<span id="cb760-2"><a href="r-markdown.html#cb760-2" tabindex="-1"></a></span>
<span id="cb760-3"><a href="r-markdown.html#cb760-3" tabindex="-1"></a></span>
<span id="cb760-4"><a href="r-markdown.html#cb760-4" tabindex="-1"></a>targeting_data<span class="sc">$</span>targeting <span class="ot">&lt;-</span> <span class="fu">factor</span>(targeting_data<span class="sc">$</span>targeting, </span>
<span id="cb760-5"><a href="r-markdown.html#cb760-5" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Personalized Targeting&quot;</span>, </span>
<span id="cb760-6"><a href="r-markdown.html#cb760-6" tabindex="-1"></a>                                              <span class="st">&quot;Segment-Based Targeting&quot;</span>, </span>
<span id="cb760-7"><a href="r-markdown.html#cb760-7" tabindex="-1"></a>                                              <span class="st">&quot;No Targeting&quot;</span>))</span>
<span id="cb760-8"><a href="r-markdown.html#cb760-8" tabindex="-1"></a></span>
<span id="cb760-9"><a href="r-markdown.html#cb760-9" tabindex="-1"></a><span class="co">#Descriptive statistics</span></span>
<span id="cb760-10"><a href="r-markdown.html#cb760-10" tabindex="-1"></a><span class="fu">describeBy</span>(targeting_data<span class="sc">$</span>revenue, targeting_data<span class="sc">$</span>targeting)</span></code></pre></div>
<pre><code>## 
##  Descriptive statistics by group 
## group: Personalized Targeting
##    vars  n   mean    sd median trimmed   mad   min    max  range  skew kurtosis
## X1    1 90 158.33 27.45 159.56  159.58 28.32 79.61 217.03 137.42 -0.38    -0.33
##      se
## X1 2.89
## ------------------------------------------------------------ 
## group: Segment-Based Targeting
##    vars  n   mean    sd median trimmed   mad   min    max  range skew kurtosis
## X1    1 98 135.43 34.72 135.43  135.17 40.54 40.68 221.25 180.57 0.03    -0.29
##      se
## X1 3.51
## ------------------------------------------------------------ 
## group: No Targeting
##    vars   n   mean    sd median trimmed   mad   min    max  range skew kurtosis
## X1    1 112 117.97 30.62 121.21  117.98 29.01 28.87 193.63 164.76 -0.1    -0.05
##      se
## X1 2.89</code></pre>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="r-markdown.html#cb762-1" tabindex="-1"></a><span class="co">#Visual inspection of data</span></span>
<span id="cb762-2"><a href="r-markdown.html#cb762-2" tabindex="-1"></a></span>
<span id="cb762-3"><a href="r-markdown.html#cb762-3" tabindex="-1"></a><span class="fu">ggplot</span>(targeting_data,<span class="fu">aes</span>(<span class="at">x =</span> targeting, <span class="at">y =</span> revenue)) <span class="sc">+</span> </span>
<span id="cb762-4"><a href="r-markdown.html#cb762-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb762-5"><a href="r-markdown.html#cb762-5" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb762-6"><a href="r-markdown.html#cb762-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb762-7"><a href="r-markdown.html#cb762-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Targeting&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Revenue&quot;</span>)<span class="sc">+</span></span>
<span id="cb762-8"><a href="r-markdown.html#cb762-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb762-9"><a href="r-markdown.html#cb762-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,<span class="at">color =</span> <span class="st">&quot;#666666&quot;</span>)) </span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_5_1-1.png" width="672" /></p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="r-markdown.html#cb763-1" tabindex="-1"></a><span class="co">#Distributional assumptions - checking for normal distributions</span></span>
<span id="cb763-2"><a href="r-markdown.html#cb763-2" tabindex="-1"></a></span>
<span id="cb763-3"><a href="r-markdown.html#cb763-3" tabindex="-1"></a><span class="co">#test for normal distribution of variables - Shapiro-Wilk test</span></span>
<span id="cb763-4"><a href="r-markdown.html#cb763-4" tabindex="-1"></a><span class="fu">by</span>(targeting_data<span class="sc">$</span>revenue, targeting_data<span class="sc">$</span>targeting, shapiro.test)</span></code></pre></div>
<pre><code>## targeting_data$targeting: Personalized Targeting
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.98123, p-value = 0.2199
## 
## ------------------------------------------------------------ 
## targeting_data$targeting: Segment-Based Targeting
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.98853, p-value = 0.5629
## 
## ------------------------------------------------------------ 
## targeting_data$targeting: No Targeting
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.99486, p-value = 0.9555</code></pre>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="r-markdown.html#cb765-1" tabindex="-1"></a><span class="fu">qqnorm</span>(targeting_data[targeting_data<span class="sc">$</span>targeting <span class="sc">==</span> <span class="st">&quot;Personalized Targeting&quot;</span>, ]<span class="sc">$</span>revenue) </span>
<span id="cb765-2"><a href="r-markdown.html#cb765-2" tabindex="-1"></a><span class="fu">qqline</span>(targeting_data[targeting_data<span class="sc">$</span>targeting <span class="sc">==</span> <span class="st">&quot;Personalized Targeting&quot;</span>, ]<span class="sc">$</span>revenue)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_5_1-2.png" width="672" /></p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="r-markdown.html#cb766-1" tabindex="-1"></a><span class="fu">qqnorm</span>(targeting_data[targeting_data<span class="sc">$</span>targeting <span class="sc">==</span> <span class="st">&quot;Segment-Based Targeting&quot;</span>, ]<span class="sc">$</span>revenue) </span>
<span id="cb766-2"><a href="r-markdown.html#cb766-2" tabindex="-1"></a><span class="fu">qqline</span>(targeting_data[targeting_data<span class="sc">$</span>targeting <span class="sc">==</span> <span class="st">&quot;Segment-Based Targeting&quot;</span>, ]<span class="sc">$</span>revenue)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_5_1-3.png" width="672" /></p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="r-markdown.html#cb767-1" tabindex="-1"></a><span class="fu">qqnorm</span>(targeting_data[targeting_data<span class="sc">$</span>targeting <span class="sc">==</span> <span class="st">&quot;No Targeting&quot;</span>, ]<span class="sc">$</span>revenue) </span>
<span id="cb767-2"><a href="r-markdown.html#cb767-2" tabindex="-1"></a><span class="fu">qqline</span>(targeting_data[targeting_data<span class="sc">$</span>targeting <span class="sc">==</span> <span class="st">&quot;No Targeting&quot;</span>, ]<span class="sc">$</span>revenue)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_5_1-4.png" width="672" /></p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="r-markdown.html#cb768-1" tabindex="-1"></a><span class="co">#Homogeneity of variance</span></span>
<span id="cb768-2"><a href="r-markdown.html#cb768-2" tabindex="-1"></a></span>
<span id="cb768-3"><a href="r-markdown.html#cb768-3" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="r-markdown.html#cb770-1" tabindex="-1"></a><span class="fu">leveneTest</span>(revenue <span class="sc">~</span> targeting, <span class="at">data =</span> targeting_data, <span class="at">center =</span> mean)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["F value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"2.617276","3":"0.07468479"},{"1":"297","2":"NA","3":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="r-markdown.html#cb771-1" tabindex="-1"></a><span class="co"># Perform ANOVA for revenue across targeting strategies</span></span>
<span id="cb771-2"><a href="r-markdown.html#cb771-2" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(revenue <span class="sc">~</span> targeting, <span class="at">data =</span> targeting_data)</span>
<span id="cb771-3"><a href="r-markdown.html#cb771-3" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## targeting     2  81290   40645    41.9 &lt;2e-16 ***
## Residuals   297 288110     970                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="r-markdown.html#cb773-1" tabindex="-1"></a><span class="co">#Visualize the test</span></span>
<span id="cb773-2"><a href="r-markdown.html#cb773-2" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb773-3"><a href="r-markdown.html#cb773-3" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(</span>
<span id="cb773-4"><a href="r-markdown.html#cb773-4" tabindex="-1"></a>  <span class="at">data =</span> targeting_data,</span>
<span id="cb773-5"><a href="r-markdown.html#cb773-5" tabindex="-1"></a>  <span class="at">x =</span> targeting,</span>
<span id="cb773-6"><a href="r-markdown.html#cb773-6" tabindex="-1"></a>  <span class="at">y =</span> revenue,</span>
<span id="cb773-7"><a href="r-markdown.html#cb773-7" tabindex="-1"></a>  <span class="at">plot.type =</span> <span class="st">&quot;box&quot;</span>,</span>
<span id="cb773-8"><a href="r-markdown.html#cb773-8" tabindex="-1"></a>  <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>,</span>
<span id="cb773-9"><a href="r-markdown.html#cb773-9" tabindex="-1"></a>  <span class="at">pairwise.annotation =</span> <span class="st">&quot;p.value&quot;</span>,</span>
<span id="cb773-10"><a href="r-markdown.html#cb773-10" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">&quot;bonferroni&quot;</span>,</span>
<span id="cb773-11"><a href="r-markdown.html#cb773-11" tabindex="-1"></a>  <span class="at">effsize.type =</span> <span class="st">&quot;eta&quot;</span>, <span class="co">#if var.equal = FALSE, returns partial eta^2 </span></span>
<span id="cb773-12"><a href="r-markdown.html#cb773-12" tabindex="-1"></a>  <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb773-13"><a href="r-markdown.html#cb773-13" tabindex="-1"></a>  <span class="at">mean.plotting =</span> <span class="cn">TRUE</span>, </span>
<span id="cb773-14"><a href="r-markdown.html#cb773-14" tabindex="-1"></a>  <span class="at">mean.ci =</span> <span class="cn">TRUE</span>, </span>
<span id="cb773-15"><a href="r-markdown.html#cb773-15" tabindex="-1"></a>  <span class="at">mean.label.size =</span> <span class="fl">2.5</span>,</span>
<span id="cb773-16"><a href="r-markdown.html#cb773-16" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;parametric&quot;</span>, </span>
<span id="cb773-17"><a href="r-markdown.html#cb773-17" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">3</span>, </span>
<span id="cb773-18"><a href="r-markdown.html#cb773-18" tabindex="-1"></a>  <span class="at">outlier.label.color =</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb773-19"><a href="r-markdown.html#cb773-19" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Comparison of revenues between groups&quot;</span>,</span>
<span id="cb773-20"><a href="r-markdown.html#cb773-20" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Experimental group&quot;</span>, </span>
<span id="cb773-21"><a href="r-markdown.html#cb773-21" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Revenue&quot;</span>, </span>
<span id="cb773-22"><a href="r-markdown.html#cb773-22" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span>,</span>
<span id="cb773-23"><a href="r-markdown.html#cb773-23" tabindex="-1"></a>  <span class="at">bf.message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb773-24"><a href="r-markdown.html#cb773-24" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_5_1-5.png" width="672" /></p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="r-markdown.html#cb774-1" tabindex="-1"></a><span class="co">#Inspect the residuals</span></span>
<span id="cb774-2"><a href="r-markdown.html#cb774-2" tabindex="-1"></a><span class="fu">plot</span>(anova_result,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_5_1-6.png" width="672" /></p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="r-markdown.html#cb775-1" tabindex="-1"></a><span class="fu">plot</span>(anova_result,<span class="dv">2</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_5_1-7.png" width="672" /></p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="r-markdown.html#cb776-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(anova_result))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(anova_result)
## W = 0.99499, p-value = 0.4388</code></pre>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="r-markdown.html#cb778-1" tabindex="-1"></a><span class="co">#Effect size</span></span>
<span id="cb778-2"><a href="r-markdown.html#cb778-2" tabindex="-1"></a></span>
<span id="cb778-3"><a href="r-markdown.html#cb778-3" tabindex="-1"></a><span class="fu">summary</span>(anova_result)[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">&quot;Sum Sq&quot;</span>[<span class="dv">1</span>]<span class="sc">/</span>(<span class="fu">summary</span>(anova_result)[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">&quot;Sum Sq&quot;</span>[<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb778-4"><a href="r-markdown.html#cb778-4" tabindex="-1"></a>    <span class="fu">summary</span>(anova_result)[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">&quot;Sum Sq&quot;</span>[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 0.2200593</code></pre>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="r-markdown.html#cb780-1" tabindex="-1"></a><span class="co"># Tukey&#39;s post-hoc test for pairwise comparisons</span></span>
<span id="cb780-2"><a href="r-markdown.html#cb780-2" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb780-3"><a href="r-markdown.html#cb780-3" tabindex="-1"></a><span class="fu">print</span>(tukey_result)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = revenue ~ targeting, data = targeting_data)
## 
## $targeting
##                                                     diff       lwr       upr
## Segment-Based Targeting-Personalized Targeting -22.89817 -33.60926 -12.18709
## No Targeting-Personalized Targeting            -40.35672 -50.74238 -29.97106
## No Targeting-Segment-Based Targeting           -17.45855 -27.60645  -7.31064
##                                                    p adj
## Segment-Based Targeting-Personalized Targeting 0.0000025
## No Targeting-Personalized Targeting            0.0000000
## No Targeting-Segment-Based Targeting           0.0001909</code></pre>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="r-markdown.html#cb782-1" tabindex="-1"></a><span class="fu">plot</span>(tukey_result)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_5_1-8.png" width="672" /></p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="r-markdown.html#cb783-1" tabindex="-1"></a><span class="co"># Boxplot for Revenue by Targeting Strategy</span></span>
<span id="cb783-2"><a href="r-markdown.html#cb783-2" tabindex="-1"></a><span class="fu">ggplot</span>(targeting_data, <span class="fu">aes</span>(<span class="at">x =</span> targeting, <span class="at">y =</span> revenue, <span class="at">fill =</span> targeting)) <span class="sc">+</span></span>
<span id="cb783-3"><a href="r-markdown.html#cb783-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb783-4"><a href="r-markdown.html#cb783-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Boxplot of Revenue by Targeting Strategy&quot;</span>,</span>
<span id="cb783-5"><a href="r-markdown.html#cb783-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Targeting Strategy&quot;</span>,</span>
<span id="cb783-6"><a href="r-markdown.html#cb783-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Revenue (USD)&quot;</span>) <span class="sc">+</span></span>
<span id="cb783-7"><a href="r-markdown.html#cb783-7" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;lightcoral&quot;</span>)) <span class="sc">+</span></span>
<span id="cb783-8"><a href="r-markdown.html#cb783-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/a2_question_5_1-9.png" width="672" /></p>
<p>Both the summary statistics and the plot show that the means are not equal among the three groups. Especially the difference between personalized targeting and no targeting seem to be quite high.</p>
<p>First we check if the assumptions of ANOVA are met. The insignificant result of Shapiro-Wilk test shows that we cannot reject the null hypothesis that the residuals are normally distributed. The same we can see from the Q-Q plots.</p>
<p>The null hypothesis of Levene’s test is that the variances are equal, with the alternative hypothesis being that the variances are not all equal. The insignificant result of this test demonstrates that variances are equal, so this assumption is also met.</p>
<p>The ANOVA showed a p-value lower that 0.05, which means we can reject the null hypothesis that the mean revenue is the same for all three groups with different types of targeting.</p>
<p>The Q-Q plots show us that the residuals are equally distributed, which is confirmed also by the insignificant result of the Shapiro-Wilk test. The null hypothesis for this test is that the distribution of residuals is normal.</p>
<p>According to the test, the effect of different types of targeting on revenues was detected: F = 41.9, p &lt; 0.05, with the effect size which is rather small η2 = 0.22.</p>
<p>The Tukey’s HSD test compares pairwise all three groups and we can see from the result that we can reject null hypothesis in all three case, which means that the revenue means are all significantly different from each other. It is clearly visible that none of the CIs cross the 0 bound, which further indicates that all differences in means are statistically significantly different from 0.</p>
<p>From a reporting standpoint we can say that revenue is higher when using personalized targeting. This means that personalized targeting helps us to increase sales and should thus be the preferred choice.</p>
</div>
<div id="question-6" class="section level3 hasAnchor" number="8.3.15">
<h3><span class="header-section-number">8.3.15</span> Question 6<a href="r-markdown.html#question-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this question we want to examine whether the customer satisfaction is significantly different for the groups with three different types of targeting. Because we are dealing with data on an ordinal scale, we cannot use ANOVA for this analysis. The non-parametric counterpart is the Kruskal-Wallis test, which tests for differences in medians between more than two groups. Hence, the null hypothesis is that the medians are equal in each group, and the alternative hypothesis is that there is a difference in medians.</p>
<p>First, we inspect the descriptive statistics and the plot. The only assumption for Kruskal-Wallis test is that the DV has to be at least ordinal scaled, and this assumption is met.</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="r-markdown.html#cb784-1" tabindex="-1"></a><span class="co"># provide your code here (you can use multiple code chunks per question if you like)</span></span>
<span id="cb784-2"><a href="r-markdown.html#cb784-2" tabindex="-1"></a></span>
<span id="cb784-3"><a href="r-markdown.html#cb784-3" tabindex="-1"></a><span class="co">#Descriptive statistics by for customer satisfaction by group</span></span>
<span id="cb784-4"><a href="r-markdown.html#cb784-4" tabindex="-1"></a><span class="fu">describeBy</span>(targeting_data<span class="sc">$</span>satisfaction, targeting_data<span class="sc">$</span>targeting)</span></code></pre></div>
<pre><code>## 
##  Descriptive statistics by group 
## group: Personalized Targeting
##    vars  n mean   sd median trimmed  mad min max range  skew kurtosis   se
## X1    1 90 5.23 3.01      6    5.32 2.97   0  10    10 -0.19    -1.08 0.32
## ------------------------------------------------------------ 
## group: Segment-Based Targeting
##    vars  n mean   sd median trimmed  mad min max range  skew kurtosis   se
## X1    1 98    5 3.37      5       5 4.45   0  10    10 -0.02    -1.47 0.34
## ------------------------------------------------------------ 
## group: No Targeting
##    vars   n mean   sd median trimmed  mad min max range skew kurtosis   se
## X1    1 112 4.63 2.89      5    4.52 4.45   0  10    10 0.15    -1.14 0.27</code></pre>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="r-markdown.html#cb786-1" tabindex="-1"></a><span class="co"># Boxplot for Satisfaction by Targeting Strategy</span></span>
<span id="cb786-2"><a href="r-markdown.html#cb786-2" tabindex="-1"></a><span class="fu">ggplot</span>(targeting_data, <span class="fu">aes</span>(<span class="at">x =</span> targeting, <span class="at">y =</span> satisfaction, <span class="at">fill =</span> targeting)) <span class="sc">+</span></span>
<span id="cb786-3"><a href="r-markdown.html#cb786-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb786-4"><a href="r-markdown.html#cb786-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Boxplot of Customer Satisfaction by Targeting Strategy&quot;</span>,</span>
<span id="cb786-5"><a href="r-markdown.html#cb786-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Targeting Strategy&quot;</span>,</span>
<span id="cb786-6"><a href="r-markdown.html#cb786-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Satisfaction Score&quot;</span>) <span class="sc">+</span></span>
<span id="cb786-7"><a href="r-markdown.html#cb786-7" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;lightcoral&quot;</span>)) <span class="sc">+</span></span>
<span id="cb786-8"><a href="r-markdown.html#cb786-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/question_6_1-1.png" width="672" /></p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="r-markdown.html#cb787-1" tabindex="-1"></a><span class="co"># Kruskal-Wallis test for satisfaction across targeting strategies</span></span>
<span id="cb787-2"><a href="r-markdown.html#cb787-2" tabindex="-1"></a>kruskal_result <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(satisfaction <span class="sc">~</span> targeting, <span class="at">data =</span> targeting_data)</span>
<span id="cb787-3"><a href="r-markdown.html#cb787-3" tabindex="-1"></a><span class="fu">print</span>(kruskal_result)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  satisfaction by targeting
## Kruskal-Wallis chi-squared = 2.0659, df = 2, p-value = 0.356</code></pre>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="r-markdown.html#cb789-1" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(</span>
<span id="cb789-2"><a href="r-markdown.html#cb789-2" tabindex="-1"></a>  <span class="at">data =</span> targeting_data,</span>
<span id="cb789-3"><a href="r-markdown.html#cb789-3" tabindex="-1"></a>  <span class="at">plot.type =</span> <span class="st">&quot;box&quot;</span>,</span>
<span id="cb789-4"><a href="r-markdown.html#cb789-4" tabindex="-1"></a>  <span class="at">x =</span> targeting, <span class="co">#3 groups</span></span>
<span id="cb789-5"><a href="r-markdown.html#cb789-5" tabindex="-1"></a>  <span class="at">y =</span> satisfaction,</span>
<span id="cb789-6"><a href="r-markdown.html#cb789-6" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;nonparametric&quot;</span>,</span>
<span id="cb789-7"><a href="r-markdown.html#cb789-7" tabindex="-1"></a>  <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>,</span>
<span id="cb789-8"><a href="r-markdown.html#cb789-8" tabindex="-1"></a>  <span class="at">pairwise.annotation =</span> <span class="st">&quot;p.value&quot;</span>,</span>
<span id="cb789-9"><a href="r-markdown.html#cb789-9" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">&quot;bonferroni&quot;</span>,</span>
<span id="cb789-10"><a href="r-markdown.html#cb789-10" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span>,</span>
<span id="cb789-11"><a href="r-markdown.html#cb789-11" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Median satisfaction for different targeting groups&quot;</span></span>
<span id="cb789-12"><a href="r-markdown.html#cb789-12" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/question_6_1-2.png" width="672" /></p>
<p>We can see from the descriptive statistics and from the boxplot that the median customer satisfaction for customers with personalized targeting is slightly higher (=6) than for other two targeting types (=5).</p>
<p>The p-value of Kruskal-Wallis test is higher than 0.05, which indicates that we cannot reject the null hypothesis. This means that medians of customer satisfaction are not different among the targeting groups.</p>
</div>
<div id="assignment-2d" class="section level3 hasAnchor" number="8.3.16">
<h3><span class="header-section-number">8.3.16</span> Assignment 2d<a href="r-markdown.html#assignment-2d" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As a digital marketing manager, you want to evaluate the effectiveness of a new email subscription pop-up feature designed to increase newsletter signups. You run an A/B test where some visitors to your website see the new subscription pop-up, while others experience the regular sign-up option without a pop-up. Your goal is to compare the conversion rate (whether visitors signed up for the newsletter) between the control group (no pop-up) and the treatment group (pop-up).</p>
<p>You obtain a new data set with the following variables:</p>
<ul>
<li><strong>customerID:</strong> Unique customer ID.</li>
<li><strong>conversion:</strong> Indicator variable for whether a visitor signed up for the newsletter (0 = no, 1 = yes).</li>
<li><strong>exp_group:</strong> Experimental group (0 = control, no pop-up; 1 = treatment, pop-up).</li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>Did the new email subscription pop-up have a significant effect on the conversion rate?</li>
</ol>
</div>
<div id="data-analysis-3" class="section level3 hasAnchor" number="8.3.17">
<h3><span class="header-section-number">8.3.17</span> Data analysis<a href="r-markdown.html#data-analysis-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="load-data-3" class="section level3 hasAnchor" number="8.3.18">
<h3><span class="header-section-number">8.3.18</span> Load data<a href="r-markdown.html#load-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="r-markdown.html#cb790-1" tabindex="-1"></a>conversion_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/WU-RDS/MA2024/main/conversion_data.csv&quot;</span>,</span>
<span id="cb790-2"><a href="r-markdown.html#cb790-2" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)  <span class="co">#read in data</span></span>
<span id="cb790-3"><a href="r-markdown.html#cb790-3" tabindex="-1"></a><span class="fu">head</span>(conversion_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["customerID"],"name":[1],"type":["int"],"align":["right"]},{"label":["exp_group"],"name":[2],"type":["chr"],"align":["left"]},{"label":["conversion"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"Control","3":"0"},{"1":"2","2":"Treatment","3":"0"},{"1":"3","2":"Treatment","3":"0"},{"1":"4","2":"Control","3":"0"},{"1":"5","2":"Control","3":"0"},{"1":"6","2":"Control","3":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="r-markdown.html#cb791-1" tabindex="-1"></a><span class="fu">str</span>(conversion_data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    487 obs. of  3 variables:
##  $ customerID: int  1 2 3 4 5 6 7 8 9 10 ...
##  $ exp_group : chr  &quot;Control&quot; &quot;Treatment&quot; &quot;Treatment&quot; &quot;Control&quot; ...
##  $ conversion: int  0 0 0 0 0 0 1 1 1 1 ...</code></pre>
</div>
<div id="question-7" class="section level3 hasAnchor" number="8.3.19">
<h3><span class="header-section-number">8.3.19</span> Question 7<a href="r-markdown.html#question-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To find out if a new email subscription pop-up feature has an effect on the conversion rate, we can use a test for proportions. To test for the equality of proportions (and therefore no difference between them) we can use a Chi-squared test.</p>
<p>Our null hypothesis in this case states that the proportions of conversion are the same for groups with and without the subscription pop-up feature. Our alternative hypothesis states that these proportions are unequal. First, we have to recode the relevant variables into factors. Then we create a contingency table and a plot to take a look at the proportions of conversion rates in the control and treatment groups. We can then conduct the formal Chi-squared test to see if the difference in conversion rates is significant.</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="r-markdown.html#cb793-1" tabindex="-1"></a><span class="co"># provide your code here (you can use multiple code chunks per question if you like)</span></span>
<span id="cb793-2"><a href="r-markdown.html#cb793-2" tabindex="-1"></a></span>
<span id="cb793-3"><a href="r-markdown.html#cb793-3" tabindex="-1"></a><span class="co">#Recoding variables into factors</span></span>
<span id="cb793-4"><a href="r-markdown.html#cb793-4" tabindex="-1"></a>conversion_data<span class="sc">$</span>exp_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(conversion_data<span class="sc">$</span>exp_group, </span>
<span id="cb793-5"><a href="r-markdown.html#cb793-5" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, </span>
<span id="cb793-6"><a href="r-markdown.html#cb793-6" tabindex="-1"></a>                                              <span class="st">&quot;Treatment&quot;</span>))</span>
<span id="cb793-7"><a href="r-markdown.html#cb793-7" tabindex="-1"></a></span>
<span id="cb793-8"><a href="r-markdown.html#cb793-8" tabindex="-1"></a>conversion_data<span class="sc">$</span>conversion <span class="ot">&lt;-</span> <span class="fu">factor</span>(conversion_data<span class="sc">$</span>conversion, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>))</span>
<span id="cb793-9"><a href="r-markdown.html#cb793-9" tabindex="-1"></a></span>
<span id="cb793-10"><a href="r-markdown.html#cb793-10" tabindex="-1"></a><span class="co"># Create a contingency table for conversions</span></span>
<span id="cb793-11"><a href="r-markdown.html#cb793-11" tabindex="-1"></a>conversion_table <span class="ot">&lt;-</span> <span class="fu">table</span>(conversion_data<span class="sc">$</span>exp_group, conversion_data<span class="sc">$</span>conversion)</span>
<span id="cb793-12"><a href="r-markdown.html#cb793-12" tabindex="-1"></a><span class="fu">print</span>(conversion_table)</span></code></pre></div>
<pre><code>##            
##              no yes
##   Control   206  47
##   Treatment 165  69</code></pre>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="r-markdown.html#cb795-1" tabindex="-1"></a><span class="fu">prop.table</span>(conversion_table, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##            
##                    no       yes
##   Control   0.8142292 0.1857708
##   Treatment 0.7051282 0.2948718</code></pre>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="r-markdown.html#cb797-1" tabindex="-1"></a><span class="co">#Visualization</span></span>
<span id="cb797-2"><a href="r-markdown.html#cb797-2" tabindex="-1"></a>rel_freq_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(conversion_data<span class="sc">$</span>exp_group, conversion_data<span class="sc">$</span>conversion), <span class="dv">1</span>))</span>
<span id="cb797-3"><a href="r-markdown.html#cb797-3" tabindex="-1"></a><span class="fu">names</span>(rel_freq_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;exp_group&quot;</span>, <span class="st">&quot;conversion&quot;</span>,<span class="st">&quot;freq&quot;</span>) <span class="co"># changing names of the columns</span></span>
<span id="cb797-4"><a href="r-markdown.html#cb797-4" tabindex="-1"></a>rel_freq_table</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["exp_group"],"name":[1],"type":["fct"],"align":["left"]},{"label":["conversion"],"name":[2],"type":["fct"],"align":["left"]},{"label":["freq"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Control","2":"no","3":"0.8142292"},{"1":"Treatment","2":"no","3":"0.7051282"},{"1":"Control","2":"yes","3":"0.1857708"},{"1":"Treatment","2":"yes","3":"0.2948718"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="r-markdown.html#cb798-1" tabindex="-1"></a><span class="fu">ggplot</span>(rel_freq_table, <span class="fu">aes</span>(<span class="at">x =</span> exp_group, <span class="at">y =</span> freq, <span class="at">fill =</span> conversion)) <span class="sc">+</span> <span class="co">#plot data</span></span>
<span id="cb798-2"><a href="r-markdown.html#cb798-2" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> .<span class="dv">7</span>) <span class="sc">+</span> <span class="co">#position</span></span>
<span id="cb798-3"><a href="r-markdown.html#cb798-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq<span class="sc">*</span><span class="dv">100</span>,<span class="dv">0</span>),<span class="st">&quot;%&quot;</span>)), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="co">#add percentages</span></span>
<span id="cb798-4"><a href="r-markdown.html#cb798-4" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Proportion of conversions&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Exp group&quot;</span>) <span class="sc">+</span> <span class="co"># specify axis labels</span></span>
<span id="cb798-5"><a href="r-markdown.html#cb798-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/question_7_1-1.png" width="672" /></p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="r-markdown.html#cb799-1" tabindex="-1"></a><span class="co"># Proportion test to compare conversion rates between groups</span></span>
<span id="cb799-2"><a href="r-markdown.html#cb799-2" tabindex="-1"></a>prop_test_result <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(conversion_table)</span>
<span id="cb799-3"><a href="r-markdown.html#cb799-3" tabindex="-1"></a><span class="fu">print</span>(prop_test_result)</span></code></pre></div>
<pre><code>## 
##  2-sample test for equality of proportions with continuity correction
## 
## data:  conversion_table
## X-squared = 7.3844, df = 1, p-value = 0.006579
## alternative hypothesis: two.sided
## 95 percent confidence interval:
##  0.02942325 0.18877884
## sample estimates:
##    prop 1    prop 2 
## 0.8142292 0.7051282</code></pre>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="r-markdown.html#cb801-1" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">table</span>(conversion_data<span class="sc">$</span>conversion,conversion_data<span class="sc">$</span>exp_group)</span>
<span id="cb801-2"><a href="r-markdown.html#cb801-2" tabindex="-1"></a><span class="fu">chisq.test</span>(table, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  table
## X-squared = 7.3844, df = 1, p-value = 0.006579</code></pre>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="r-markdown.html#cb803-1" tabindex="-1"></a><span class="co">#effect size</span></span>
<span id="cb803-2"><a href="r-markdown.html#cb803-2" tabindex="-1"></a>test_stat <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(conversion_table, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>statistic</span>
<span id="cb803-3"><a href="r-markdown.html#cb803-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(conversion_data)</span>
<span id="cb803-4"><a href="r-markdown.html#cb803-4" tabindex="-1"></a>phi1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(test_stat<span class="sc">/</span>n)</span>
<span id="cb803-5"><a href="r-markdown.html#cb803-5" tabindex="-1"></a>phi1</span></code></pre></div>
<pre><code>## X-squared 
##  0.127962</code></pre>
<p>We can see in the contingency table and in the plot that the conversion rate in the treatment group of 29% is higher than the conversion rate of 19% in the control group. To see if this difference is significant, we have to conduct the formal chi-squared test. It can be clearly seen from the test that p-value is lower than 0.05, so the result of the treatment on the conversion rate is statistically significant. We also calculated the effect size Phi: it is pretty small 0.128.</p>
<p>From the managerial perspective, it makes sense to include the new email subscription pop-up feature since it significantly increases the coversion rate, although the effect size is rather small.</p>
</div>
</div>
<div id="assignment-3" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Assignment 3<a href="r-markdown.html#assignment-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="assignment-a" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Assignment A<a href="r-markdown.html#assignment-a" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As a marketing manager at a consumer electronics company, you have been assigned the task of evaluating the effectiveness of various marketing activities on the sales of smart home devices (smart speakers). The company wants to understand the relative influence of leaflet promotions, in-store sales representatives, and radio advertising, as well as the impact of pricing on overall sales.</p>
<p>The dataset provided contains data from multiple stores over the past year. Each row in the dataset corresponds to a different store, detailing the sales performance of smart home devices alongside the store’s marketing investments and product pricing.</p>
<p>The following variables are available to you:</p>
<ul>
<li>Sales: Number of units sold in each store</li>
<li>Price: Sale price of the product (in Euros)</li>
<li>Marketing Contribution: Promotion costs for including the product in leaflets distributed by the store (in Euros)</li>
<li>Sales Reps: Expenditure on in-store promotions managed by the company’s sales representatives (in Euros)</li>
<li>Retail Media POS: Advertising expenses for marketing placements at the point of sale (in Euros)</li>
<li>Region: Categorical variable indicating the region where the store is located (rural, suburban, or urban)</li>
</ul>
<p><strong>Task Instructions</strong></p>
<p>Please conduct the following analyses:</p>
<ol style="list-style-type: decimal">
<li><p>Regression Equation: Formally state the regression equation you will use to determine the relative influence of each marketing activity and price on sales. Save the equation as a “formula” object in the R code chunk.</p></li>
<li><p>Variable Description: Describe the model variables using appropriate summary statistics and visualizations to provide a clear understanding of each variable’s distribution and scale.</p></li>
<li><p>Multiple Linear Regression Model: Estimate a multiple linear regression model to evaluate the relative influence of each variable. Before interpreting the results, assess whether the model meets the assumptions of linear regression. Use appropriate diagnostic tests and plots to evaluate these assumptions.</p></li>
<li><p>Alternative Model Specifications: If the model assumptions are not fully met, evaluate alternative model specifications using different functional forms. Justify your choice of model based on diagnostic criteria and model properties.</p></li>
<li><p>Model Interpretation: Interpret the results of the chosen model:</p></li>
</ol>
<ul>
<li>Which variables have a significant influence on sales, and what do the coefficients imply about each variable’s effect?</li>
<li>What is the relative importance of each predictor?</li>
<li>Interpret the F-test results.</li>
<li>How would you assess the fit of the model? Include a visualization of model fit for clarity.</li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li><p>Sales Prediction: Based on your chosen model, predict the sales quantity for a store planning the following marketing activities: Price: €350, Marketing Contribution: €10,000, Sales Reps: €6,000, Retail Media POS: €3,000. Provide the equation you used for the prediction.</p></li>
<li><p>Assess to what extent customers from different regions differ regarding their price sensitivity. Are customers from urban and suburban areas more or less price-sensitive compared to rural areas? Provide a detailed explanation of your analysis and results.</p></li>
</ol>
<p>When you have completed your analysis, click the “Knit to HTML” button above the code editor. This will generate an HTML document of your results in the folder where the “assignment3.Rmd” file is stored. Open the HTML file in your Internet browser to verify the output. Once verified, submit the HTML file via Canvas. Name the file: “assignment3_studentID_name.html”.</p>
</div>
<div id="data-analysis-4" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Data analysis<a href="r-markdown.html#data-analysis-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="load-data-4" class="section level3 hasAnchor" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> Load data<a href="r-markdown.html#load-data-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="r-markdown.html#cb805-1" tabindex="-1"></a>sales_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/WU-RDS/MA2024/main/data/assignment3.csv&quot;</span>,</span>
<span id="cb805-2"><a href="r-markdown.html#cb805-2" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>)  <span class="co">#read in data</span></span>
<span id="cb805-3"><a href="r-markdown.html#cb805-3" tabindex="-1"></a><span class="fu">head</span>(sales_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["StoreID"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sales"],"name":[2],"type":["int"],"align":["right"]},{"label":["Price"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["MarketingContribution"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SalesReps"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["RetailMediaPOS"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Region"],"name":[7],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"89","3":"391.48","4":"8006.62","5":"2361.92","6":"1413.25","7":"Rural"},{"1":"2","2":"137","3":"393.71","4":"8964.35","5":"6236.37","6":"2711.37","7":"Rural"},{"1":"3","2":"112","3":"328.61","4":"7485.83","5":"2983.50","6":"1150.83","7":"Suburban"},{"1":"4","2":"59","3":"383.04","4":"4040.16","5":"3060.82","6":"1950.54","7":"Urban"},{"1":"5","2":"125","3":"364.17","4":"8791.86","5":"5065.14","6":"1984.27","7":"Suburban"},{"1":"6","2":"104","3":"351.91","4":"8644.35","5":"4031.30","6":"1667.79","7":"Urban"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="r-markdown.html#cb806-1" tabindex="-1"></a><span class="fu">str</span>(sales_data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1460 obs. of  7 variables:
##  $ StoreID              : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Sales                : int  89 137 112 59 125 104 74 131 121 145 ...
##  $ Price                : num  391 394 329 383 364 ...
##  $ MarketingContribution: num  8007 8964 7486 4040 8792 ...
##  $ SalesReps            : num  2362 6236 2984 3061 5065 ...
##  $ RetailMediaPOS       : num  1413 2711 1151 1951 1984 ...
##  $ Region               : chr  &quot;Rural&quot; &quot;Rural&quot; &quot;Suburban&quot; &quot;Urban&quot; ...</code></pre>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="r-markdown.html#cb808-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb808-2"><a href="r-markdown.html#cb808-2" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb808-3"><a href="r-markdown.html#cb808-3" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb808-4"><a href="r-markdown.html#cb808-4" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb808-5"><a href="r-markdown.html#cb808-5" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb808-6"><a href="r-markdown.html#cb808-6" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb808-7"><a href="r-markdown.html#cb808-7" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code></pre></div>
<pre><code>## Loading required package: zoo</code></pre>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="r-markdown.html#cb810-1" tabindex="-1"></a><span class="fu">library</span>(lm.beta)</span>
<span id="cb810-2"><a href="r-markdown.html#cb810-2" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb810-3"><a href="r-markdown.html#cb810-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code></pre></div>
</div>
<div id="question-1-1" class="section level3 hasAnchor" number="8.4.4">
<h3><span class="header-section-number">8.4.4</span> Question 1<a href="r-markdown.html#question-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a first step, we specify the regression equation. In this case, sales of home devices is the dependent variable, and predictors for store i are 1) price, 2) promotion costs, 3) expenditures on sales representatives, 4) costs for marketing placements at POS.</p>
<p><span class="math display">\[
Sales_i=\beta_0 + \beta_1 * Price_i + \beta_2 * MarketingContribution_i + \beta_3 * SalesReps_i + \beta_4 * RetailMediaPOS_i + \epsilon_i
\]</span></p>
<p>This equation will be used later to turn the output of the regression analysis (namely the coefficients: β0 - intersect coefficient, and β1, β2, and β3 that represent the unknown relationship between sales and Price, MarketingContribution, SalesReps, SalesMediaPOS to the “managerial” form and draw marketing conclusions.</p>
<p>With the following code we are saving the formula:</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="r-markdown.html#cb811-1" tabindex="-1"></a>formula <span class="ot">&lt;-</span> Sales <span class="sc">~</span> Price <span class="sc">+</span> MarketingContribution <span class="sc">+</span></span>
<span id="cb811-2"><a href="r-markdown.html#cb811-2" tabindex="-1"></a>    SalesReps <span class="sc">+</span> RetailMediaPOS</span></code></pre></div>
</div>
<div id="question-2-1" class="section level3 hasAnchor" number="8.4.5">
<h3><span class="header-section-number">8.4.5</span> Question 2<a href="r-markdown.html#question-2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Inspecting the variables with descriptive statistics:</p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="r-markdown.html#cb812-1" tabindex="-1"></a><span class="co"># descriptive statistics can be checked with the</span></span>
<span id="cb812-2"><a href="r-markdown.html#cb812-2" tabindex="-1"></a><span class="co"># following code</span></span>
<span id="cb812-3"><a href="r-markdown.html#cb812-3" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(sales_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["vars"],"name":[1],"type":["int"],"align":["right"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["trimmed"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mad"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["min"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["range"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["skew"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["kurtosis"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["se"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1460","3":"730.500000","4":"421.6100094","5":"730.500","6":"730.500000","7":"541.14900","8":"1.00","9":"1460.00","10":"1459.00","11":"0.00000000","12":"-1.20246603","13":"11.03403825"},{"1":"2","2":"1460","3":"131.278767","4":"29.7819991","5":"128.000","6":"129.782534","7":"29.65200","8":"57.00","9":"250.00","10":"193.00","11":"0.48299957","12":"0.04463889","13":"0.77943054"},{"1":"3","2":"1460","3":"348.855219","4":"29.1391074","5":"348.070","6":"348.699675","7":"37.65063","8":"300.02","9":"399.94","10":"99.92","11":"0.04064067","12":"-1.21817760","13":"0.76260529"},{"1":"4","2":"1460","3":"7550.748096","4":"2637.6067793","5":"7650.520","6":"7557.892628","7":"3417.94897","8":"3003.36","9":"11997.87","10":"8994.51","11":"-0.03812799","12":"-1.23926459","13":"69.02932433"},{"1":"5","2":"1460","3":"5075.157644","4":"1749.5662514","5":"5081.560","6":"5088.025839","7":"2253.35185","8":"2002.30","9":"7998.99","10":"5996.69","11":"-0.04156755","12":"-1.24701453","13":"45.78824151"},{"1":"6","2":"1460","3":"3028.719418","4":"1152.8164744","5":"3074.765","6":"3033.752663","7":"1447.17327","8":"1002.75","9":"4998.96","10":"3996.21","11":"-0.04237390","12":"-1.15931275","13":"30.17058605"},{"1":"7","2":"1460","3":"1.989726","4":"0.8055862","5":"2.000","6":"1.987158","7":"1.48260","8":"1.00","9":"3.00","10":"2.00","11":"0.01858430","12":"-1.45992653","13":"0.02108315"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Inspecting the correlation matrix reveals that the sales variable is positively correlated with MarketingContribution, SalesReps and RetailMediaPOS.</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="r-markdown.html#cb813-1" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(sales_data[, <span class="fu">c</span>(<span class="st">&quot;Sales&quot;</span>, <span class="st">&quot;Price&quot;</span>, <span class="st">&quot;MarketingContribution&quot;</span>,</span>
<span id="cb813-2"><a href="r-markdown.html#cb813-2" tabindex="-1"></a>    <span class="st">&quot;SalesReps&quot;</span>, <span class="st">&quot;RetailMediaPOS&quot;</span>)]))</span></code></pre></div>
<pre><code>##                       Sales Price MarketingContribution SalesReps
## Sales                  1.00 -0.51                  0.52      0.43
## Price                 -0.51  1.00                 -0.01     -0.04
## MarketingContribution  0.52 -0.01                  1.00      0.01
## SalesReps              0.43 -0.04                  0.01      1.00
## RetailMediaPOS         0.32 -0.03                  0.02      0.03
##                       RetailMediaPOS
## Sales                           0.32
## Price                          -0.03
## MarketingContribution           0.02
## SalesReps                       0.03
## RetailMediaPOS                  1.00
## 
## n= 1460 
## 
## 
## P
##                       Sales  Price  MarketingContribution SalesReps
## Sales                        0.0000 0.0000                0.0000   
## Price                 0.0000        0.7766                0.1232   
## MarketingContribution 0.0000 0.7766                       0.7751   
## SalesReps             0.0000 0.1232 0.7751                         
## RetailMediaPOS        0.0000 0.2149 0.4726                0.2988   
##                       RetailMediaPOS
## Sales                 0.0000        
## Price                 0.2149        
## MarketingContribution 0.4726        
## SalesReps             0.2988        
## RetailMediaPOS</code></pre>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="r-markdown.html#cb815-1" tabindex="-1"></a><span class="co"># Since we have continuous variables, we use</span></span>
<span id="cb815-2"><a href="r-markdown.html#cb815-2" tabindex="-1"></a><span class="co"># scatterplots to investigate the relationship</span></span>
<span id="cb815-3"><a href="r-markdown.html#cb815-3" tabindex="-1"></a><span class="co"># between sales and each of the predictor</span></span>
<span id="cb815-4"><a href="r-markdown.html#cb815-4" tabindex="-1"></a><span class="co"># variables.</span></span>
<span id="cb815-5"><a href="r-markdown.html#cb815-5" tabindex="-1"></a></span>
<span id="cb815-6"><a href="r-markdown.html#cb815-6" tabindex="-1"></a><span class="co"># relationship of Price and Sales</span></span>
<span id="cb815-7"><a href="r-markdown.html#cb815-7" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> Price, <span class="at">y =</span> Sales)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb815-8"><a href="r-markdown.html#cb815-8" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush3&quot;</span>,</span>
<span id="cb815-9"><a href="r-markdown.html#cb815-9" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="r-markdown.html#cb817-1" tabindex="-1"></a><span class="co"># relationship of MarketingContribution and Sales</span></span>
<span id="cb817-2"><a href="r-markdown.html#cb817-2" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> MarketingContribution, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb817-3"><a href="r-markdown.html#cb817-3" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb817-4"><a href="r-markdown.html#cb817-4" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush3&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb817-5"><a href="r-markdown.html#cb817-5" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="r-markdown.html#cb819-1" tabindex="-1"></a><span class="co"># relationship of SalesReps and Sales</span></span>
<span id="cb819-2"><a href="r-markdown.html#cb819-2" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> SalesReps, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb819-3"><a href="r-markdown.html#cb819-3" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb819-4"><a href="r-markdown.html#cb819-4" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush3&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb819-5"><a href="r-markdown.html#cb819-5" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="r-markdown.html#cb821-1" tabindex="-1"></a><span class="co"># relationship of RetailMediaPOS</span></span>
<span id="cb821-2"><a href="r-markdown.html#cb821-2" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> RetailMediaPOS, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb821-3"><a href="r-markdown.html#cb821-3" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb821-4"><a href="r-markdown.html#cb821-4" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush3&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb821-5"><a href="r-markdown.html#cb821-5" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-10-4.png" width="672" /></p>
<p>The plots including the fitted lines from a simple linear model suggest that there might be a positive relationship between sales and the predictors. However, the relationships between sales and independent variables appear to be rather weak. It appears more that the effect of independent variables is decreasing with increasing budget spent on these marketing activities.</p>
<p>Further steps include estimate of a multiple linear regression model in order to determine if linear specification fits the model.</p>
</div>
<div id="question-3-1" class="section level3 hasAnchor" number="8.4.6">
<h3><span class="header-section-number">8.4.6</span> Question 3<a href="r-markdown.html#question-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we estimate the model with the lm() function. But before we can inspect and interpret the results, we need to test if there might be potential problems with our model specification.</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="r-markdown.html#cb823-1" tabindex="-1"></a><span class="co"># Estimate linear model</span></span>
<span id="cb823-2"><a href="r-markdown.html#cb823-2" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> sales_data)</span>
<span id="cb823-3"><a href="r-markdown.html#cb823-3" tabindex="-1"></a><span class="fu">summary</span>(linear_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formula, data = sales_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -44.724  -9.856  -0.440   8.901  61.537 
## 
## Coefficients:
##                          Estimate  Std. Error t value            Pr(&gt;|t|)    
## (Intercept)           201.7441553   4.9359563   40.87 &lt;0.0000000000000002 ***
## Price                  -0.4886969   0.0129089  -37.86 &lt;0.0000000000000002 ***
## MarketingContribution   0.0056953   0.0001425   39.98 &lt;0.0000000000000002 ***
## SalesReps               0.0068560   0.0002150   31.89 &lt;0.0000000000000002 ***
## RetailMediaPOS          0.0073364   0.0003262   22.49 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 14.35 on 1455 degrees of freedom
## Multiple R-squared:  0.7685, Adjusted R-squared:  0.7679 
## F-statistic:  1208 on 4 and 1455 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="r-markdown.html#cb825-1" tabindex="-1"></a><span class="co"># Outliers</span></span>
<span id="cb825-2"><a href="r-markdown.html#cb825-2" tabindex="-1"></a>sales_data<span class="sc">$</span>stud_resid <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(linear_model)</span>
<span id="cb825-3"><a href="r-markdown.html#cb825-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sales_data), sales_data<span class="sc">$</span>stud_resid, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.3</span>,</span>
<span id="cb825-4"><a href="r-markdown.html#cb825-4" tabindex="-1"></a>    <span class="fl">3.3</span>))  <span class="co">#create scatterplot </span></span>
<span id="cb825-5"><a href="r-markdown.html#cb825-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co">#add reference lines</span></span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>To check for outliers, we extract the studentized residuals from our model and test if there are any absolute values larger than 3. Since there are many residuals with absolute values larger than 3, we conclude that there are many outliers.</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="r-markdown.html#cb826-1" tabindex="-1"></a><span class="co"># influential observation</span></span>
<span id="cb826-2"><a href="r-markdown.html#cb826-2" tabindex="-1"></a><span class="fu">plot</span>(linear_model, <span class="dv">4</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="r-markdown.html#cb827-1" tabindex="-1"></a><span class="fu">plot</span>(linear_model, <span class="dv">5</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
<p>To test for influential observations, we use Cook’s Distance. To identify influential observations, we should look at values above 1 in the first plot. It is easy to see that all of the Cook’s distance values are below the cutoff of 1. In the second plot we should watch out for the outlying values at the upper right corner or at the lower right corner of the plot. Those spots are the places where cases can be influential against a regression line. In our example, both plots show that there are no influential cases.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="r-markdown.html#cb828-1" tabindex="-1"></a><span class="co"># Heteroscedasticity</span></span>
<span id="cb828-2"><a href="r-markdown.html#cb828-2" tabindex="-1"></a></span>
<span id="cb828-3"><a href="r-markdown.html#cb828-3" tabindex="-1"></a><span class="fu">plot</span>(linear_model, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="r-markdown.html#cb829-1" tabindex="-1"></a><span class="co"># Breusch Pagan test</span></span>
<span id="cb829-2"><a href="r-markdown.html#cb829-2" tabindex="-1"></a><span class="fu">bptest</span>(linear_model)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  linear_model
## BP = 95.594, df = 4, p-value &lt; 0.00000000000000022</code></pre>
<p>Next, we test if a linear specification appears feasible. We can look at the residuals plot to see if the linear specification is appropriate. This plot helps us to determine if error variances are equal, which is an assumption of the linear model. The red line is a smoothed curve through the residuals plot and if it deviates from the dashed grey horizontal line a lot, it means that the linear model specification is not a correct choice. In this example, the red line is rather far from the dashed grey line, so this assumption seems to be not met.</p>
<p>Also, the residual variance (i.e., the spread of the values on the y-axis) should be similar across the scale of the fitted values on the x-axis, but we can observe a slight funnel shape, which indicates non-constant variances in the errors, so we can conduct Breusch Pagan test to confirm it. The null hypothesis for this test is that the error variances are equal, so the significant p-value &lt;0,05 indicates that the error variances aren’t equal, which indicates that the assumption of homoscedasticity is not met.</p>
<p>Next, we test if the residuals are approximately normally distributed using the Q-Q plot from the output and a Shapiro Wilk test.</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="r-markdown.html#cb831-1" tabindex="-1"></a><span class="co"># Non-normally distributed errors</span></span>
<span id="cb831-2"><a href="r-markdown.html#cb831-2" tabindex="-1"></a></span>
<span id="cb831-3"><a href="r-markdown.html#cb831-3" tabindex="-1"></a><span class="fu">plot</span>(linear_model, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="r-markdown.html#cb832-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(linear_model))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(linear_model)
## W = 0.99521, p-value = 0.0001326</code></pre>
<p>To check for normal distribution of the residuals, we need to conduct a Shapiro-Wilk test, the null hypothesis for it is that the residuals are normally distributed. So the significant p-value &lt;0,05 indicates that the error variances aren’t equal, which indicates that the assumption of normally distributed error term is not met.</p>
<p>Correlation of errors: We actually wouldn’t need to test this assumption here since there is not natural order in the data.</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="r-markdown.html#cb834-1" tabindex="-1"></a><span class="co">#Multicollinearity</span></span>
<span id="cb834-2"><a href="r-markdown.html#cb834-2" tabindex="-1"></a></span>
<span id="cb834-3"><a href="r-markdown.html#cb834-3" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(sales_data[,<span class="fu">c</span>(<span class="st">&quot;Price&quot;</span>,<span class="st">&quot;MarketingContribution&quot;</span>,<span class="st">&quot;SalesReps&quot;</span>, <span class="st">&quot;RetailMediaPOS&quot;</span>)]))</span></code></pre></div>
<pre><code>##                       Price MarketingContribution SalesReps RetailMediaPOS
## Price                  1.00                 -0.01     -0.04          -0.03
## MarketingContribution -0.01                  1.00      0.01           0.02
## SalesReps             -0.04                  0.01      1.00           0.03
## RetailMediaPOS        -0.03                  0.02      0.03           1.00
## 
## n= 1460 
## 
## 
## P
##                       Price  MarketingContribution SalesReps RetailMediaPOS
## Price                        0.7766                0.1232    0.2149        
## MarketingContribution 0.7766                       0.7751    0.4726        
## SalesReps             0.1232 0.7751                          0.2988        
## RetailMediaPOS        0.2149 0.4726                0.2988</code></pre>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="r-markdown.html#cb836-1" tabindex="-1"></a><span class="fu">plot</span>(sales_data[,<span class="fu">c</span>(<span class="st">&quot;Price&quot;</span>,<span class="st">&quot;MarketingContribution&quot;</span>,<span class="st">&quot;SalesReps&quot;</span>, <span class="st">&quot;RetailMediaPOS&quot;</span>)])</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="r-markdown.html#cb837-1" tabindex="-1"></a><span class="fu">ggcorrmat</span>(</span>
<span id="cb837-2"><a href="r-markdown.html#cb837-2" tabindex="-1"></a>  <span class="at">data =</span> sales_data[,<span class="fu">c</span>(<span class="st">&quot;Price&quot;</span>,<span class="st">&quot;MarketingContribution&quot;</span>,<span class="st">&quot;SalesReps&quot;</span>, <span class="st">&quot;RetailMediaPOS&quot;</span>)],</span>
<span id="cb837-3"><a href="r-markdown.html#cb837-3" tabindex="-1"></a>  <span class="at">matrix.type =</span> <span class="st">&quot;upper&quot;</span>,</span>
<span id="cb837-4"><a href="r-markdown.html#cb837-4" tabindex="-1"></a>  <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">&quot;skyblue4&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;palevioletred4&quot;</span>)</span>
<span id="cb837-5"><a href="r-markdown.html#cb837-5" tabindex="-1"></a>  <span class="co">#title = &quot;Correlalogram of independent variables&quot;,</span></span>
<span id="cb837-6"><a href="r-markdown.html#cb837-6" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="r-markdown.html#cb838-1" tabindex="-1"></a><span class="fu">vif</span>(linear_model)</span></code></pre></div>
<pre><code>##                 Price MarketingContribution             SalesReps 
##              1.002665              1.000446              1.002351 
##        RetailMediaPOS 
##              1.002069</code></pre>
<p>To test for linear dependence of the regressors, we first test the bivariate correlations for any extremely high correlations (i.e., &gt;0.8). We can see that bivariate correlations are not high among independent variable, so this assumption is met.</p>
<p>In the next step, we compute the variance inflation factor for each predictor variable. The values should be close to 1 and values larger than 4 indicate potential problems with the linear dependence of regressors, but in our model we don’t see any such values.</p>
</div>
<div id="question-4-1" class="section level3 hasAnchor" number="8.4.7">
<h3><span class="header-section-number">8.4.7</span> Question 4<a href="r-markdown.html#question-4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It appears that a linear model might not represent the data well. It rather appears that the effect of an additional Euro spend on different marketing activities is decreasing with increasing levels of advertising expenditures. Thus, we can assume decreasing marginal returns. Plus, the assumptions of linear specification like absence of outliers, homoscedasticity and normally distributed residuals.</p>
<p>In this case, a multiplicative model might be a better representation of the data.</p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="r-markdown.html#cb840-1" tabindex="-1"></a>log_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Sales) <span class="sc">~</span> <span class="fu">log</span>(Price) <span class="sc">+</span> <span class="fu">log</span>(MarketingContribution) <span class="sc">+</span></span>
<span id="cb840-2"><a href="r-markdown.html#cb840-2" tabindex="-1"></a>    <span class="fu">log</span>(SalesReps) <span class="sc">+</span> <span class="fu">log</span>(RetailMediaPOS), <span class="at">data =</span> sales_data)</span>
<span id="cb840-3"><a href="r-markdown.html#cb840-3" tabindex="-1"></a><span class="fu">summary</span>(log_reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Sales) ~ log(Price) + log(MarketingContribution) + 
##     log(SalesReps) + log(RetailMediaPOS), data = sales_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.31586 -0.07091 -0.00092  0.06816  0.32443 
## 
## Coefficients:
##                             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)                 6.475026   0.213041   30.39 &lt;0.0000000000000002 ***
## log(Price)                 -1.304723   0.031844  -40.97 &lt;0.0000000000000002 ***
## log(MarketingContribution)  0.302317   0.006875   43.98 &lt;0.0000000000000002 ***
## log(SalesReps)              0.248789   0.006984   35.62 &lt;0.0000000000000002 ***
## log(RetailMediaPOS)         0.154664   0.006114   25.30 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1018 on 1455 degrees of freedom
## Multiple R-squared:  0.8009, Adjusted R-squared:  0.8004 
## F-statistic:  1464 on 4 and 1455 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>We can check again the assumptions to see if the multiplicative specification fits the model better and if we can interpret the results of this model.</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="r-markdown.html#cb842-1" tabindex="-1"></a><span class="co"># Outliers</span></span>
<span id="cb842-2"><a href="r-markdown.html#cb842-2" tabindex="-1"></a>sales_data<span class="sc">$</span>stud_resid_1 <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(log_reg)</span>
<span id="cb842-3"><a href="r-markdown.html#cb842-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sales_data), sales_data<span class="sc">$</span>stud_resid_1, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.3</span>,</span>
<span id="cb842-4"><a href="r-markdown.html#cb842-4" tabindex="-1"></a>    <span class="fl">3.3</span>))  <span class="co">#create scatterplot </span></span>
<span id="cb842-5"><a href="r-markdown.html#cb842-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co">#add reference lines</span></span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="r-markdown.html#cb843-1" tabindex="-1"></a><span class="co"># influential observation</span></span>
<span id="cb843-2"><a href="r-markdown.html#cb843-2" tabindex="-1"></a><span class="fu">plot</span>(log_reg, <span class="dv">4</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="r-markdown.html#cb844-1" tabindex="-1"></a><span class="fu">plot</span>(log_reg, <span class="dv">5</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-18-3.png" width="672" /></p>
<p>We can see that in comparison with the plot of the linear model, there are fewer outliers, namely values of studentized residuals more than 3 and less than -3.</p>
<p>We check now if the assumption of constant variance is met, which was not the case in the linear specification.</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="r-markdown.html#cb845-1" tabindex="-1"></a><span class="co"># Heteroscedasticity</span></span>
<span id="cb845-2"><a href="r-markdown.html#cb845-2" tabindex="-1"></a></span>
<span id="cb845-3"><a href="r-markdown.html#cb845-3" tabindex="-1"></a><span class="fu">plot</span>(log_reg, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="r-markdown.html#cb846-1" tabindex="-1"></a><span class="co"># Breusch Pagan test</span></span>
<span id="cb846-2"><a href="r-markdown.html#cb846-2" tabindex="-1"></a><span class="fu">bptest</span>(log_reg)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  log_reg
## BP = 3.7846, df = 4, p-value = 0.4359</code></pre>
<p>In the plot, we can now observe that the values are more equally distributed along the line. We also conduct Breusch Pagan test. The null hypothesis for this test is that the error variances are equal, so the significant p-value of 0.6857 indicates that we cannot reject the null hypothesis, so the error variances are equal, which indicates that the assumption of homoscedasticity is met for this model.</p>
<p>Next we check if the residuals are normally distributed, which wasn’t the case in the linear model.</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="r-markdown.html#cb848-1" tabindex="-1"></a><span class="co"># Non-normally distributed errors</span></span>
<span id="cb848-2"><a href="r-markdown.html#cb848-2" tabindex="-1"></a></span>
<span id="cb848-3"><a href="r-markdown.html#cb848-3" tabindex="-1"></a><span class="fu">plot</span>(log_reg, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="r-markdown.html#cb849-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(log_reg))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(log_reg)
## W = 0.99932, p-value = 0.8931</code></pre>
<p>The null hypothesis of this Shaprio Wilk test is that the residuals are normally distributed. Since the p-value of the test is 0.8898 we cannot reject the null hypothesis, so the residuals in this model are normally distributed unlike in the linear specification.</p>
<p>Looking at the added variable plots, we can conclude that each predictor appears to have a unique contribution to explaining the variance in the dependent variable.</p>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="r-markdown.html#cb851-1" tabindex="-1"></a><span class="co"># Non-linear relationships</span></span>
<span id="cb851-2"><a href="r-markdown.html#cb851-2" tabindex="-1"></a><span class="fu">avPlots</span>(log_reg, <span class="at">col.lines =</span> <span class="fu">palette</span>()[<span class="dv">2</span>])</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>And finally, we check for multicollinearity,</p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="r-markdown.html#cb852-1" tabindex="-1"></a><span class="co"># Multicollinearity</span></span>
<span id="cb852-2"><a href="r-markdown.html#cb852-2" tabindex="-1"></a></span>
<span id="cb852-3"><a href="r-markdown.html#cb852-3" tabindex="-1"></a><span class="fu">vif</span>(log_reg)</span></code></pre></div>
<pre><code>##                 log(Price) log(MarketingContribution) 
##                   1.002559                   1.000478 
##             log(SalesReps)        log(RetailMediaPOS) 
##                   1.002574                   1.002015</code></pre>
<p>Here, all vif values are well below the cutoff, indicating that there are no problems with multicollinearity.</p>
<p>All assumption are met for the multiplicative model, log-log transformed model represents our data well, so we can proceed with the interpretation.</p>
</div>
<div id="question-5-1" class="section level3 hasAnchor" number="8.4.8">
<h3><span class="header-section-number">8.4.8</span> Question 5<a href="r-markdown.html#question-5-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a next step, we will investigate the results from the model.</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="r-markdown.html#cb854-1" tabindex="-1"></a><span class="fu">summary</span>(log_reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Sales) ~ log(Price) + log(MarketingContribution) + 
##     log(SalesReps) + log(RetailMediaPOS), data = sales_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.31586 -0.07091 -0.00092  0.06816  0.32443 
## 
## Coefficients:
##                             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)                 6.475026   0.213041   30.39 &lt;0.0000000000000002 ***
## log(Price)                 -1.304723   0.031844  -40.97 &lt;0.0000000000000002 ***
## log(MarketingContribution)  0.302317   0.006875   43.98 &lt;0.0000000000000002 ***
## log(SalesReps)              0.248789   0.006984   35.62 &lt;0.0000000000000002 ***
## log(RetailMediaPOS)         0.154664   0.006114   25.30 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1018 on 1455 degrees of freedom
## Multiple R-squared:  0.8009, Adjusted R-squared:  0.8004 
## F-statistic:  1464 on 4 and 1455 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>The intercept tells us the amount of sales if all the marketing expenditures would be 0. The following variables have a significant influence on sales because for them the p-value is &lt;0.05: log(Price), log(MarketingContribution), log(SalesReps), log(RetailMediaPOS).</p>
<p>The interpretation of the coefficients is as follows:
- A 1% increase in the sales price of the product leads to 1.3% decrease in sales holding other predictors constant.
- A 1% increase in promotion costs for including the product in leaflets distributed by the store leads to 0.3% increase in sales holding other predictors constant.
- A 1% increase in expenditures on in-store promotions managed by the sales reps leads to 0.25% increase in sales holding other predictors constant.
- A 1% increase in advertising expenses for marketing placements at POS leads to 0.15% increase in sales holding other predictors constant.</p>
<p>We should always provide a measure of uncertainty that is associated with the estimates. You could compute the confidence intervals around the coefficients using the confint() function.</p>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="r-markdown.html#cb856-1" tabindex="-1"></a><span class="fu">confint</span>(log_reg)</span></code></pre></div>
<pre><code>##                                 2.5 %     97.5 %
## (Intercept)                 6.0571256  6.8929263
## log(Price)                 -1.3671878 -1.2422587
## log(MarketingContribution)  0.2888318  0.3158021
## log(SalesReps)              0.2350898  0.2624880
## log(RetailMediaPOS)         0.1426709  0.1666564</code></pre>
<p>The results show that, for instance, with 95% confidence the true effect of the marketing contributions lies between 0.29 and 0.32.</p>
<p>Although the variables are measured on the same scale, you should still test the relative influence by inspecting the standardized coefficients that express the effects in terms of standard deviations.</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="r-markdown.html#cb858-1" tabindex="-1"></a><span class="fu">lm.beta</span>(log_reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Sales) ~ log(Price) + log(MarketingContribution) + 
##     log(SalesReps) + log(RetailMediaPOS), data = sales_data)
## 
## Standardized Coefficients::
##                (Intercept)                 log(Price) 
##                         NA                 -0.4798452 
## log(MarketingContribution)             log(SalesReps) 
##                  0.5144836                  0.4172141 
##        log(RetailMediaPOS) 
##                  0.2961886</code></pre>
<p>Here, we conclude that marketing contribution has the largest ROI followed by price (negative effect) and costs on sales reps.</p>
<p>Another significance test is the F-test. It tests the null hypothesis: H0:R-squared=0</p>
<p>This is equivalent to the following null hypothesis: H0:β1=β2=β3=βk=0</p>
<p>The result of the test is provided in the output above (F-statistic: 1464 on 4 and 1455 DF, p-value: &lt;0,05). Since the p-value is smaller than 0.05, we reject the null hypothesis that all coefficients are zero.</p>
<p>Regarding the model fit, the R2 statistic tells us that approximately 80% of the variance can be explained by the model.</p>
<p>The results of the model and model fit can be also visualized with the following plots:</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="r-markdown.html#cb860-1" tabindex="-1"></a><span class="fu">ggcoefstats</span>(<span class="at">x =</span> log_reg, <span class="at">k =</span> <span class="dv">3</span>, <span class="at">title =</span> <span class="st">&quot;Sales predicted by marketing expenditures&quot;</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="r-markdown.html#cb861-1" tabindex="-1"></a><span class="co"># Create the predictions (yhat) from the log-log model</span></span>
<span id="cb861-2"><a href="r-markdown.html#cb861-2" tabindex="-1"></a>sales_data<span class="sc">$</span>yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(log_reg)</span>
<span id="cb861-3"><a href="r-markdown.html#cb861-3" tabindex="-1"></a></span>
<span id="cb861-4"><a href="r-markdown.html#cb861-4" tabindex="-1"></a><span class="co"># Create a scatter plot of predicted vs. observed log(Sales)</span></span>
<span id="cb861-5"><a href="r-markdown.html#cb861-5" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> yhat, <span class="at">y =</span> <span class="fu">log</span>(Sales))) <span class="sc">+</span>  </span>
<span id="cb861-6"><a href="r-markdown.html#cb861-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># scatter plot of predicted vs observed log(Sales)</span></span>
<span id="cb861-7"><a href="r-markdown.html#cb861-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Predicted log(Sales)&quot;</span>) <span class="sc">+</span>  <span class="co"># label for the x-axis</span></span>
<span id="cb861-8"><a href="r-markdown.html#cb861-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Observed log(Sales)&quot;</span>) <span class="sc">+</span>  <span class="co"># label for the y-axis</span></span>
<span id="cb861-9"><a href="r-markdown.html#cb861-9" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span>  <span class="co"># identity line (45-degree)</span></span>
<span id="cb861-10"><a href="r-markdown.html#cb861-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># minimal theme</span></span>
<span id="cb861-11"><a href="r-markdown.html#cb861-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Predicted vs. Observed log(Sales) - Log-Log Model&quot;</span>)  <span class="co"># add title</span></span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
</div>
<div id="question-6-1" class="section level3 hasAnchor" number="8.4.9">
<h3><span class="header-section-number">8.4.9</span> Question 6<a href="r-markdown.html#question-6-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Provide a description of your steps here! Below is a template for your equation:</p>
<p><span class="math display">\[log(Sales) = \beta_0 + \beta_1*log(Price)+ \beta_2*log(MarketingContribution)+\beta_3*log(SalesReps)+\beta_4*log(RetailMediaPOS)\]</span></p>
<p><span class="math display">\[log(Sales) = 6.474 + (-1.305)*log(350)+0.302*log(10000)+0.249*log(6000)+0.155+log(3000) \]</span></p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="r-markdown.html#cb862-1" tabindex="-1"></a>Price <span class="ot">&lt;-</span> <span class="dv">350</span></span>
<span id="cb862-2"><a href="r-markdown.html#cb862-2" tabindex="-1"></a>MarketingContribution <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb862-3"><a href="r-markdown.html#cb862-3" tabindex="-1"></a>SalesReps <span class="ot">&lt;-</span> <span class="dv">6000</span></span>
<span id="cb862-4"><a href="r-markdown.html#cb862-4" tabindex="-1"></a>RetailMediaPOS <span class="ot">&lt;-</span> <span class="dv">3000</span></span>
<span id="cb862-5"><a href="r-markdown.html#cb862-5" tabindex="-1"></a></span>
<span id="cb862-6"><a href="r-markdown.html#cb862-6" tabindex="-1"></a><span class="co"># Get the coefficients from the model summary</span></span>
<span id="cb862-7"><a href="r-markdown.html#cb862-7" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fu">summary</span>(log_reg)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb862-8"><a href="r-markdown.html#cb862-8" tabindex="-1"></a>coef_log_Price <span class="ot">&lt;-</span> <span class="fu">summary</span>(log_reg)<span class="sc">$</span>coefficients[<span class="dv">2</span>,</span>
<span id="cb862-9"><a href="r-markdown.html#cb862-9" tabindex="-1"></a>    <span class="dv">1</span>]</span>
<span id="cb862-10"><a href="r-markdown.html#cb862-10" tabindex="-1"></a>coef_log_MarketingContribution <span class="ot">&lt;-</span> <span class="fu">summary</span>(log_reg)<span class="sc">$</span>coefficients[<span class="dv">3</span>,</span>
<span id="cb862-11"><a href="r-markdown.html#cb862-11" tabindex="-1"></a>    <span class="dv">1</span>]</span>
<span id="cb862-12"><a href="r-markdown.html#cb862-12" tabindex="-1"></a>coef_log_SalesReps <span class="ot">&lt;-</span> <span class="fu">summary</span>(log_reg)<span class="sc">$</span>coefficients[<span class="dv">4</span>,</span>
<span id="cb862-13"><a href="r-markdown.html#cb862-13" tabindex="-1"></a>    <span class="dv">1</span>]</span>
<span id="cb862-14"><a href="r-markdown.html#cb862-14" tabindex="-1"></a>coef_log_RetailMediaPOS <span class="ot">&lt;-</span> <span class="fu">summary</span>(log_reg)<span class="sc">$</span>coefficients[<span class="dv">5</span>,</span>
<span id="cb862-15"><a href="r-markdown.html#cb862-15" tabindex="-1"></a>    <span class="dv">1</span>]</span>
<span id="cb862-16"><a href="r-markdown.html#cb862-16" tabindex="-1"></a></span>
<span id="cb862-17"><a href="r-markdown.html#cb862-17" tabindex="-1"></a><span class="co"># Calculate the log(Sales) prediction using the</span></span>
<span id="cb862-18"><a href="r-markdown.html#cb862-18" tabindex="-1"></a><span class="co"># log-log model formula</span></span>
<span id="cb862-19"><a href="r-markdown.html#cb862-19" tabindex="-1"></a>log_sales_prediction <span class="ot">&lt;-</span> intercept <span class="sc">+</span> coef_log_Price <span class="sc">*</span></span>
<span id="cb862-20"><a href="r-markdown.html#cb862-20" tabindex="-1"></a>    <span class="fu">log</span>(Price) <span class="sc">+</span> coef_log_MarketingContribution <span class="sc">*</span> <span class="fu">log</span>(MarketingContribution) <span class="sc">+</span></span>
<span id="cb862-21"><a href="r-markdown.html#cb862-21" tabindex="-1"></a>    coef_log_SalesReps <span class="sc">*</span> <span class="fu">log</span>(SalesReps) <span class="sc">+</span> coef_log_RetailMediaPOS <span class="sc">*</span></span>
<span id="cb862-22"><a href="r-markdown.html#cb862-22" tabindex="-1"></a>    <span class="fu">log</span>(RetailMediaPOS)</span>
<span id="cb862-23"><a href="r-markdown.html#cb862-23" tabindex="-1"></a></span>
<span id="cb862-24"><a href="r-markdown.html#cb862-24" tabindex="-1"></a></span>
<span id="cb862-25"><a href="r-markdown.html#cb862-25" tabindex="-1"></a><span class="co"># Exponentiate to get the predicted sales</span></span>
<span id="cb862-26"><a href="r-markdown.html#cb862-26" tabindex="-1"></a>sales_prediction <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_sales_prediction)</span>
<span id="cb862-27"><a href="r-markdown.html#cb862-27" tabindex="-1"></a></span>
<span id="cb862-28"><a href="r-markdown.html#cb862-28" tabindex="-1"></a><span class="co"># Output the predicted sales</span></span>
<span id="cb862-29"><a href="r-markdown.html#cb862-29" tabindex="-1"></a>sales_prediction</span></code></pre></div>
<pre><code>## [1] 151.2786</code></pre>
<p>The predicted sales with the given marketing expenditures are 151 units.</p>
</div>
<div id="question-7-1" class="section level3 hasAnchor" number="8.4.10">
<h3><span class="header-section-number">8.4.10</span> Question 7<a href="r-markdown.html#question-7-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First we visualize the relationship between the 3 variables and then formally test the effect in the model.</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="r-markdown.html#cb864-1" tabindex="-1"></a><span class="co">#boxplots of sales by regions</span></span>
<span id="cb864-2"><a href="r-markdown.html#cb864-2" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> Region, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb864-3"><a href="r-markdown.html#cb864-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span>  <span class="co"># Fill and color matching scatter plot</span></span>
<span id="cb864-4"><a href="r-markdown.html#cb864-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sales by Region&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Region&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Sales&quot;</span>) <span class="sc">+</span></span>
<span id="cb864-5"><a href="r-markdown.html#cb864-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb864-6"><a href="r-markdown.html#cb864-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="r-markdown.html#cb865-1" tabindex="-1"></a><span class="co"># Transform data to log scale for the scatter plot</span></span>
<span id="cb865-2"><a href="r-markdown.html#cb865-2" tabindex="-1"></a>sales_data<span class="sc">$</span>log_Sales <span class="ot">&lt;-</span> <span class="fu">log</span>(sales_data<span class="sc">$</span>Sales)</span>
<span id="cb865-3"><a href="r-markdown.html#cb865-3" tabindex="-1"></a>sales_data<span class="sc">$</span>log_Price <span class="ot">&lt;-</span> <span class="fu">log</span>(sales_data<span class="sc">$</span>Price)</span>
<span id="cb865-4"><a href="r-markdown.html#cb865-4" tabindex="-1"></a></span>
<span id="cb865-5"><a href="r-markdown.html#cb865-5" tabindex="-1"></a><span class="co"># Create a scatter plot of log(Sales) vs log(Price) by Region</span></span>
<span id="cb865-6"><a href="r-markdown.html#cb865-6" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> log_Price, <span class="at">y =</span> log_Sales, <span class="at">color =</span> Region)) <span class="sc">+</span></span>
<span id="cb865-7"><a href="r-markdown.html#cb865-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span>   <span class="co"># Scatter points with some transparency</span></span>
<span id="cb865-8"><a href="r-markdown.html#cb865-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">color =</span> Region)) <span class="sc">+</span>  <span class="co"># Add regression lines</span></span>
<span id="cb865-9"><a href="r-markdown.html#cb865-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb865-10"><a href="r-markdown.html#cb865-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Log-Log Relationship Between Sales and Price by Region&quot;</span>,</span>
<span id="cb865-11"><a href="r-markdown.html#cb865-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Log(Price)&quot;</span>,</span>
<span id="cb865-12"><a href="r-markdown.html#cb865-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Log(Sales)&quot;</span>,</span>
<span id="cb865-13"><a href="r-markdown.html#cb865-13" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Region&quot;</span></span>
<span id="cb865-14"><a href="r-markdown.html#cb865-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb865-15"><a href="r-markdown.html#cb865-15" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb865-16"><a href="r-markdown.html#cb865-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
<p>From the inspection of the plot, we can already see that there are only very slight differences in price sensitivity between regions. We can see the more exact result in the model.</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="r-markdown.html#cb867-1" tabindex="-1"></a>log_reg_with_region <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Sales) <span class="sc">~</span> <span class="fu">log</span>(Price) <span class="sc">+</span></span>
<span id="cb867-2"><a href="r-markdown.html#cb867-2" tabindex="-1"></a>    <span class="fu">log</span>(MarketingContribution) <span class="sc">+</span> <span class="fu">log</span>(SalesReps) <span class="sc">+</span> <span class="fu">log</span>(RetailMediaPOS) <span class="sc">+</span></span>
<span id="cb867-3"><a href="r-markdown.html#cb867-3" tabindex="-1"></a>    Region <span class="sc">+</span> <span class="fu">log</span>(Price) <span class="sc">*</span> Region, <span class="at">data =</span> sales_data)</span>
<span id="cb867-4"><a href="r-markdown.html#cb867-4" tabindex="-1"></a></span>
<span id="cb867-5"><a href="r-markdown.html#cb867-5" tabindex="-1"></a><span class="fu">summary</span>(log_reg_with_region)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Sales) ~ log(Price) + log(MarketingContribution) + 
##     log(SalesReps) + log(RetailMediaPOS) + Region + log(Price) * 
##     Region, data = sales_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.31230 -0.07264  0.00052  0.06944  0.31913 
## 
## Coefficients:
##                             Estimate Std. Error t value             Pr(&gt;|t|)
## (Intercept)                 5.677941   0.342629  16.572 &lt; 0.0000000000000002
## log(Price)                 -1.166913   0.056300 -20.727 &lt; 0.0000000000000002
## log(MarketingContribution)  0.301407   0.006879  43.813 &lt; 0.0000000000000002
## log(SalesReps)              0.248714   0.006978  35.645 &lt; 0.0000000000000002
## log(RetailMediaPOS)         0.154474   0.006108  25.292 &lt; 0.0000000000000002
## RegionSuburban              1.092507   0.450905   2.423              0.01552
## RegionUrban                 1.289724   0.467221   2.760              0.00585
## log(Price):RegionSuburban  -0.186507   0.077056  -2.420              0.01563
## log(Price):RegionUrban     -0.220242   0.079819  -2.759              0.00587
##                               
## (Intercept)                ***
## log(Price)                 ***
## log(MarketingContribution) ***
## log(SalesReps)             ***
## log(RetailMediaPOS)        ***
## RegionSuburban             *  
## RegionUrban                ** 
## log(Price):RegionSuburban  *  
## log(Price):RegionUrban     ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1016 on 1451 degrees of freedom
## Multiple R-squared:  0.8022, Adjusted R-squared:  0.8011 
## F-statistic: 735.5 on 8 and 1451 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>From inspecting the model, we can conclude that region indeed has an effect on price sensitivity.</p>
<p>The coefficient for RegionSuburban indicates that in the Suburban region the sales are expected to be 1.09% higher than in the Rural region. This effect is significant (p&lt;0.05). Similarly, for the RegionUrban sales are expected to be 1.29% higher than in the Rural region, and this effect is also statistically significant (p&lt;0.05).</p>
<p>The interaction effect: The coefficient log(Price) of -1.167 demonstrates the base price sensitivity in the rural region. This means that in the rural region a 1% increase in price will lead to a 1.167% decrease in sales. In the suburban region, customers are more price sensitive by 0.187. This means that a 1% increase in price will lead to (-1.167-0.187=) 1.354% decrease in sales. In urban region, people are the most price sensitive, by 0.22 more than in the rural region. A 1% increase in price will lead to (-1.167-0.22 =) 1.387% decrease in sales.</p>
<p>This result could indicate that in urban areas consumers have access to more alternatives and hence, react stronger to price changes.</p>
</div>
<div id="assignment-b" class="section level3 hasAnchor" number="8.4.11">
<h3><span class="header-section-number">8.4.11</span> Assignment B<a href="r-markdown.html#assignment-b" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As a marketing manager of a music streaming service, you are set the task to derive insights from data using different quantitative analyses.</p>
<p>The following variables are available to you:</p>
<p>The data set contains the following variables:</p>
<ul>
<li>isrc = unique song id</li>
<li>artist_id = unique artist ID</li>
<li>streams = the number of streams of the song received globally between 2017-2021</li>
<li>weeks_in_charts = the number of weeks the song was in the top200 charts in this period</li>
<li>n_regions = the number of markets where the song appeared in the top200 charts</li>
<li>danceability</li>
<li>energy</li>
<li>speechiness</li>
<li>instrumentalness</li>
<li>liveness</li>
<li>valence</li>
<li>tempo</li>
<li>song_length = the duration of the song (in minutes)</li>
<li>song_age = the age of the song (in weeks since release)</li>
<li>explicit = indicator for explicit lyrics</li>
<li>n_playlists = number of playlists a song is featured on</li>
<li>sp_popularity = the Spotify popularity index of an artist</li>
<li>youtube_views = the number of views the song received on YouTube</li>
<li>tiktok_counts = the number of Tiktok views the song received on TikTok</li>
<li>ins_followers_artist = the number of Instagram followers of the artist</li>
<li>monthly_listeners_artist = the number of monthly listeners of an artist</li>
<li>playlist_total_reach_artist = the number of playlist followers of the playlists the song is on</li>
<li>sp_fans_artist = the number of fans of the artist on Spotify</li>
<li>shazam_counts = the number of times a song is shazamed</li>
<li>artistName = name of the artist</li>
<li>trackName = name of the song</li>
<li>release_date = release date of song</li>
<li>genre = genre associated with the song</li>
<li>label = music label associated with the song</li>
<li>top10 = indicator variable, indicating if a song made it to the top10</li>
</ul>
<ol style="list-style-type: decimal">
<li>Build and estimate a classification model (i.e., logistic regression) to explain the success of songs in terms of the chart position (i.e., if a song made it to the top 10 or not). This means, the variable “top10”” is your dependent variable. As independent (explanatory) variables, you should include the variables “weeks_in_charts”, “song_age” and “label”. In addition to these 3 variables you should identify 5 more variables that have a significant effect on the chart performance. Please visualize the relationship between the top10 variable and the independent variables using appropriate plots and interpret the model coefficients.</li>
</ol>
</div>
<div id="data-analysis-5" class="section level3 hasAnchor" number="8.4.12">
<h3><span class="header-section-number">8.4.12</span> Data analysis<a href="r-markdown.html#data-analysis-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="load-data-5" class="section level3 hasAnchor" number="8.4.13">
<h3><span class="header-section-number">8.4.13</span> Load data<a href="r-markdown.html#load-data-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="r-markdown.html#cb869-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb869-2"><a href="r-markdown.html#cb869-2" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb869-3"><a href="r-markdown.html#cb869-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb869-4"><a href="r-markdown.html#cb869-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb869-5"><a href="r-markdown.html#cb869-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb869-6"><a href="r-markdown.html#cb869-6" tabindex="-1"></a>music_data <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;https://raw.githubusercontent.com/WU-RDS/RMA2022/main/data/music_data_group.csv&quot;</span>,</span>
<span id="cb869-7"><a href="r-markdown.html#cb869-7" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">dec =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb869-8"><a href="r-markdown.html#cb869-8" tabindex="-1"></a>music_data<span class="sc">$</span>genre <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(music_data<span class="sc">$</span>genre)</span>
<span id="cb869-9"><a href="r-markdown.html#cb869-9" tabindex="-1"></a>music_data<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(music_data<span class="sc">$</span>label)</span>
<span id="cb869-10"><a href="r-markdown.html#cb869-10" tabindex="-1"></a><span class="fu">str</span>(music_data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    66796 obs. of  30 variables:
##  $ isrc                       : chr  &quot;BRRGE1603547&quot; &quot;USUM71808193&quot; &quot;ES5701800181&quot; &quot;ITRSE2000050&quot; ...
##  $ artist_id                  : int  3679 5239 776407 433730 526471 1939 210184 212546 4938 119985 ...
##  $ streams                    : num  11944813 8934097 38835 46766 2930573 ...
##  $ weeks_in_charts            : int  141 51 1 1 7 226 13 1 64 7 ...
##  $ n_regions                  : int  1 21 1 1 4 8 1 1 5 1 ...
##  $ danceability               : num  50.9 35.3 68.3 70.4 84.2 35.2 73 55.6 71.9 34.6 ...
##  $ energy                     : num  80.3 75.5 67.6 56.8 57.8 91.1 69.6 24.5 85 43.3 ...
##  $ speechiness                : num  4 73.3 14.7 26.8 13.8 7.47 35.5 3.05 3.17 6.5 ...
##  $ instrumentalness           : num  0.05 0 0 0.000253 0 0 0 0 0.02 0 ...
##  $ liveness                   : num  46.3 39 7.26 8.91 22.8 9.95 32.1 9.21 11.4 10.1 ...
##  $ valence                    : num  65.1 43.7 43.4 49.5 19 23.6 58.4 27.6 36.7 76.8 ...
##  $ tempo                      : num  166 191.2 99 91 74.5 ...
##  $ song_length                : num  3.12 3.23 3.02 3.45 3.95 ...
##  $ song_age                   : num  228.3 144.3 112.3 50.7 58.3 ...
##  $ explicit                   : int  0 0 0 0 0 0 0 0 1 0 ...
##  $ n_playlists                : int  450 768 48 6 475 20591 6 105 547 688 ...
##  $ sp_popularity              : int  51 54 32 44 52 81 44 8 59 68 ...
##  $ youtube_views              : num  145030723 13188411 6116639 0 0 ...
##  $ tiktok_counts              : int  9740 358700 0 13 515 67300 0 0 653 3807 ...
##  $ ins_followers_artist       : int  29613108 3693566 623778 81601 11962358 1169284 1948850 39381 9751080 343 ...
##  $ monthly_listeners_artist   : int  4133393 18367363 888273 143761 15551876 16224250 2683086 1318874 4828847 3088232 ...
##  $ playlist_total_reach_artist: int  24286416 143384531 4846378 156521 90841884 80408253 7332603 24302331 8914977 8885252 ...
##  $ sp_fans_artist             : int  3308630 465412 23846 1294 380204 1651866 214001 10742 435457 1897685 ...
##  $ shazam_counts              : int  73100 588550 0 0 55482 5281161 0 0 39055 0 ...
##  $ artistName                 : chr  &quot;Luan Santana&quot; &quot;Alessia Cara&quot; &quot;Ana Guerra&quot; &quot;Claver Gold feat. Murubutu&quot; ...
##  $ trackName                  : chr  &quot;Eu, Você, O Mar e Ela&quot; &quot;Growing Pains&quot; &quot;El Remedio&quot; &quot;Ulisse&quot; ...
##  $ release_date               : chr  &quot;2016-06-20&quot; &quot;2018-06-14&quot; &quot;2018-04-26&quot; &quot;2020-03-31&quot; ...
##  $ genre                      : Factor w/ 11 levels &quot;Classics/Jazz&quot;,..: 6 7 7 5 5 10 5 7 7 7 ...
##  $ label                      : Factor w/ 4 levels &quot;Independent&quot;,..: 1 3 3 1 3 3 3 1 1 3 ...
##  $ top10                      : int  1 0 0 0 0 1 0 0 0 0 ...</code></pre>
</div>
<div id="question-1-2" class="section level3 hasAnchor" number="8.4.14">
<h3><span class="header-section-number">8.4.14</span> Question 1<a href="r-markdown.html#question-1-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this model, we need to consider the logistic function, so the final mathematical representation (with three main predictors of interest so far) would look as follows:</p>
<p><span class="math display">\[f(\mathbf{X}) = P(y_i = 1) = \frac{1}{1
+ e^{-(\beta_0 + \beta_1 * x_{1,i} + \beta_2 * x_{2,i} +\beta_3 *
x_{3,i})}}\]</span></p>
<p>where β0 is the intercept coefficient, and β1, β2, and β3represent the parameters of our model: weeks in charts, age of song, and label.</p>
<p>We should create the model using glm() and have a look at the summary</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="r-markdown.html#cb871-1" tabindex="-1"></a>mult_logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(top10 <span class="sc">~</span> weeks_in_charts <span class="sc">+</span> song_age <span class="sc">+</span></span>
<span id="cb871-2"><a href="r-markdown.html#cb871-2" tabindex="-1"></a>    label, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>), <span class="at">data =</span> music_data)</span>
<span id="cb871-3"><a href="r-markdown.html#cb871-3" tabindex="-1"></a><span class="fu">summary</span>(mult_logit_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = top10 ~ weeks_in_charts + song_age + label, family = binomial(link = &quot;logit&quot;), 
##     data = music_data)
## 
## Coefficients:
##                         Estimate  Std. Error z value            Pr(&gt;|z|)    
## (Intercept)          -3.78534560  0.03989841  -94.88 &lt;0.0000000000000002 ***
## weeks_in_charts       0.01254730  0.00013573   92.45 &lt;0.0000000000000002 ***
## song_age             -0.00122201  0.00009152  -13.35 &lt;0.0000000000000002 ***
## labelSony Music       0.59344756  0.04967676   11.95 &lt;0.0000000000000002 ***
## labelUniversal Music  0.86912676  0.04284308   20.29 &lt;0.0000000000000002 ***
## labelWarner Music     0.52810825  0.05383487    9.81 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43430  on 66795  degrees of freedom
## Residual deviance: 27523  on 66790  degrees of freedom
## AIC: 27535
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="r-markdown.html#cb873-1" tabindex="-1"></a><span class="fu">confint</span>(mult_logit_model)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                             2.5 %       97.5 %
## (Intercept)          -3.864138137 -3.707725224
## weeks_in_charts       0.012282716  0.012814786
## song_age             -0.001404812 -0.001046036
## labelSony Music       0.496029832  0.690783386
## labelUniversal Music  0.785399531  0.953358727
## labelWarner Music     0.422364414  0.633423323</code></pre>
<p>From the summary of the model we can see that weeks in charts, age of song, and label can be used to predict if a song will end up in top-10 or not. We can also assess the model fit:</p>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="r-markdown.html#cb876-1" tabindex="-1"></a>logisticPseudoR2s <span class="ot">&lt;-</span> <span class="cf">function</span>(LogModel) {</span>
<span id="cb876-2"><a href="r-markdown.html#cb876-2" tabindex="-1"></a>    dev <span class="ot">&lt;-</span> LogModel<span class="sc">$</span>deviance</span>
<span id="cb876-3"><a href="r-markdown.html#cb876-3" tabindex="-1"></a>    nullDev <span class="ot">&lt;-</span> LogModel<span class="sc">$</span>null.deviance</span>
<span id="cb876-4"><a href="r-markdown.html#cb876-4" tabindex="-1"></a>    modelN <span class="ot">&lt;-</span> <span class="fu">length</span>(LogModel<span class="sc">$</span>fitted.values)</span>
<span id="cb876-5"><a href="r-markdown.html#cb876-5" tabindex="-1"></a>    R.l <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> dev<span class="sc">/</span>nullDev</span>
<span id="cb876-6"><a href="r-markdown.html#cb876-6" tabindex="-1"></a>    R.cs <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(nullDev <span class="sc">-</span> dev)<span class="sc">/</span>modelN)</span>
<span id="cb876-7"><a href="r-markdown.html#cb876-7" tabindex="-1"></a>    R.n <span class="ot">&lt;-</span> R.cs<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fu">exp</span>(<span class="sc">-</span>(nullDev<span class="sc">/</span>modelN))))</span>
<span id="cb876-8"><a href="r-markdown.html#cb876-8" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Pseudo R^2 for logistic regression</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb876-9"><a href="r-markdown.html#cb876-9" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Hosmer and Lemeshow R^2  &quot;</span>, <span class="fu">round</span>(R.l, <span class="dv">3</span>),</span>
<span id="cb876-10"><a href="r-markdown.html#cb876-10" tabindex="-1"></a>        <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb876-11"><a href="r-markdown.html#cb876-11" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Cox and Snell R^2        &quot;</span>, <span class="fu">round</span>(R.cs, <span class="dv">3</span>),</span>
<span id="cb876-12"><a href="r-markdown.html#cb876-12" tabindex="-1"></a>        <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb876-13"><a href="r-markdown.html#cb876-13" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Nagelkerke R^2           &quot;</span>, <span class="fu">round</span>(R.n, <span class="dv">3</span>),</span>
<span id="cb876-14"><a href="r-markdown.html#cb876-14" tabindex="-1"></a>        <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb876-15"><a href="r-markdown.html#cb876-15" tabindex="-1"></a>}</span>
<span id="cb876-16"><a href="r-markdown.html#cb876-16" tabindex="-1"></a><span class="co"># Inspect Pseudo R2s</span></span>
<span id="cb876-17"><a href="r-markdown.html#cb876-17" tabindex="-1"></a><span class="fu">logisticPseudoR2s</span>(mult_logit_model)</span></code></pre></div>
<pre><code>## Pseudo R^2 for logistic regression
## Hosmer and Lemeshow R^2   0.366 
## Cox and Snell R^2         0.212 
## Nagelkerke R^2            0.443</code></pre>
<p>To make conclusions about the effect that predictors have on success, we should convert the log-odds ratios to odds ratios using exp() function:</p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="r-markdown.html#cb878-1" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(mult_logit_model))</span></code></pre></div>
<pre><code>##          (Intercept)      weeks_in_charts             song_age 
##           0.02270102           1.01262635           0.99877873 
##      labelSony Music labelUniversal Music    labelWarner Music 
##           1.81021850           2.38482742           1.69572138</code></pre>
<p>The results tell us, for example, that for each extra week in charts, the odds of the song to be in the top 10 are 1.0126 times higher, or equivalently, the likelihood of the outcome is increased by 1.26%. Or songs from Universal are 2.38 times more likely to appear in the top-10 chart in comparison with songs from independent labels, or equivalently, the likelihood of the outcome is increased by 138.5% compared to independent labels.</p>
<p>We should visualize the relationship between IVs and DV:</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="r-markdown.html#cb880-1" tabindex="-1"></a><span class="co"># Relationship of weeks in charts and top10</span></span>
<span id="cb880-2"><a href="r-markdown.html#cb880-2" tabindex="-1"></a></span>
<span id="cb880-3"><a href="r-markdown.html#cb880-3" tabindex="-1"></a><span class="fu">ggplot</span>(music_data, <span class="fu">aes</span>(weeks_in_charts, top10)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb880-4"><a href="r-markdown.html#cb880-4" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>),</span>
<span id="cb880-5"><a href="r-markdown.html#cb880-5" tabindex="-1"></a>        <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="r-markdown.html#cb882-1" tabindex="-1"></a><span class="co"># Relationship of song age and top10</span></span>
<span id="cb882-2"><a href="r-markdown.html#cb882-2" tabindex="-1"></a></span>
<span id="cb882-3"><a href="r-markdown.html#cb882-3" tabindex="-1"></a><span class="fu">ggplot</span>(music_data, <span class="fu">aes</span>(song_age, top10)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb882-4"><a href="r-markdown.html#cb882-4" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>),</span>
<span id="cb882-5"><a href="r-markdown.html#cb882-5" tabindex="-1"></a>        <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="r-markdown.html#cb884-1" tabindex="-1"></a><span class="co"># Relationship of label and top10</span></span>
<span id="cb884-2"><a href="r-markdown.html#cb884-2" tabindex="-1"></a></span>
<span id="cb884-3"><a href="r-markdown.html#cb884-3" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb884-4"><a href="r-markdown.html#cb884-4" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&quot;Warner Music&quot;</span>, <span class="st">&quot;Sony Music&quot;</span>,</span>
<span id="cb884-5"><a href="r-markdown.html#cb884-5" tabindex="-1"></a>    <span class="st">&quot;Independent&quot;</span>, <span class="st">&quot;Universal Music&quot;</span>))</span>
<span id="cb884-6"><a href="r-markdown.html#cb884-6" tabindex="-1"></a>top10_predictions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pred =</span> <span class="fu">predict</span>(<span class="fu">glm</span>(top10 <span class="sc">~</span></span>
<span id="cb884-7"><a href="r-markdown.html#cb884-7" tabindex="-1"></a>    label, <span class="at">data =</span> music_data), <span class="fu">data.frame</span>(<span class="at">label =</span> labels),</span>
<span id="cb884-8"><a href="r-markdown.html#cb884-8" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>), <span class="at">label =</span> labels)</span>
<span id="cb884-9"><a href="r-markdown.html#cb884-9" tabindex="-1"></a>top10_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(music_data<span class="sc">$</span>top10, music_data<span class="sc">$</span>label)</span>
<span id="cb884-10"><a href="r-markdown.html#cb884-10" tabindex="-1"></a>top10_share <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(top10_counts, <span class="at">margin =</span> <span class="dv">2</span>)</span>
<span id="cb884-11"><a href="r-markdown.html#cb884-11" tabindex="-1"></a><span class="fu">data.frame</span>(top10_share) <span class="sc">|&gt;</span></span>
<span id="cb884-12"><a href="r-markdown.html#cb884-12" tabindex="-1"></a>    <span class="fu">filter</span>(Var1 <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb884-13"><a href="r-markdown.html#cb884-13" tabindex="-1"></a>    <span class="fu">left_join</span>(top10_predictions, <span class="at">by =</span> <span class="fu">c</span>(<span class="at">Var2 =</span> <span class="st">&quot;label&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb884-14"><a href="r-markdown.html#cb884-14" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">`</span><span class="at">Top 10 share</span><span class="st">`</span> <span class="ot">=</span> Freq) <span class="sc">|&gt;</span></span>
<span id="cb884-15"><a href="r-markdown.html#cb884-15" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Var2, <span class="st">`</span><span class="at">Top 10 share</span><span class="st">`</span>), <span class="st">`</span><span class="at">Top 10 share</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb884-16"><a href="r-markdown.html#cb884-16" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span></span>
<span id="cb884-17"><a href="r-markdown.html#cb884-17" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var2, <span class="at">y =</span> pred), <span class="at">color =</span> <span class="st">&quot;red4&quot;</span>) <span class="sc">+</span></span>
<span id="cb884-18"><a href="r-markdown.html#cb884-18" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>To find out which other variables might have a significant effect on the chart performance, we can either load variables one-by-one manually or use a step-wise approach. For the latter, we basically need a model to start with (usually it’s a “null” model, however, we already have a model that works for us, i.e., mult_logit_model) and the most loaded model that includes all the variables (we will only drop all character and date variables). Let’s create it in the next step (please note that we already drop some variables that potentially might be influenced if a song appears in top-10: streams, sp_popularity, n_regions, etc.)</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="r-markdown.html#cb885-1" tabindex="-1"></a>music_data<span class="sc">$</span>explicit <span class="ot">&lt;-</span> <span class="fu">factor</span>(music_data<span class="sc">$</span>explicit, </span>
<span id="cb885-2"><a href="r-markdown.html#cb885-2" tabindex="-1"></a>                                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;not explicit&quot;</span>, <span class="st">&quot;explicit&quot;</span>))</span>
<span id="cb885-3"><a href="r-markdown.html#cb885-3" tabindex="-1"></a></span>
<span id="cb885-4"><a href="r-markdown.html#cb885-4" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(top10 <span class="sc">~</span> weeks_in_charts <span class="sc">+</span> song_age <span class="sc">+</span> label <span class="sc">+</span> <span class="co">#our basic model. Next we add the rest of the variables to it:</span></span>
<span id="cb885-5"><a href="r-markdown.html#cb885-5" tabindex="-1"></a>                    danceability <span class="sc">+</span> energy <span class="sc">+</span> speechiness <span class="sc">+</span> instrumentalness <span class="sc">+</span> liveness <span class="sc">+</span> valence <span class="sc">+</span> tempo <span class="sc">+</span></span>
<span id="cb885-6"><a href="r-markdown.html#cb885-6" tabindex="-1"></a>                    song_length <span class="sc">+</span> explicit <span class="sc">+</span> n_playlists <span class="sc">+</span> genre,</span>
<span id="cb885-7"><a href="r-markdown.html#cb885-7" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&#39;logit&#39;</span>), <span class="at">data =</span> music_data)</span></code></pre></div>
<p>Let’s have a look at the fullest model possible:</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="r-markdown.html#cb886-1" tabindex="-1"></a><span class="fu">summary</span>(full_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = top10 ~ weeks_in_charts + song_age + label + danceability + 
##     energy + speechiness + instrumentalness + liveness + valence + 
##     tempo + song_length + explicit + n_playlists + genre, family = binomial(link = &quot;logit&quot;), 
##     data = music_data)
## 
## Coefficients:
##                          Estimate   Std. Error z value             Pr(&gt;|z|)    
## (Intercept)          -8.234476683  6.600555763  -1.248               0.2122    
## weeks_in_charts       0.012805679  0.000146602  87.350 &lt; 0.0000000000000002 ***
## song_age             -0.001926650  0.000114801 -16.783 &lt; 0.0000000000000002 ***
## labelSony Music       0.309879886  0.053399277   5.803        0.00000000651 ***
## labelUniversal Music  0.499093803  0.048106669  10.375 &lt; 0.0000000000000002 ***
## labelWarner Music     0.258651532  0.057686712   4.484        0.00000733501 ***
## danceability          0.013853338  0.001511801   9.163 &lt; 0.0000000000000002 ***
## energy               -0.005334606  0.001202794  -4.435        0.00000919959 ***
## speechiness          -0.003606707  0.001622321  -2.223               0.0262 *  
## instrumentalness     -0.002757251  0.002982653  -0.924               0.3553    
## liveness              0.005200933  0.001189734   4.372        0.00001233918 ***
## valence               0.001499900  0.000934395   1.605               0.1084    
## tempo                 0.002969109  0.000619852   4.790        0.00000166755 ***
## song_length          -0.290130550  0.026500912 -10.948 &lt; 0.0000000000000002 ***
## explicitexplicit     -0.704911363  0.073710237  -9.563 &lt; 0.0000000000000002 ***
## n_playlists           0.000268906  0.000008005  33.593 &lt; 0.0000000000000002 ***
## genreCountry          6.047536675  6.599669764   0.916               0.3595    
## genreElectro/Dance    4.619610060  6.598946035   0.700               0.4839    
## genreGerman Folk      3.391558357  6.604926105   0.513               0.6076    
## genreHipHop/Rap       4.562287429  6.598559475   0.691               0.4893    
## genreother            5.425089472  6.598558812   0.822               0.4110    
## genrePop              4.004199096  6.598387935   0.607               0.5440    
## genreR&amp;B              5.016578570  6.598943542   0.760               0.4471    
## genreReggae           4.454352459  6.610053417   0.674               0.5004    
## genreRock             4.145180994  6.598981122   0.628               0.5299    
## genreSoundtrack       4.901752648  6.601845142   0.742               0.4578    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43430  on 66795  degrees of freedom
## Residual deviance: 24891  on 66770  degrees of freedom
## AIC: 24943
## 
## Number of Fisher Scoring iterations: 9</code></pre>
<p>We can pick five significant factors from the summary above. For example, we can proceed with the model as follows:</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="r-markdown.html#cb888-1" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(top10 <span class="sc">~</span> weeks_in_charts <span class="sc">+</span> song_age <span class="sc">+</span> label <span class="sc">+</span> <span class="co">#our basic model. Next we add the rest of the variables to it:</span></span>
<span id="cb888-2"><a href="r-markdown.html#cb888-2" tabindex="-1"></a>                   danceability <span class="sc">+</span> liveness <span class="sc">+</span> tempo <span class="sc">+</span> song_length <span class="sc">+</span> n_playlists,</span>
<span id="cb888-3"><a href="r-markdown.html#cb888-3" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&#39;logit&#39;</span>), <span class="at">data =</span> music_data)</span>
<span id="cb888-4"><a href="r-markdown.html#cb888-4" tabindex="-1"></a></span>
<span id="cb888-5"><a href="r-markdown.html#cb888-5" tabindex="-1"></a><span class="fu">summary</span>(final_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = top10 ~ weeks_in_charts + song_age + label + danceability + 
##     liveness + tempo + song_length + n_playlists, family = binomial(link = &quot;logit&quot;), 
##     data = music_data)
## 
## Coefficients:
##                          Estimate   Std. Error z value             Pr(&gt;|z|)    
## (Intercept)          -4.490099261  0.172198935 -26.075 &lt; 0.0000000000000002 ***
## weeks_in_charts       0.012594243  0.000141167  89.215 &lt; 0.0000000000000002 ***
## song_age             -0.001977611  0.000117389 -16.847 &lt; 0.0000000000000002 ***
## labelSony Music       0.441955048  0.050888299   8.685 &lt; 0.0000000000000002 ***
## labelUniversal Music  0.624039605  0.044146953  14.136 &lt; 0.0000000000000002 ***
## labelWarner Music     0.376806825  0.055148947   6.833   0.0000000000083430 ***
## danceability          0.017307850  0.001345825  12.860 &lt; 0.0000000000000002 ***
## liveness              0.008612684  0.001138928   7.562   0.0000000000000397 ***
## tempo                 0.003637005  0.000610442   5.958   0.0000000025536638 ***
## song_length          -0.315709255  0.025965257 -12.159 &lt; 0.0000000000000002 ***
## n_playlists           0.000260104  0.000007804  33.330 &lt; 0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43430  on 66795  degrees of freedom
## Residual deviance: 25856  on 66785  degrees of freedom
## AIC: 25878
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="r-markdown.html#cb890-1" tabindex="-1"></a><span class="fu">logisticPseudoR2s</span>(final_model)</span></code></pre></div>
<pre><code>## Pseudo R^2 for logistic regression
## Hosmer and Lemeshow R^2   0.405 
## Cox and Snell R^2         0.231 
## Nagelkerke R^2            0.484</code></pre>
<p>We can see from the table above that the model explains 50% of the variability in the likelihood of the song being in top 10 (according to Nagelkerke R-squared).</p>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="r-markdown.html#cb892-1" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(final_model))</span></code></pre></div>
<pre><code>##          (Intercept)      weeks_in_charts             song_age 
##           0.01121953           1.01267388           0.99802434 
##      labelSony Music labelUniversal Music    labelWarner Music 
##           1.55574581           1.86645257           1.45762271 
##         danceability             liveness                tempo 
##           1.01745850           1.00864988           1.00364363 
##          song_length          n_playlists 
##           0.72927145           1.00026014</code></pre>
<p>Interpretation: The results tell us, for example, that for each one minute increase in song length, the odds of the song to be in the top 10 are 0.73 times lower, or equivalently, the likelihood of the song to be in top 10 is decreased by 27%. For each one unit increase in danceability, the odds of the song to be in top 10 are 1.02 times higher, or equivalently, the likelihood of the song being in top 10 is increased by 2%.</p>
<p>Alternatively, average partial effect as means of model interpretation can be used:</p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="r-markdown.html#cb894-1" tabindex="-1"></a><span class="fu">library</span>(mfx)</span></code></pre></div>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: betareg</code></pre>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="r-markdown.html#cb898-1" tabindex="-1"></a><span class="co"># Average partial effect</span></span>
<span id="cb898-2"><a href="r-markdown.html#cb898-2" tabindex="-1"></a><span class="fu">logitmfx</span>(final_model, <span class="at">data =</span> music_data, <span class="at">atmean =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Call:
## logitmfx(formula = final_model, data = music_data, atmean = FALSE)
## 
## Marginal Effects:
##                               dF/dx      Std. Err.        z
## weeks_in_charts       0.00065127618  0.00001374186  47.3936
## song_age             -0.00010226667  0.00000631172 -16.2027
## labelSony Music       0.02493232144  0.00312422560   7.9803
## labelUniversal Music  0.03427289513  0.00257631776  13.3031
## labelWarner Music     0.02113194448  0.00334627810   6.3151
## danceability          0.00089502724  0.00007104537  12.5980
## liveness              0.00044538097  0.00005937804   7.5008
## tempo                 0.00018807759  0.00003171436   5.9304
## song_length          -0.01632602458  0.00136992030 -11.9175
## n_playlists           0.00001345055  0.00000046827  28.7241
##                                      P&gt;|z|    
## weeks_in_charts      &lt; 0.00000000000000022 ***
## song_age             &lt; 0.00000000000000022 ***
## labelSony Music        0.00000000000000146 ***
## labelUniversal Music &lt; 0.00000000000000022 ***
## labelWarner Music      0.00000000027005798 ***
## danceability         &lt; 0.00000000000000022 ***
## liveness               0.00000000000006344 ***
## tempo                  0.00000000302271850 ***
## song_length          &lt; 0.00000000000000022 ***
## n_playlists          &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## dF/dx is for discrete change for the following variables:
## 
## [1] &quot;labelSony Music&quot;      &quot;labelUniversal Music&quot; &quot;labelWarner Music&quot;</code></pre>
<p>Interpretation of average partial effects: If a song is one week older, the probability of this song appearing in top-10 chart decreases by 0.01 percentage points.</p>
<p>If we still want to choose a parsimonious model using step-wise comparisons, we can do it as follows: the function below takes the “base” model, adds variables from the fullest model one-by-one to it, and shows the new models’ performance.</p>
<p>AIC values can be compared, we want the model with lowest possible AIC. As a second measure for variable selection, we can use the pseudo R-squared, that gives a value for explanatory power of the model.</p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="r-markdown.html#cb900-1" tabindex="-1"></a><span class="fu">step</span>(mult_logit_model, <span class="co">#our base model</span></span>
<span id="cb900-2"><a href="r-markdown.html#cb900-2" tabindex="-1"></a>     <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> full_model), </span>
<span id="cb900-3"><a href="r-markdown.html#cb900-3" tabindex="-1"></a>     <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb900-4"><a href="r-markdown.html#cb900-4" tabindex="-1"></a>     <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>,</span>
<span id="cb900-5"><a href="r-markdown.html#cb900-5" tabindex="-1"></a>     <span class="at">data =</span> music_data)</span></code></pre></div>
<pre><code>## Start:  AIC=27535.11
## top10 ~ weeks_in_charts + song_age + label
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## + n_playlists       1    26335 26349  1187.9 &lt; 0.00000000000000022 ***
## + genre            10    26504 26536  1019.5 &lt; 0.00000000000000022 ***
## + danceability      1    27256 27270   267.1 &lt; 0.00000000000000022 ***
## + song_length       1    27335 27349   187.9 &lt; 0.00000000000000022 ***
## + explicit          1    27376 27390   146.8 &lt; 0.00000000000000022 ***
## + valence           1    27445 27459    77.7 &lt; 0.00000000000000022 ***
## + liveness          1    27480 27494    42.9      0.00000000005728 ***
## + tempo             1    27504 27518    19.4      0.00001085601584 ***
## + speechiness       1    27510 27524    12.9             0.0003209 ***
## + instrumentalness  1    27516 27530     7.2             0.0071563 ** 
## + energy            1    27519 27533     3.8             0.0523575 .  
## &lt;none&gt;                   27523 27535                                  
## - song_age          1    27781 27791   258.3 &lt; 0.00000000000000022 ***
## - label             3    27963 27969   439.7 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    43159 43169 15635.8 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=26349.16
## top10 ~ weeks_in_charts + song_age + label + n_playlists
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## + genre            10    25312 25346  1023.2 &lt; 0.00000000000000022 ***
## + song_length       1    26086 26102   248.7 &lt; 0.00000000000000022 ***
## + danceability      1    26112 26128   222.7 &lt; 0.00000000000000022 ***
## + explicit          1    26175 26191   160.3 &lt; 0.00000000000000022 ***
## + valence           1    26240 26256    95.2 &lt; 0.00000000000000022 ***
## + liveness          1    26293 26309    41.7       0.0000000001046 ***
## + tempo             1    26314 26330    21.4       0.0000036320174 ***
## + speechiness       1    26322 26338    13.0             0.0003193 ***
## + instrumentalness  1    26329 26345     6.3             0.0118075 *  
## &lt;none&gt;                   26335 26349                                  
## + energy            1    26334 26350     1.1             0.2954805    
## - label             3    26565 26573   230.1 &lt; 0.00000000000000022 ***
## - song_age          1    27044 27056   708.7 &lt; 0.00000000000000022 ***
## - n_playlists       1    27523 27535  1187.9 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    40541 40553 14206.0 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=25345.92
## top10 ~ weeks_in_charts + song_age + label + n_playlists + genre
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## + song_length       1    25133 25169   178.5 &lt; 0.00000000000000022 ***
## + danceability      1    25185 25221   127.3 &lt; 0.00000000000000022 ***
## + explicit          1    25206 25242   106.0 &lt; 0.00000000000000022 ***
## + valence           1    25278 25314    34.4        0.000000004499 ***
## + tempo             1    25301 25337    11.4              0.000753 ***
## + liveness          1    25302 25338     9.8              0.001713 ** 
## &lt;none&gt;                   25312 25346                                  
## + energy            1    25310 25346     1.7              0.195014    
## + instrumentalness  1    25310 25346     1.6              0.202913    
## + speechiness       1    25312 25348     0.0              0.884998    
## - label             3    25474 25502   161.7 &lt; 0.00000000000000022 ***
## - song_age          1    25913 25945   600.6 &lt; 0.00000000000000022 ***
## - genre            10    26335 26349  1023.2 &lt; 0.00000000000000022 ***
## - n_playlists       1    26504 26536  1191.7 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    39511 39543 14199.3 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=25169.45
## top10 ~ weeks_in_charts + song_age + label + n_playlists + genre + 
##     song_length
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## + explicit          1    25029 25067   104.2 &lt; 0.00000000000000022 ***
## + danceability      1    25050 25088    83.6 &lt; 0.00000000000000022 ***
## + valence           1    25119 25157    14.6             0.0001309 ***
## + tempo             1    25121 25159    12.6             0.0003769 ***
## + liveness          1    25125 25163     8.1             0.0045244 ** 
## + instrumentalness  1    25131 25169     2.3             0.1276459    
## + energy            1    25131 25169     2.2             0.1340637    
## &lt;none&gt;                   25133 25169                                  
## + speechiness       1    25132 25170     1.4             0.2289231    
## - label             3    25273 25303   139.3 &lt; 0.00000000000000022 ***
## - song_length       1    25312 25346   178.5 &lt; 0.00000000000000022 ***
## - song_age          1    25647 25681   513.9 &lt; 0.00000000000000022 ***
## - genre            10    26086 26102   953.0 &lt; 0.00000000000000022 ***
## - n_playlists       1    26385 26419  1251.7 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    39507 39541 14373.3 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=25067.21
## top10 ~ weeks_in_charts + song_age + label + n_playlists + genre + 
##     song_length + explicit
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## + danceability      1    24948 24988    81.3 &lt; 0.00000000000000022 ***
## + valence           1    25016 25056    13.6             0.0002280 ***
## + tempo             1    25017 25057    11.8             0.0005785 ***
## + liveness          1    25022 25062     7.4             0.0067056 ** 
## + energy            1    25026 25066     3.6             0.0574725 .  
## &lt;none&gt;                   25029 25067                                  
## + speechiness       1    25028 25068     1.6             0.2008558    
## + instrumentalness  1    25028 25068     1.3             0.2576454    
## - label             3    25130 25162   100.3 &lt; 0.00000000000000022 ***
## - explicit          1    25133 25169   104.2 &lt; 0.00000000000000022 ***
## - song_length       1    25206 25242   176.7 &lt; 0.00000000000000022 ***
## - song_age          1    25542 25578   513.2 &lt; 0.00000000000000022 ***
## - genre            10    25933 25951   904.0 &lt; 0.00000000000000022 ***
## - n_playlists       1    26278 26314  1248.5 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    39340 39376 14311.0 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=24987.94
## top10 ~ weeks_in_charts + song_age + label + n_playlists + genre + 
##     song_length + explicit + danceability
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## + tempo             1    24928 24970    19.6           0.000009785 ***
## + liveness          1    24934 24976    13.5             0.0002356 ***
## + energy            1    24940 24982     8.3             0.0039206 ** 
## + speechiness       1    24945 24987     2.5             0.1106956    
## &lt;none&gt;                   24948 24988                                  
## + valence           1    24947 24989     0.7             0.4151639    
## + instrumentalness  1    24947 24989     0.6             0.4396889    
## - danceability      1    25029 25067    81.3 &lt; 0.00000000000000022 ***
## - explicit          1    25050 25088   101.9 &lt; 0.00000000000000022 ***
## - label             3    25059 25093   111.5 &lt; 0.00000000000000022 ***
## - song_length       1    25081 25119   133.5 &lt; 0.00000000000000022 ***
## - song_age          1    25405 25443   456.7 &lt; 0.00000000000000022 ***
## - genre            10    25804 25824   856.0 &lt; 0.00000000000000022 ***
## - n_playlists       1    26155 26193  1206.9 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    39182 39220 14233.6 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=24970.39
## top10 ~ weeks_in_charts + song_age + label + n_playlists + genre + 
##     song_length + explicit + danceability + tempo
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## + liveness          1    24915 24959    13.1             0.0002929 ***
## + energy            1    24917 24961    11.1             0.0008776 ***
## + speechiness       1    24925 24969     3.8             0.0510498 .  
## &lt;none&gt;                   24928 24970                                  
## + instrumentalness  1    24928 24972     0.5             0.4726447    
## + valence           1    24928 24972     0.2             0.6876102    
## - tempo             1    24948 24988    19.6           0.000009785 ***
## - danceability      1    25017 25057    89.0 &lt; 0.00000000000000022 ***
## - explicit          1    25029 25069   100.8 &lt; 0.00000000000000022 ***
## - label             3    25042 25078   113.1 &lt; 0.00000000000000022 ***
## - song_length       1    25061 25101   133.0 &lt; 0.00000000000000022 ***
## - song_age          1    25379 25419   450.2 &lt; 0.00000000000000022 ***
## - genre            10    25771 25793   842.2 &lt; 0.00000000000000022 ***
## - n_playlists       1    26134 26174  1205.9 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    39149 39189 14220.7 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=24959.27
## top10 ~ weeks_in_charts + song_age + label + n_playlists + genre + 
##     song_length + explicit + danceability + tempo + liveness
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## + energy            1    24899 24945    16.2            0.00005738 ***
## + speechiness       1    24911 24957     4.2             0.0393970 *  
## &lt;none&gt;                   24915 24959                                  
## + instrumentalness  1    24915 24961     0.6             0.4557895    
## + valence           1    24915 24961     0.0             0.9239797    
## - liveness          1    24928 24970    13.1             0.0002929 ***
## - tempo             1    24934 24976    19.1            0.00001211 ***
## - danceability      1    25010 25052    95.2 &lt; 0.00000000000000022 ***
## - explicit          1    25015 25057    99.8 &lt; 0.00000000000000022 ***
## - label             3    25029 25067   114.2 &lt; 0.00000000000000022 ***
## - song_length       1    25045 25087   129.7 &lt; 0.00000000000000022 ***
## - song_age          1    25363 25405   447.3 &lt; 0.00000000000000022 ***
## - genre            10    25719 25743   803.4 &lt; 0.00000000000000022 ***
## - n_playlists       1    26117 26159  1201.8 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    39140 39182 14224.6 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=24945.09
## top10 ~ weeks_in_charts + song_age + label + n_playlists + genre + 
##     song_length + explicit + danceability + tempo + liveness + 
##     energy
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## + speechiness       1    24894 24942     4.7               0.02962 *  
## + valence           1    24896 24944     2.6               0.10756    
## &lt;none&gt;                   24899 24945                                  
## + instrumentalness  1    24898 24946     0.8               0.36187    
## - energy            1    24915 24959    16.2            0.00005738 ***
## - liveness          1    24917 24961    18.2            0.00001954 ***
## - tempo             1    24922 24966    22.5            0.00000212 ***
## - explicit          1    25002 25046   102.5 &lt; 0.00000000000000022 ***
## - danceability      1    25003 25047   104.1 &lt; 0.00000000000000022 ***
## - label             3    25013 25053   113.8 &lt; 0.00000000000000022 ***
## - song_length       1    25028 25072   128.9 &lt; 0.00000000000000022 ***
## - song_age          1    25353 25397   454.3 &lt; 0.00000000000000022 ***
## - genre            10    25711 25737   811.9 &lt; 0.00000000000000022 ***
## - n_playlists       1    26103 26147  1204.0 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    39113 39157 14214.1 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=24942.35
## top10 ~ weeks_in_charts + song_age + label + n_playlists + genre + 
##     song_length + explicit + danceability + tempo + liveness + 
##     energy + speechiness
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## + valence           1    24892 24942     2.7               0.10031    
## &lt;none&gt;                   24894 24942                                  
## + instrumentalness  1    24893 24943     1.0               0.31346    
## - speechiness       1    24899 24945     4.7               0.02962 *  
## - energy            1    24911 24957    16.7          0.0000443660 ***
## - liveness          1    24913 24959    18.9          0.0000139497 ***
## - tempo             1    24918 24964    24.0          0.0000009465 ***
## - explicit          1    24997 25043   102.8 &lt; 0.00000000000000022 ***
## - danceability      1    25001 25047   106.3 &lt; 0.00000000000000022 ***
## - label             3    25006 25048   111.4 &lt; 0.00000000000000022 ***
## - song_length       1    25027 25073   132.4 &lt; 0.00000000000000022 ***
## - song_age          1    25353 25399   458.5 &lt; 0.00000000000000022 ***
## - genre            10    25707 25735   813.0 &lt; 0.00000000000000022 ***
## - n_playlists       1    26100 26146  1205.9 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    39038 39084 14143.7 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=24941.65
## top10 ~ weeks_in_charts + song_age + label + n_playlists + genre + 
##     song_length + explicit + danceability + tempo + liveness + 
##     energy + speechiness + valence
## 
##                    Df Deviance   AIC     LRT              Pr(&gt;Chi)    
## &lt;none&gt;                   24892 24942                                  
## - valence           1    24894 24942     2.7               0.10031    
## + instrumentalness  1    24891 24943     0.9               0.34466    
## - speechiness       1    24896 24944     4.8               0.02777 *  
## - liveness          1    24910 24958    18.5           0.000016707 ***
## - energy            1    24911 24959    19.4           0.000010799 ***
## - tempo             1    24915 24963    23.0           0.000001661 ***
## - danceability      1    24978 25026    86.0 &lt; 0.00000000000000022 ***
## - explicit          1    24995 25043   102.9 &lt; 0.00000000000000022 ***
## - label             3    25003 25047   111.1 &lt; 0.00000000000000022 ***
## - song_length       1    25018 25066   126.5 &lt; 0.00000000000000022 ***
## - song_age          1    25351 25399   459.3 &lt; 0.00000000000000022 ***
## - genre            10    25694 25724   802.2 &lt; 0.00000000000000022 ***
## - n_playlists       1    26100 26148  1208.5 &lt; 0.00000000000000022 ***
## - weeks_in_charts   1    39018 39066 14126.6 &lt; 0.00000000000000022 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre><code>## 
## Call:  glm(formula = top10 ~ weeks_in_charts + song_age + label + n_playlists + 
##     genre + song_length + explicit + danceability + tempo + liveness + 
##     energy + speechiness + valence, family = binomial(link = &quot;logit&quot;), 
##     data = music_data)
## 
## Coefficients:
##          (Intercept)       weeks_in_charts              song_age  
##            -8.250268              0.012811             -0.001929  
##      labelSony Music  labelUniversal Music     labelWarner Music  
##             0.310207              0.500078              0.259754  
##          n_playlists          genreCountry    genreElectro/Dance  
##             0.000269              6.052952              4.617654  
##     genreGerman Folk       genreHipHop/Rap            genreother  
##             3.393965              4.565679              5.429574  
##             genrePop              genreR&amp;B           genreReggae  
##             4.007876              5.019629              4.456428  
##            genreRock       genreSoundtrack           song_length  
##             4.142870              4.896580             -0.289024  
##     explicitexplicit          danceability                 tempo  
##            -0.707333              0.013872              0.002971  
##             liveness                energy           speechiness  
##             0.005182             -0.005303             -0.003541  
##              valence  
##             0.001534  
## 
## Degrees of Freedom: 66795 Total (i.e. Null);  66771 Residual
## Null Deviance:       43430 
## Residual Deviance: 24890     AIC: 24940</code></pre>
</div>
</div>
<div id="assignment-4" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Assignment 4<a href="r-markdown.html#assignment-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="assignment-a-1" class="section level3 hasAnchor" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Assignment A<a href="r-markdown.html#assignment-a-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data-set <code>influencer</code> contains the following variables to assess the success of influencer marketing campaigns:</p>
<ul>
<li><code>follower_count</code>: the number of followers of the influencer</li>
<li><code>engagement_rate</code>: the engagement rate measured as the number of interations divided by the influencers reach</li>
<li><code>content_quality</code>: an index measuring the quality of the influencer’s posts</li>
<li><code>post_frequency</code>: the number of times the influencer posted about the brand</li>
<li><code>sales</code>: the number of units sold during the campaign</li>
<li><code>brand_awareness</code>: an index measuring how many people became aware of the brand during the campaign</li>
</ul>
<p><strong>Task Instructions</strong></p>
<div id="task-1-omitted-variable-bias" class="section level4 hasAnchor" number="8.5.1.1">
<h4><span class="header-section-number">8.5.1.1</span> Task 1: Omitted Variable Bias<a href="r-markdown.html#task-1-omitted-variable-bias" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="r-markdown.html#cb903-1" tabindex="-1"></a>influencer <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;https://github.com/WU-RDS/MA2024/raw/refs/heads/main/data/influencer.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 1000 Columns: 6
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (6): follower_count, engagement_rate, sales, post_frequency, content_qua...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="r-markdown.html#cb905-1" tabindex="-1"></a><span class="fu">str</span>(influencer)</span></code></pre></div>
<pre><code>## spc_tbl_ [1,000 × 6] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ follower_count : num [1:1000] 295 790 415 884 941 ...
##  $ engagement_rate: num [1:1000] 0.0732 0.0406 0.0998 0.0708 0.0228 ...
##  $ sales          : num [1:1000] 2643 3239 3375 4498 3898 ...
##  $ post_frequency : num [1:1000] 3 11 6 6 3 2 4 5 7 4 ...
##  $ content_quality: num [1:1000] 5.45 6.87 4.75 5.5 8.2 ...
##  $ brand_awareness: num [1:1000] 45.2 72.9 52.5 36.7 36.7 ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   follower_count = col_double(),
##   ..   engagement_rate = col_double(),
##   ..   sales = col_double(),
##   ..   post_frequency = col_double(),
##   ..   content_quality = col_double(),
##   ..   brand_awareness = col_double()
##   .. )
##  - attr(*, &quot;problems&quot;)=&lt;externalptr&gt;</code></pre>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="r-markdown.html#cb907-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code></pre></div>
<p>We are interested in modeling the sales during the campaigns.</p>
<ol style="list-style-type: lower-alpha">
<li>Draw a DAG that shows how you would model the causal influence of of <code>follower_count</code> on <code>sales</code> (feel free to draw it by hand and insert an image. You can add images with <code>![](./IMAGE.png)</code>)</li>
</ol>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="r-markdown.html#cb908-1" tabindex="-1"></a>base_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> follower_count, <span class="at">data =</span> influencer)</span>
<span id="cb908-2"><a href="r-markdown.html#cb908-2" tabindex="-1"></a><span class="fu">summary</span>(base_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ follower_count, data = influencer)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2236.06  -470.71    18.01   424.89  2232.78 
## 
## Coefficients:
##                  Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)    3053.54262   41.89236   72.89 &lt;0.0000000000000002 ***
## follower_count    0.90074    0.07257   12.41 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 652.8 on 998 degrees of freedom
## Multiple R-squared:  0.1337, Adjusted R-squared:  0.1329 
## F-statistic: 154.1 on 1 and 998 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="r-markdown.html#cb910-1" tabindex="-1"></a>engagement_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> follower_count <span class="sc">+</span> engagement_rate,</span>
<span id="cb910-2"><a href="r-markdown.html#cb910-2" tabindex="-1"></a>    <span class="at">data =</span> influencer)</span>
<span id="cb910-3"><a href="r-markdown.html#cb910-3" tabindex="-1"></a><span class="fu">summary</span>(engagement_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ follower_count + engagement_rate, data = influencer)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1493.87  -319.65    -9.01   346.75  1624.26 
## 
## Coefficients:
##                    Estimate  Std. Error t value            Pr(&gt;|t|)    
## (Intercept)       887.57799    84.49382   10.51 &lt;0.0000000000000002 ***
## follower_count      1.99892     0.06756   29.59 &lt;0.0000000000000002 ***
## engagement_rate 21485.81618   777.56864   27.63 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 491.5 on 997 degrees of freedom
## Multiple R-squared:  0.5094, Adjusted R-squared:  0.5084 
## F-statistic: 517.6 on 2 and 997 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="r-markdown.html#cb912-1" tabindex="-1"></a>frequency_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> follower_count <span class="sc">+</span> post_frequency,</span>
<span id="cb912-2"><a href="r-markdown.html#cb912-2" tabindex="-1"></a>    <span class="at">data =</span> influencer)</span>
<span id="cb912-3"><a href="r-markdown.html#cb912-3" tabindex="-1"></a><span class="fu">summary</span>(frequency_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ follower_count + post_frequency, data = influencer)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2213.03  -468.92    15.37   429.23  2233.67 
## 
## Coefficients:
##                  Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)    2997.48090   63.37709  47.296 &lt;0.0000000000000002 ***
## follower_count    0.90208    0.07257  12.431 &lt;0.0000000000000002 ***
## post_frequency   10.94625    9.28712   1.179               0.239    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 652.7 on 997 degrees of freedom
## Multiple R-squared:  0.1349, Adjusted R-squared:  0.1332 
## F-statistic: 77.75 on 2 and 997 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="r-markdown.html#cb914-1" tabindex="-1"></a>content_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> follower_count <span class="sc">+</span> content_quality,</span>
<span id="cb914-2"><a href="r-markdown.html#cb914-2" tabindex="-1"></a>    <span class="at">data =</span> influencer)</span>
<span id="cb914-3"><a href="r-markdown.html#cb914-3" tabindex="-1"></a><span class="fu">summary</span>(content_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ follower_count + content_quality, data = influencer)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2239.57  -472.04    18.92   423.88  2235.21 
## 
## Coefficients:
##                   Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)     3064.32650  121.24197  25.274 &lt;0.0000000000000002 ***
## follower_count     0.90091    0.07263  12.404 &lt;0.0000000000000002 ***
## content_quality   -1.81099   19.10544  -0.095               0.925    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 653.1 on 997 degrees of freedom
## Multiple R-squared:  0.1337, Adjusted R-squared:  0.132 
## F-statistic: 76.95 on 2 and 997 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="r-markdown.html#cb916-1" tabindex="-1"></a>awareness_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> follower_count <span class="sc">+</span> brand_awareness,</span>
<span id="cb916-2"><a href="r-markdown.html#cb916-2" tabindex="-1"></a>    <span class="at">data =</span> influencer)</span>
<span id="cb916-3"><a href="r-markdown.html#cb916-3" tabindex="-1"></a><span class="fu">summary</span>(awareness_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ follower_count + brand_awareness, data = influencer)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2221.64  -465.95    10.36   426.80  2228.69 
## 
## Coefficients:
##                   Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)     2994.48247   88.14965  33.970 &lt;0.0000000000000002 ***
## follower_count     0.89808    0.07267  12.358 &lt;0.0000000000000002 ***
## brand_awareness    1.21243    1.59209   0.762               0.447    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 653 on 997 degrees of freedom
## Multiple R-squared:  0.1342, Adjusted R-squared:  0.1325 
## F-statistic: 77.28 on 2 and 997 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>We ran several models, starting with a base model with one independent variable follower_count and sales as dependent variable. Then we added different variables in this model to see if some of them add explanatory power, and it’s the case only for the variable engagement_rate. The effect of follower count on sales increases when engagement rate is added to the model from 0.9 to 1.9, suggesting that engagement rate is acting as a confounder, influencing both follower_count and sales.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Describe briefly what roles each of the variables in you DAG play (mediator, moderator, collider)</li>
</ol>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="r-markdown.html#cb918-1" tabindex="-1"></a><span class="co"># Engagement rate is a confounder</span></span>
<span id="cb918-2"><a href="r-markdown.html#cb918-2" tabindex="-1"></a></span>
<span id="cb918-3"><a href="r-markdown.html#cb918-3" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb918-4"><a href="r-markdown.html#cb918-4" tabindex="-1"></a></span>
<span id="cb918-5"><a href="r-markdown.html#cb918-5" tabindex="-1"></a><span class="fu">mermaid</span>(<span class="st">&quot;</span></span>
<span id="cb918-6"><a href="r-markdown.html#cb918-6" tabindex="-1"></a><span class="st">graph LR</span></span>
<span id="cb918-7"><a href="r-markdown.html#cb918-7" tabindex="-1"></a><span class="st">   engagement_rate --&gt; follower_count</span></span>
<span id="cb918-8"><a href="r-markdown.html#cb918-8" tabindex="-1"></a><span class="st">   engagement_rate --&gt; sales</span></span>
<span id="cb918-9"><a href="r-markdown.html#cb918-9" tabindex="-1"></a><span class="st">   follower_count --&gt; sales</span></span>
<span id="cb918-10"><a href="r-markdown.html#cb918-10" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
<div class="DiagrammeR html-widget html-fill-item" id="htmlwidget-f99564eb6e8884a58f83" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-f99564eb6e8884a58f83">{"x":{"diagram":"\ngraph LR\n   engagement_rate --> follower_count\n   engagement_rate --> sales\n   follower_count --> sales\n"},"evals":[],"jsHooks":[]}</script>
<ol start="3" style="list-style-type: lower-alpha">
<li>Calculate the correlation coefficients of the variables you expect to be correlated based on your answer in a). Briefly explain any changes (if any) you would like to make to your DAG based on the results.</li>
</ol>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="r-markdown.html#cb919-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb919-2"><a href="r-markdown.html#cb919-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb919-3"><a href="r-markdown.html#cb919-3" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code></pre></div>
<pre><code>## corrplot 0.95 loaded</code></pre>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="r-markdown.html#cb921-1" tabindex="-1"></a><span class="co"># Variable selection</span></span>
<span id="cb921-2"><a href="r-markdown.html#cb921-2" tabindex="-1"></a>variables <span class="ot">&lt;-</span> influencer[, <span class="fu">c</span>(<span class="st">&quot;follower_count&quot;</span>, <span class="st">&quot;sales&quot;</span>,</span>
<span id="cb921-3"><a href="r-markdown.html#cb921-3" tabindex="-1"></a>    <span class="st">&quot;engagement_rate&quot;</span>, <span class="st">&quot;brand_awareness&quot;</span>, <span class="st">&quot;content_quality&quot;</span>,</span>
<span id="cb921-4"><a href="r-markdown.html#cb921-4" tabindex="-1"></a>    <span class="st">&quot;post_frequency&quot;</span>)]</span>
<span id="cb921-5"><a href="r-markdown.html#cb921-5" tabindex="-1"></a></span>
<span id="cb921-6"><a href="r-markdown.html#cb921-6" tabindex="-1"></a><span class="co"># Calculate correlation matrix</span></span>
<span id="cb921-7"><a href="r-markdown.html#cb921-7" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(variables, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>,</span>
<span id="cb921-8"><a href="r-markdown.html#cb921-8" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb921-9"><a href="r-markdown.html#cb921-9" tabindex="-1"></a></span>
<span id="cb921-10"><a href="r-markdown.html#cb921-10" tabindex="-1"></a><span class="co"># Print the correlation matrix</span></span>
<span id="cb921-11"><a href="r-markdown.html#cb921-11" tabindex="-1"></a><span class="fu">print</span>(cor_matrix)</span></code></pre></div>
<pre><code>##                 follower_count       sales engagement_rate brand_awareness
## follower_count      1.00000000 0.365678342     -0.58822421      0.04798687
## sales               0.36567834 1.000000000      0.28058517      0.03996302
## engagement_rate    -0.58822421 0.280585165      1.00000000      0.02201733
## brand_awareness     0.04798687 0.039963019      0.02201733      1.00000000
## content_quality     0.02521806 0.006428507     -0.01827486      0.55365563
## post_frequency     -0.01568093 0.028980269      0.03287448      0.51086960
##                 content_quality post_frequency
## follower_count      0.025218064    -0.01568093
## sales               0.006428507     0.02898027
## engagement_rate    -0.018274863     0.03287448
## brand_awareness     0.553655632     0.51086960
## content_quality     1.000000000     0.39864862
## post_frequency      0.398648616     1.00000000</code></pre>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="r-markdown.html#cb923-1" tabindex="-1"></a><span class="co"># Visualize the correlation matrix using corrplot</span></span>
<span id="cb923-2"><a href="r-markdown.html#cb923-2" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">&quot;circle&quot;</span>, <span class="at">type =</span> <span class="st">&quot;upper&quot;</span>,</span>
<span id="cb923-3"><a href="r-markdown.html#cb923-3" tabindex="-1"></a>    <span class="at">tl.col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>, <span class="at">addCoef.col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Run and interpret the appropriate model given your answers in a) - c) (hint: you don’t need anything we did not do in class)</li>
</ol>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="r-markdown.html#cb924-1" tabindex="-1"></a><span class="co"># Confounder - engagement rate</span></span>
<span id="cb924-2"><a href="r-markdown.html#cb924-2" tabindex="-1"></a></span>
<span id="cb924-3"><a href="r-markdown.html#cb924-3" tabindex="-1"></a>base_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> follower_count, <span class="at">data =</span> influencer)</span>
<span id="cb924-4"><a href="r-markdown.html#cb924-4" tabindex="-1"></a><span class="fu">summary</span>(base_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ follower_count, data = influencer)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2236.06  -470.71    18.01   424.89  2232.78 
## 
## Coefficients:
##                  Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)    3053.54262   41.89236   72.89 &lt;0.0000000000000002 ***
## follower_count    0.90074    0.07257   12.41 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 652.8 on 998 degrees of freedom
## Multiple R-squared:  0.1337, Adjusted R-squared:  0.1329 
## F-statistic: 154.1 on 1 and 998 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="r-markdown.html#cb926-1" tabindex="-1"></a>engagement_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> follower_count <span class="sc">+</span> engagement_rate,</span>
<span id="cb926-2"><a href="r-markdown.html#cb926-2" tabindex="-1"></a>    <span class="at">data =</span> influencer)</span>
<span id="cb926-3"><a href="r-markdown.html#cb926-3" tabindex="-1"></a><span class="fu">summary</span>(engagement_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ follower_count + engagement_rate, data = influencer)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1493.87  -319.65    -9.01   346.75  1624.26 
## 
## Coefficients:
##                    Estimate  Std. Error t value            Pr(&gt;|t|)    
## (Intercept)       887.57799    84.49382   10.51 &lt;0.0000000000000002 ***
## follower_count      1.99892     0.06756   29.59 &lt;0.0000000000000002 ***
## engagement_rate 21485.81618   777.56864   27.63 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 491.5 on 997 degrees of freedom
## Multiple R-squared:  0.5094, Adjusted R-squared:  0.5084 
## F-statistic: 517.6 on 2 and 997 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>All the coefficients have a p-value lower than 0.05, which means they are all significant, so we can proceed with the interpretations.</p>
<p>The coefficient for follower count is now 1.99, meaning for each additional follower, sales increase by 1.99 units, holding another predictor constant. This is higher than the previous value of 0.9 in the base model. After adjusting for engagement rate, the effect of follower count on sales becomes stronger. The coefficient for engagement rate is 2.1, meaning for each unit increase in engagement rate, sales increase by 2.1 units, holding another predictor constant.</p>
<p>The R-squared of the model increased from 0.13 in the base model to 0.5 in the model including engagement rate. So, this model explains 50% of the variance in sales.</p>
</div>
<div id="task-2-selection-bias" class="section level4 hasAnchor" number="8.5.1.2">
<h4><span class="header-section-number">8.5.1.2</span> Task 2: Selection Bias<a href="r-markdown.html#task-2-selection-bias" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="r-markdown.html#cb928-1" tabindex="-1"></a>influencer2 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;https://github.com/WU-RDS/MA2024/raw/refs/heads/main/data/influencer2.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 100 Columns: 3
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (3): authenticity, sales_impact, selected
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="r-markdown.html#cb930-1" tabindex="-1"></a><span class="fu">str</span>(influencer2)</span></code></pre></div>
<pre><code>## spc_tbl_ [100 × 3] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ authenticity: num [1:100] 72.2 28.9 21.7 45.8 56.5 ...
##  $ sales_impact: num [1:100] 60.2 79.7 59 49.1 73.9 ...
##  $ selected    : num [1:100] 1 0 0 0 0 1 1 0 1 1 ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   authenticity = col_double(),
##   ..   sales_impact = col_double(),
##   ..   selected = col_double()
##   .. )
##  - attr(*, &quot;problems&quot;)=&lt;externalptr&gt;</code></pre>
<p>The data-set <code>influencer2</code> contains data from an experiment run by a company to assess whether their selection criteria for influencer campaigns are suitable to assess the impact authenticity of their posts have on sales. Instead of their usual selection criteria they select influencers at random to check if their usual selection criteria change the relationship between authenticit and sales. The data contains the following variables:</p>
<ul>
<li><code>sales_impact</code>: the measured sales impact of an influencer</li>
<li><code>authenticity</code>: an index measuring the perceived authenticity of the influencer’s posts</li>
<li><code>selected</code>: an indicator of whether this influencer would have been selected according to the companies usual criteria</li>
</ul>
<p>Since their usual selection criteria include the expected sales impact of a campaign as well as the authenticity index the company suspects that the selection is a collider.</p>
<ol style="list-style-type: lower-alpha">
<li>Please estimate and interpret a model that shows the causal impact of authenticity on sales assuming the company is correct and their selection is a collider</li>
</ol>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="r-markdown.html#cb932-1" tabindex="-1"></a><span class="co"># provide your code here</span></span>
<span id="cb932-2"><a href="r-markdown.html#cb932-2" tabindex="-1"></a></span>
<span id="cb932-3"><a href="r-markdown.html#cb932-3" tabindex="-1"></a>model_correct <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales_impact <span class="sc">~</span> authenticity, influencer2)</span>
<span id="cb932-4"><a href="r-markdown.html#cb932-4" tabindex="-1"></a>model_collider <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales_impact <span class="sc">~</span> authenticity <span class="sc">+</span></span>
<span id="cb932-5"><a href="r-markdown.html#cb932-5" tabindex="-1"></a>    selected, influencer2)</span>
<span id="cb932-6"><a href="r-markdown.html#cb932-6" tabindex="-1"></a></span>
<span id="cb932-7"><a href="r-markdown.html#cb932-7" tabindex="-1"></a><span class="fu">summary</span>(model_correct)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales_impact ~ authenticity, data = influencer2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -53.349 -10.443   0.159  13.554  45.399 
## 
## Coefficients:
##              Estimate Std. Error t value      Pr(&gt;|t|)    
## (Intercept)   43.4479     6.4702   6.715 0.00000000124 ***
## authenticity   0.3215     0.1209   2.658       0.00917 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.46 on 98 degrees of freedom
## Multiple R-squared:  0.06726,    Adjusted R-squared:  0.05774 
## F-statistic: 7.067 on 1 and 98 DF,  p-value: 0.009171</code></pre>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="r-markdown.html#cb934-1" tabindex="-1"></a><span class="fu">summary</span>(model_collider)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales_impact ~ authenticity + selected, data = influencer2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -47.618 -11.940   0.009  13.048  39.966 
## 
## Coefficients:
##              Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept)   47.4128     6.1883   7.662 0.000000000014 ***
## authenticity   0.1275     0.1256   1.015       0.312514    
## selected      15.2177     4.1430   3.673       0.000392 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.33 on 97 degrees of freedom
## Multiple R-squared:  0.1812, Adjusted R-squared:  0.1643 
## F-statistic: 10.73 on 2 and 97 DF,  p-value: 0.0000617</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Draw the DAG for the model (feel free to draw it by hand and insert an image)</li>
</ol>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="r-markdown.html#cb936-1" tabindex="-1"></a><span class="co"># collider</span></span>
<span id="cb936-2"><a href="r-markdown.html#cb936-2" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb936-3"><a href="r-markdown.html#cb936-3" tabindex="-1"></a></span>
<span id="cb936-4"><a href="r-markdown.html#cb936-4" tabindex="-1"></a><span class="do">## Model the situation assumed by the company</span></span>
<span id="cb936-5"><a href="r-markdown.html#cb936-5" tabindex="-1"></a><span class="do">## (=collider)</span></span>
<span id="cb936-6"><a href="r-markdown.html#cb936-6" tabindex="-1"></a><span class="fu">mermaid</span>(<span class="st">&quot;</span></span>
<span id="cb936-7"><a href="r-markdown.html#cb936-7" tabindex="-1"></a><span class="st">graph LR</span></span>
<span id="cb936-8"><a href="r-markdown.html#cb936-8" tabindex="-1"></a><span class="st">   authenticity--&gt; select</span></span>
<span id="cb936-9"><a href="r-markdown.html#cb936-9" tabindex="-1"></a><span class="st">   sales--&gt; select</span></span>
<span id="cb936-10"><a href="r-markdown.html#cb936-10" tabindex="-1"></a><span class="st">   authenticity--&gt;sales</span></span>
<span id="cb936-11"><a href="r-markdown.html#cb936-11" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
<div class="DiagrammeR html-widget html-fill-item" id="htmlwidget-6166d559454ecd730d7d" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-6166d559454ecd730d7d">{"x":{"diagram":"\ngraph LR\n   authenticity--> select\n   sales--> select\n   authenticity-->sales\n"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="task-3-moderation" class="section level4 hasAnchor" number="8.5.1.3">
<h4><span class="header-section-number">8.5.1.3</span> Task 3: Moderation<a href="r-markdown.html#task-3-moderation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="r-markdown.html#cb937-1" tabindex="-1"></a>in_app_purchases <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;https://github.com/WU-RDS/MA2024/raw/refs/heads/main/data/in_app_purchases.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 1000 Columns: 3
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (2): gender, campaign_exposure
## dbl (1): in_app_purchases
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="r-markdown.html#cb939-1" tabindex="-1"></a><span class="fu">str</span>(in_app_purchases)</span></code></pre></div>
<pre><code>## spc_tbl_ [1,000 × 3] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ gender           : chr [1:1000] &quot;Male&quot; &quot;Female&quot; &quot;Male&quot; &quot;Female&quot; ...
##  $ campaign_exposure: chr [1:1000] &quot;Exposed&quot; &quot;Exposed&quot; &quot;Exposed&quot; &quot;Not Exposed&quot; ...
##  $ in_app_purchases : num [1:1000] 6 16 7 5 5 8 5 10 11 11 ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   gender = col_character(),
##   ..   campaign_exposure = col_character(),
##   ..   in_app_purchases = col_double()
##   .. )
##  - attr(*, &quot;problems&quot;)=&lt;externalptr&gt;</code></pre>
<p>The data-set <code>in_app_purchases</code> includes data on a marketing campaign aimed at boosting in-app purchases. It contains the variables:</p>
<ul>
<li><code>in_app</code>: the number of in-app purchases of a user</li>
<li><code>gender</code>: the gender of the user</li>
<li><code>campaign_exposure</code>: indicator whether the user was exposed to the campaign</li>
</ul>
<ol style="list-style-type: lower-alpha">
<li>Provide an appropriate visualization showing whether the effect of the campaign is moderated by gender</li>
</ol>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="r-markdown.html#cb941-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb941-2"><a href="r-markdown.html#cb941-2" tabindex="-1"></a></span>
<span id="cb941-3"><a href="r-markdown.html#cb941-3" tabindex="-1"></a><span class="fu">ggplot</span>(in_app_purchases, <span class="fu">aes</span>(<span class="at">x =</span> campaign_exposure, <span class="at">y =</span> in_app_purchases, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb941-4"><a href="r-markdown.html#cb941-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span>  <span class="co"># Adjusted dodge for separation</span></span>
<span id="cb941-5"><a href="r-markdown.html#cb941-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb941-6"><a href="r-markdown.html#cb941-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;In-App Purchases by Campaign Exposure and Gender&quot;</span>,</span>
<span id="cb941-7"><a href="r-markdown.html#cb941-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Campaign Exposure&quot;</span>,</span>
<span id="cb941-8"><a href="r-markdown.html#cb941-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;In-App Purchases&quot;</span>,</span>
<span id="cb941-9"><a href="r-markdown.html#cb941-9" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Gender&quot;</span></span>
<span id="cb941-10"><a href="r-markdown.html#cb941-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb941-11"><a href="r-markdown.html#cb941-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb941-12"><a href="r-markdown.html#cb941-12" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb941-13"><a href="r-markdown.html#cb941-13" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb941-14"><a href="r-markdown.html#cb941-14" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),      <span class="co"># Improves text size</span></span>
<span id="cb941-15"><a href="r-markdown.html#cb941-15" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)  <span class="co"># Enhances title appearance</span></span>
<span id="cb941-16"><a href="r-markdown.html#cb941-16" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="14-rmdIntro_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<p>From the boxplots we can already see that gender moderates the effect of the campaign. This campaign works much better on women than on men. We can check it formally by running the regression and looking at the coefficients.</p>
<ol style="list-style-type: lower-alpha">
<li>Calculate and interpret all of the coefficients in the appropriate model given your answer in a)</li>
</ol>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="r-markdown.html#cb942-1" tabindex="-1"></a>moderation_gender <span class="ot">&lt;-</span> <span class="fu">lm</span>(in_app_purchases <span class="sc">~</span> campaign_exposure <span class="sc">*</span></span>
<span id="cb942-2"><a href="r-markdown.html#cb942-2" tabindex="-1"></a>    gender, <span class="at">data =</span> in_app_purchases)</span>
<span id="cb942-3"><a href="r-markdown.html#cb942-3" tabindex="-1"></a><span class="fu">summary</span>(moderation_gender)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = in_app_purchases ~ campaign_exposure * gender, data = in_app_purchases)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.9128  -1.9393   0.0607   2.0607  13.1297 
## 
## Coefficients:
##                                         Estimate Std. Error t value
## (Intercept)                              12.9128     0.1643   78.58
## campaign_exposureNot Exposed             -7.7965     0.2782  -28.02
## genderMale                               -4.0425     0.2379  -16.99
## campaign_exposureNot Exposed:genderMale   3.8654     0.3841   10.06
##                                                    Pr(&gt;|t|)    
## (Intercept)                             &lt;0.0000000000000002 ***
## campaign_exposureNot Exposed            &lt;0.0000000000000002 ***
## genderMale                              &lt;0.0000000000000002 ***
## campaign_exposureNot Exposed:genderMale &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.944 on 996 degrees of freedom
## Multiple R-squared:  0.5589, Adjusted R-squared:  0.5576 
## F-statistic: 420.7 on 3 and 996 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>From the model we can see that all the coefficients are significant (p&lt;0.05), so we can proceed with interpreting them.</p>
<p>campaign_exposureNot Exposed - When the female customers are not exposed to the campaign, their in app purchases fall by 7.8 units in comparison with customers exposed to the campaign.
genderMale - Men who are exposed to the campaign make 4.04 fewer in-app purchases on average compared to women who are exposed to the campaign.
campaign_exposureNot Exposed:genderMale - Men are less negatively affected by not being exposed to the campaign compared to women.</p>
<p>-7.8 + 3.9 = -3.9: If men are not exposed to the campaign, their in app purchases fall by 3.9 units in comparison with decrease of 7.8 among women.</p>
</div>
<div id="task-4-the-ikea-effect" class="section level4 hasAnchor" number="8.5.1.4">
<h4><span class="header-section-number">8.5.1.4</span> Task 4: The IKEA effect<a href="r-markdown.html#task-4-the-ikea-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="r-markdown.html#cb944-1" tabindex="-1"></a>ikea <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;https://github.com/WU-RDS/MA2024/raw/refs/heads/main/data/ikea.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 500 Columns: 3
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (3): self_assembly, accomplishment, valuation
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="r-markdown.html#cb946-1" tabindex="-1"></a><span class="fu">str</span>(ikea)</span></code></pre></div>
<pre><code>## spc_tbl_ [500 × 3] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ self_assembly : num [1:500] 1 2 1 2 2 1 2 2 2 1 ...
##  $ accomplishment: num [1:500] 4.62 6.44 4.66 7.09 8.6 ...
##  $ valuation     : num [1:500] 79.3 73.2 69.1 78.4 78.9 ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   self_assembly = col_double(),
##   ..   accomplishment = col_double(),
##   ..   valuation = col_double()
##   .. )
##  - attr(*, &quot;problems&quot;)=&lt;externalptr&gt;</code></pre>
<p>The IKEA effect describes a psychological process through which consumers value products more because they feel a sense of accomplishment after assembling the something themselves. Using the following data, analyze whether you can replicate these results. The data was created through an experiment in which some consumers were randomly given fully assembled furniture while others had to assemble it themselves (it is otherwise the same furniture; variable: <code>self_assembly</code>). The researchers asked consumers about their sense of accomplishment (variable: <code>accomplishment</code>) and how much they value the final product (variable: <code>valuation</code>). Discuss the relative magnitude of the direct and mediated effect of self assembly.</p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="r-markdown.html#cb948-1" tabindex="-1"></a><span class="co"># provide your code here</span></span>
<span id="cb948-2"><a href="r-markdown.html#cb948-2" tabindex="-1"></a></span>
<span id="cb948-3"><a href="r-markdown.html#cb948-3" tabindex="-1"></a><span class="co"># Mediation - engagement rate</span></span>
<span id="cb948-4"><a href="r-markdown.html#cb948-4" tabindex="-1"></a></span>
<span id="cb948-5"><a href="r-markdown.html#cb948-5" tabindex="-1"></a><span class="co"># Step 1: Run regression just with X and Y</span></span>
<span id="cb948-6"><a href="r-markdown.html#cb948-6" tabindex="-1"></a>total_effect_ikea <span class="ot">&lt;-</span> <span class="fu">lm</span>(valuation <span class="sc">~</span> self_assembly,</span>
<span id="cb948-7"><a href="r-markdown.html#cb948-7" tabindex="-1"></a>    <span class="at">data =</span> ikea)</span>
<span id="cb948-8"><a href="r-markdown.html#cb948-8" tabindex="-1"></a></span>
<span id="cb948-9"><a href="r-markdown.html#cb948-9" tabindex="-1"></a><span class="co"># Step 2: Run regression just with M1</span></span>
<span id="cb948-10"><a href="r-markdown.html#cb948-10" tabindex="-1"></a>X_on_M_ikea <span class="ot">&lt;-</span> <span class="fu">lm</span>(accomplishment <span class="sc">~</span> self_assembly, <span class="at">data =</span> ikea)</span>
<span id="cb948-11"><a href="r-markdown.html#cb948-11" tabindex="-1"></a></span>
<span id="cb948-12"><a href="r-markdown.html#cb948-12" tabindex="-1"></a></span>
<span id="cb948-13"><a href="r-markdown.html#cb948-13" tabindex="-1"></a><span class="co"># Step 3: Run regression with Y on X and M1</span></span>
<span id="cb948-14"><a href="r-markdown.html#cb948-14" tabindex="-1"></a>avg_direct_effect_M_ikea <span class="ot">&lt;-</span> <span class="fu">lm</span>(valuation <span class="sc">~</span> self_assembly <span class="sc">+</span></span>
<span id="cb948-15"><a href="r-markdown.html#cb948-15" tabindex="-1"></a>    accomplishment, <span class="at">data =</span> ikea)</span>
<span id="cb948-16"><a href="r-markdown.html#cb948-16" tabindex="-1"></a></span>
<span id="cb948-17"><a href="r-markdown.html#cb948-17" tabindex="-1"></a><span class="fu">summary</span>(total_effect_ikea)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = valuation ~ self_assembly, data = ikea)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -30.597  -7.481  -0.368   6.408  34.087 
## 
## Coefficients:
##               Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)    53.4978     1.4707   36.38 &lt;0.0000000000000002 ***
## self_assembly  11.5394     0.9473   12.18 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.57 on 498 degrees of freedom
## Multiple R-squared:  0.2295, Adjusted R-squared:  0.228 
## F-statistic: 148.4 on 1 and 498 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="r-markdown.html#cb950-1" tabindex="-1"></a><span class="fu">summary</span>(X_on_M_ikea)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = accomplishment ~ self_assembly, data = ikea)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.77413 -0.64394  0.01379  0.70961  2.72736 
## 
## Coefficients:
##               Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)    2.84229    0.13974   20.34 &lt;0.0000000000000002 ***
## self_assembly  2.12206    0.09001   23.57 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.005 on 498 degrees of freedom
## Multiple R-squared:  0.5274, Adjusted R-squared:  0.5265 
## F-statistic: 555.8 on 1 and 498 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="r-markdown.html#cb952-1" tabindex="-1"></a><span class="fu">summary</span>(avg_direct_effect_M_ikea)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = valuation ~ self_assembly + accomplishment, data = ikea)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -25.9883  -6.9040  -0.2609   5.9800  31.6184 
## 
## Coefficients:
##                Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)      45.287      1.915  23.644 &lt; 0.0000000000000002 ***
## self_assembly     5.410      1.327   4.078       0.000052866717 ***
## accomplishment    2.889      0.454   6.363       0.000000000449 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.18 on 497 degrees of freedom
## Multiple R-squared:  0.2876, Adjusted R-squared:  0.2847 
## F-statistic: 100.3 on 2 and 497 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="r-markdown.html#cb954-1" tabindex="-1"></a><span class="co"># Indirect effect: self_assembly -&gt;</span></span>
<span id="cb954-2"><a href="r-markdown.html#cb954-2" tabindex="-1"></a><span class="co"># accomplishment -&gt; valuation</span></span>
<span id="cb954-3"><a href="r-markdown.html#cb954-3" tabindex="-1"></a>indirect_effect <span class="ot">&lt;-</span> <span class="fu">coef</span>(X_on_M_ikea)[<span class="st">&quot;self_assembly&quot;</span>] <span class="sc">*</span></span>
<span id="cb954-4"><a href="r-markdown.html#cb954-4" tabindex="-1"></a>    <span class="fu">coef</span>(avg_direct_effect_M_ikea)[<span class="st">&quot;accomplishment&quot;</span>]</span>
<span id="cb954-5"><a href="r-markdown.html#cb954-5" tabindex="-1"></a></span>
<span id="cb954-6"><a href="r-markdown.html#cb954-6" tabindex="-1"></a><span class="co"># Print the indirect effect</span></span>
<span id="cb954-7"><a href="r-markdown.html#cb954-7" tabindex="-1"></a>indirect_effect</span></code></pre></div>
<pre><code>## self_assembly 
##      6.129904</code></pre>
<p>The coefficients in all 3 models are significant (p&lt;0.05), so we can proceed with the interpretations.</p>
<p>First model with just the effect of self assembly on valuation: 11.54 (p&lt;0.05) If consumers assemble the product themselves (as opposed to receiving it fully assembled), their valuation of the product increases by 11.54 units.</p>
<p>Second model with the effect of the self assembly on the sense of accomplishment: If the furniture is self assembled, it increases the sense of accomplishment by approximately 2.12 units in comparison with furniture that doesn’t have to be assembled.</p>
<p>Third model with the effect of both self assembly and accomplishment on valuation: After including the accomplishment variable in the model, self assembly still has a positive effect on valuation, but now the effect is reduced compared to the total effect in the first step. The reduction suggests part of the effect of self assembly on valuation is mediated by accomplishment.</p>
<p>As the next step, we calculate the indirect effect of the self assembly on valuation through sense of accomplishment by multiplying the coefficients from the first and second models: 2.122 * 2.889 = 6.13</p>
<p>The mediated effect via accomplishment (=6.13) is slightly larger than the direct effect (5.41), suggesting that the IKEA effect (the increased valuation due to self assembly) is largely driven by the sense of accomplishment that consumers feel when assembling the product themselves.</p>

<p><link rel="stylesheet" type="text/css" media="all" href="style.css" /></p>
</div>
</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="survey-design-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
